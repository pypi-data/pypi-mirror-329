export const ids=["75034"];export const modules={50875:function(e,t,s){s.d(t,{Eu:()=>o,hZ:()=>r,o9:()=>c});var a=s(27486),i=s(11259);const n=["#4269d0","#f4bd4a","#ff725c","#6cc5b0","#a463f2","#ff8ab7","#9c6b4e","#97bbf5","#01ab63","#9498a0","#094bad","#c99000","#d84f3e","#49a28f","#048732","#d96895","#8043ce","#7599d1","#7a4c31","#74787f","#6989f4","#ffd444","#ff957c","#8fe9d3","#62cc71","#ffadda","#c884ff","#badeff","#bf8b6d","#b6bac2","#927acc","#97ee3f","#bf3947","#9f5b00","#f48758","#8caed6","#f2b94f","#eff26e","#e43872","#d9b100","#9d7a00","#698cff","#d9d9d9","#00d27e","#d06800","#009f82","#c49200","#cbe8ff","#fecddf","#c27eb6","#8cd2ce","#c4b8d9","#f883b0","#a49100","#f48800","#27d0df","#a04a9b"];function o(e){return n[e%n.length]}function r(e,t){const s=t.getPropertyValue(`--graph-color-${e+1}`)||o(e);return(0,i.Rq)(s)}const c=(0,a.Z)((e=>n.map(((t,s)=>r(s,e)))),((e,t)=>e[0].getPropertyValue("--graph-color-1")===t[0].getPropertyValue("--graph-color-1")))},68958:function(e,t,s){s.d(t,{t:()=>n});s(92745),s(39527),s(41360),s(88972);class a{constructor(e=window.localStorage){this.storage=void 0,this._storage={},this._listeners={},this.storage=e,e===window.localStorage&&window.addEventListener("storage",(e=>{e.key&&this.hasKey(e.key)&&(this._storage[e.key]=e.newValue?JSON.parse(e.newValue):e.newValue,this._listeners[e.key]&&this._listeners[e.key].forEach((t=>t(e.oldValue?JSON.parse(e.oldValue):e.oldValue,this._storage[e.key]))))}))}addFromStorage(e){if(!this._storage[e]){const t=this.storage.getItem(e);t&&(this._storage[e]=JSON.parse(t))}}subscribeChanges(e,t){return this._listeners[e]?this._listeners[e].push(t):this._listeners[e]=[t],()=>{this.unsubscribeChanges(e,t)}}unsubscribeChanges(e,t){if(!(e in this._listeners))return;const s=this._listeners[e].indexOf(t);-1!==s&&this._listeners[e].splice(s,1)}hasKey(e){return e in this._storage}getValue(e){return this._storage[e]}setValue(e,t){const s=this._storage[e];this._storage[e]=t;try{void 0===t?this.storage.removeItem(e):this.storage.setItem(e,JSON.stringify(t))}catch(e){}finally{this._listeners[e]&&this._listeners[e].forEach((e=>e(s,t)))}}}const i={},n=e=>t=>{const s=e.storage||"localStorage";let n;s&&s in i?n=i[s]:(n=new a(window[s]),i[s]=n);const o=String(t.key),r=e.key||String(t.key),c=t.initializer?t.initializer():void 0;n.addFromStorage(r);const d=!1!==e.subscribe?e=>n.subscribeChanges(r,((s,a)=>{e.requestUpdate(t.key,s)})):void 0,u=()=>n.hasKey(r)?e.deserializer?e.deserializer(n.getValue(r)):n.getValue(r):c;return{kind:"method",placement:"prototype",key:t.key,descriptor:{set(s){((s,a)=>{let i;e.state&&(i=u()),n.setValue(r,e.serializer?e.serializer(a):a),e.state&&s.requestUpdate(t.key,i)})(this,s)},get:()=>u(),enumerable:!0,configurable:!0},finisher(s){if(e.state&&e.subscribe){const e=s.prototype.connectedCallback,t=s.prototype.disconnectedCallback;s.prototype.connectedCallback=function(){e.call(this),this[`__unbsubLocalStorage${o}`]=d?.(this)},s.prototype.disconnectedCallback=function(){t.call(this),this[`__unbsubLocalStorage${o}`]?.(),this[`__unbsubLocalStorage${o}`]=void 0}}e.state&&s.createProperty(t.key,{noAccessor:!0,...e.stateOptions})}}}},6736:function(e,t,s){s.d(t,{f:()=>o});var a=s(44249),i=s(72621),n=(s(39527),s(36993),s(15093));const o=e=>(0,a.Z)(null,(function(e,t){class s extends t{constructor(...t){super(...t),e(this)}}return{F:s,d:[{kind:"field",decorators:[(0,n.Cb)({attribute:!1})],key:"hass",value:void 0},{kind:"field",key:"hassSubscribeRequiredHostProps",value:void 0},{kind:"field",key:"__unsubs",value:void 0},{kind:"method",key:"connectedCallback",value:function(){(0,i.Z)(s,"connectedCallback",this,3)([]),this._checkSubscribed()}},{kind:"method",key:"disconnectedCallback",value:function(){if((0,i.Z)(s,"disconnectedCallback",this,3)([]),this.__unsubs){for(;this.__unsubs.length;){const e=this.__unsubs.pop();e instanceof Promise?e.then((e=>e())):e()}this.__unsubs=void 0}}},{kind:"method",key:"updated",value:function(e){if((0,i.Z)(s,"updated",this,3)([e]),e.has("hass"))this._checkSubscribed();else if(this.hassSubscribeRequiredHostProps)for(const t of e.keys())if(this.hassSubscribeRequiredHostProps.includes(t))return void this._checkSubscribed()}},{kind:"method",key:"hassSubscribe",value:function(){return[]}},{kind:"method",key:"_checkSubscribed",value:function(){void 0===this.__unsubs&&this.isConnected&&void 0!==this.hass&&!this.hassSubscribeRequiredHostProps?.some((e=>void 0===this[e]))&&(this.__unsubs=this.hassSubscribe())}}]}}),e)},20548:function(e,t,s){s.d(t,{H:()=>n});var a=s(11259),i=s(4643);function n(e,t,s,n,o,r){const c=e.getPropertyValue(o+"-"+r).trim(),d=c.length>0?c:e.getPropertyValue(o).trim();let u=(0,a.Rq)(d);return 0===c.length&&r&&(u=(0,a.CO)((0,a.p3)(t?(0,i.C)((0,a.Rw)((0,a.wK)(u)),r):(0,i.W)((0,a.Rw)((0,a.wK)(u)),r)))),n?u+=s?"32":"7F":s&&(u+="7F"),u}},53259:function(e,t,s){s.a(e,(async function(e,a){try{s.d(t,{J:()=>g,MC:()=>k,Zx:()=>S,b4:()=>y,kT:()=>$});s(92745),s(92519),s(42179),s(89256),s(24931),s(88463),s(57449),s(19814),s(39527),s(99790),s(41360),s(13334);var i=s(21893),n=s(13809),o=s(38836),r=s(84775),c=s(80951),d=s(13730),u=s(6542),h=s(83204),l=s(23459),f=s(23711),p=s(50602),m=s(46467),_=s(33570),b=e([m,_,p]);function k(e,t){let s=new Date(t);return e>2&&0===s.getHours()&&(s=(0,i.b)(s,1)),s.setMinutes(0,0,0),e>35&&s.setDate(1),e>2&&s.setHours(0),s.getTime()}function y(e){return e>35?"month":e>2?"day":"hour"}function g(e,t,s,a,i,o,r,c){const d=(0,n.j)(t,e),u=void 0!==o&&void 0!==r;return{xAxis:{type:"time",min:e,max:k(d,t)},yAxis:{type:"value",name:i,nameGap:2,nameTextStyle:{align:"left"},axisLabel:{formatter:e=>(0,p.uf)(Math.abs(e),s)},splitLine:{show:!0}},grid:{top:15,bottom:0,left:1,right:1,containLabel:!0},tooltip:{trigger:"axis",formatter:e=>{if(Array.isArray(e)){const t=[],n=[];return e.forEach((e=>{e.seriesId?.startsWith("compare-")?n.push(e):t.push(e)})),[t,n].map((e=>v(e,s,a,d,u,i,c))).filter(Boolean).join("<br><br>")}return v([e],s,a,d,u,i,c)}}}}function v(e,t,s,a,i,n,r){if(!e[0]?.value)return"";const c=new Date(e[0].value?.[2]??e[0].value?.[0]);let d;d=a>89?`${(0,m.NC)(c,t,s)}`:a>0?`${(0,m.ud)(c,t,s)}`:`${i?`${(0,m.ud)(c,t,s)}: `:""}${(0,_.mr)(c,t,s)} â€“ ${(0,_.mr)((0,o.T)(c,1),t,s)}`;const u=`<h4 style="text-align: center; margin: 0;">${d}</h4>`;let h=0,l=0,f=0,b=0;const k=e.map((e=>{const s=e.value?.[1],a=(0,p.uf)(s,t);return"0"!==a&&("bar"===e.componentSubType&&(s>0?(h+=s,l++):(f+=s,b++)),`${e.marker} ${e.seriesName}: ${a} ${n}`)})).filter(Boolean);let y="";return 0!==h&&l>1&&r&&(y+=`<br><b>${r(h)}</b>`),0!==f&&b>1&&r&&(y+=`<br><b>${r(f)}</b>`),k.length>0?`${u}${k.join("<br>")}${y}`:""}function S(e){Array.from(new Set(e.map((e=>e.data.map((e=>Number(e[0]))))).flat())).sort(((e,t)=>e-t)).forEach(((t,s)=>{const a={},i={};for(let n=e.length-1;n>=0;n--){const o=e[n].data[s],r=o&&"object"==typeof o&&"value"in o?o:{value:o},c=r.value?.[0],d=e[n].stack??"";void 0!==c&&(Number(c)!==t?e[n].data?.splice(s,0,{value:[t,0],itemStyle:{borderWidth:0}}):0===r.value?.[1]?e[n].data[s]={...r,itemStyle:{...r.itemStyle,borderWidth:0}}:!a[d]&&r.value?.[1]>0?(e[n].data[s]={...r,itemStyle:{...r.itemStyle,borderRadius:[4,4,0,0]}},a[d]=!0):!i[d]&&r.value?.[1]<0&&(e[n].data[s]={...r,itemStyle:{...r.itemStyle,borderRadius:[0,0,4,4]}},i[d]=!0))}}))}function $(e,t){if(!t)return e=>e;const s=(0,r.o)(e,t);if(0!==s&&e.getTime()===(0,c.e)(e).getTime())return e=>(0,d.B)(e,s);const a=(0,u.d)(e,t);if(0!==a&&e.getTime()===(0,h.N)(e).getTime())return e=>(0,l.z)(e,a);const i=e.getTime()-t.getTime();return e=>(0,f.n)(e,i)}[m,_,p]=b.then?(await b)():b,a()}catch(C){a(C)}}))},36681:function(e,t,s){s.a(e,(async function(e,a){try{s.r(t),s.d(t,{HuiEnergyDevicesDetailGraphCard:()=>$});var i=s(44249),n=(s(92745),s(39527),s(99790),s(41360),s(13334),s(34595),s(42625)),o=s(83389),r=s(57243),c=s(15093),d=s(35359),u=s(27486),h=s(50875),l=s(20548),f=(s(54977),s(25179)),p=s(1118),m=s(17705),_=s(6736),b=s(93331),k=s(53259),y=s(68958),g=s(50602),v=e([f,g,p,k]);[f,g,p,k]=v.then?(await v)():v;const S="kWh";let $=(0,i.Z)([(0,c.Mo)("hui-energy-devices-detail-graph-card")],(function(e,t){return{F:class extends t{constructor(...t){super(...t),e(this)}},d:[{kind:"field",decorators:[(0,c.Cb)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,c.SB)()],key:"_config",value:void 0},{kind:"field",decorators:[(0,c.SB)()],key:"_chartData",value:()=>[]},{kind:"field",decorators:[(0,c.SB)()],key:"_data",value:void 0},{kind:"field",decorators:[(0,c.SB)()],key:"_start",value:()=>(0,n.I)()},{kind:"field",decorators:[(0,c.SB)()],key:"_end",value:()=>(0,o.p)()},{kind:"field",decorators:[(0,c.SB)()],key:"_compareStart",value:void 0},{kind:"field",decorators:[(0,c.SB)()],key:"_compareEnd",value:void 0},{kind:"field",decorators:[(0,y.t)({key:"energy-devices-hidden-stats",state:!0,subscribe:!1})],key:"_hiddenStats",value:()=>[]},{kind:"field",key:"hassSubscribeRequiredHostProps",value:()=>["_config"]},{kind:"method",key:"hassSubscribe",value:function(){return[(0,p.UB)(this.hass,{key:this._config?.collection_key}).subscribe((e=>{this._data=e,this._processStatistics()}))]}},{kind:"method",key:"getCardSize",value:function(){return 3}},{kind:"method",key:"setConfig",value:function(e){this._config=e}},{kind:"method",key:"shouldUpdate",value:function(e){return(0,b.SN)(this,e)||e.size>1||!e.has("hass")}},{kind:"method",key:"willUpdate",value:function(e){(e.has("_hiddenStats")||e.has("_config"))&&this._data&&this._processStatistics()}},{kind:"method",key:"render",value:function(){return this.hass&&this._config?r.dy` <ha-card> ${this._config.title?r.dy`<h1 class="card-header">${this._config.title}</h1>`:""} <div class="content ${(0,d.$)({"has-header":!!this._config.title})}"> <ha-chart-base external-hidden .hass="${this.hass}" .data="${this._chartData}" .options="${this._createOptions(this._start,this._end,this.hass.locale,this.hass.config,S,this._compareStart,this._compareEnd)}" @dataset-hidden="${this._datasetHidden}" @dataset-unhidden="${this._datasetUnhidden}"></ha-chart-base> </div> </ha-card> `:r.Ld}},{kind:"field",key:"_formatTotal",value(){return e=>this.hass.localize("ui.panel.lovelace.cards.energy.energy_usage_graph.total_consumed",{num:(0,g.uf)(e,this.hass.locale),unit:S})}},{kind:"method",key:"_datasetHidden",value:function(e){this._hiddenStats=[...this._hiddenStats,e.detail.name]}},{kind:"method",key:"_datasetUnhidden",value:function(e){this._hiddenStats=this._hiddenStats.filter((t=>t!==e.detail.name))}},{kind:"field",key:"_createOptions",value(){return(0,u.Z)(((e,t,s,a,i,n,o)=>({...(0,k.J)(e,t,s,a,i,n,o,this._formatTotal),legend:{show:!0,type:"scroll",animationDurationUpdate:400,selected:this._hiddenStats.reduce(((e,t)=>(e[t]=!1,e)),{}),icon:"circle"},grid:{top:45,bottom:0,left:1,right:1,containLabel:!0}})))}},{kind:"method",key:"_processStatistics",value:function(){const e=this._data;this._start=e.start,this._end=e.end||(0,o.p)(),this._compareStart=e.startCompare,this._compareEnd=e.endCompare;const t=e.stats,s=e.statsCompare,a=getComputedStyle(this),i={};e.prefs.device_consumption.forEach((e=>{const s=e.stat_consumption in t&&(0,m.Kj)(t[e.stat_consumption])||0;i[e.stat_consumption]=s}));const n=e.prefs.device_consumption.map((e=>e.stat_consumption));n.sort(((e,t)=>i[t]-i[e]));const r=[],{summedData:c,compareSummedData:d}=(0,p.EH)(e),u="from_grid"in c||"solar"in c||"from_battery"in c,{consumption:h,compareConsumption:l}=u?(0,p.E4)(c,d):{consumption:void 0,compareConsumption:void 0};if(s){const t=this._processDataSet(a,s,e.statsMetadata,e.prefs.device_consumption,n,!0);if(r.push(...t),u){const e=this._processUntracked(a,t,l,!0);r.push(e)}}else{const t=e.prefs.device_consumption[0]?.stat_consumption??"untracked";r.push({id:"compare-"+t,type:"bar",stack:"devices",data:[]})}const f=this._processDataSet(a,t,e.statsMetadata,e.prefs.device_consumption,n);if(r.push(...f),u){const e=this._processUntracked(a,f,h,!1);r.push(e)}(0,k.Zx)(r),this._chartData=r}},{kind:"method",key:"_processUntracked",value:function(e,t,s,a){const i={};t.forEach((e=>{e.data.forEach((e=>{i[e[a?2:0]]=(i[e[a?2:0]]||0)+e[1]}))}));const n=(0,k.kT)(this._start,this._compareStart),o=[];Object.keys(s.total).forEach((e=>{const t=Number(e),r=[t,s.total[e]-(i[e]||0)];a&&(r[2]=r[0],r[0]=n(new Date(t)).getTime()),o.push(r)}));const r=Date.now();return{type:"bar",cursor:"default",id:a?`compare-untracked-${r}`:`untracked-${r}`,name:this.hass.localize("ui.panel.lovelace.cards.energy.energy_devices_detail_graph.untracked_consumption"),itemStyle:{borderColor:(0,l.H)(e,this.hass.themes.darkMode,!1,a,"--state-unavailable-color")},barMaxWidth:50,color:(0,l.H)(e,this.hass.themes.darkMode,!0,a,"--state-unavailable-color"),data:o,stack:a?"devicesCompare":"devices"}}},{kind:"method",key:"_processDataSet",value:function(e,t,s,a,i,n=!1){const o=[],r=(0,k.kT)(this._start,this._compareStart);return a.forEach(((a,c)=>{const d=i.indexOf(a.stat_consumption);if(this._config?.max_devices&&d>=this._config.max_devices)return void console.warn(`Max devices exceeded for ${a.name} (${d} >= ${this._config.max_devices})`);const u=(0,h.hZ)(c,e);let l=null;const f=[];if(a.stat_consumption in t){const e=t[a.stat_consumption];for(const t of e){if(null===t.change||void 0===t.change||0===t.change)continue;if(l===t.start)continue;const e=[t.start,t.change];n&&(e[2]=e[0],e[0]=r(new Date(t.start)).getTime()),f.push(e),l=t.start}}o.push({type:"bar",cursor:"default",id:n?`compare-${a.stat_consumption}-${d}`:`${a.stat_consumption}-${d}`,name:a.name||(0,m.Kd)(this.hass,a.stat_consumption,s[a.stat_consumption]),itemStyle:{borderColor:n?u+"7F":u},barMaxWidth:50,color:n?u+"32":u+"7F",data:f,stack:n?"devicesCompare":"devices"})})),i.map((e=>o.find((t=>t.id.replace(/^compare-/,"").replace(/-\d+$/,"")===e)))).filter(Boolean)}},{kind:"field",static:!0,key:"styles",value:()=>r.iv`.card-header{padding-bottom:0}.content{padding:16px}.has-header{padding-top:0}`}]}}),(0,_.f)(r.oi));a()}catch(e){a(e)}}))},5376:function(e,t,s){s.d(t,{X:()=>o});var a=s(34151),i=s(76808),n=s(14276);function o(e,t,s){const o=(0,n._)(e,t)/i.yJ;return(0,a.u)(s?.roundingMethod)(o)}},83389:function(e,t,s){s.d(t,{p:()=>i});var a=s(96500);function i(e){return(0,a.i)(Date.now(),e)}},42625:function(e,t,s){s.d(t,{I:()=>i});var a=s(7591);function i(e){return(0,a.b)(Date.now(),e)}}};
//# sourceMappingURL=75034.272129cdd41efc92.js.map