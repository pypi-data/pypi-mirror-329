(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2423],{95372:function(e){e.exports=function(e,t,n,i){for(var a=e.length,s=n+(i?1:-1);i?s--:++s<a;)if(t(e[s],s,e))return s;return -1}},74833:function(e,t,n){var i=n(56127),a=/^\s+/;e.exports=function(e){return e?e.slice(0,i(e)+1).replace(a,""):e}},56632:function(e,t,n){var i=n(89278),a=n(80068),s=n(50098);e.exports=function(e){return function(t,n,o){var r=Object(t);if(!a(t)){var l=i(n,3);t=s(t),n=function(e){return l(r[e],e,r)}}var d=e(t,n,o);return d>-1?r[l?t[d]:d]:void 0}}},56127:function(e){var t=/\s/;e.exports=function(e){for(var n=e.length;n--&&t.test(e.charAt(n)););return n}},64925:function(e,t,n){var i=n(56632)(n(66259));e.exports=i},66259:function(e,t,n){var i=n(95372),a=n(89278),s=n(47991),o=Math.max;e.exports=function(e,t,n){var r=null==e?0:e.length;if(!r)return -1;var l=null==n?0:s(n);return l<0&&(l=o(r+l,0)),i(e,a(t,3),l)}},94919:function(e,t,n){var i=n(91936),a=1/0;e.exports=function(e){return e?(e=i(e))===a||e===-a?(e<0?-1:1)*17976931348623157e292:e==e?e:0:0===e?e:0}},47991:function(e,t,n){var i=n(94919);e.exports=function(e){var t=i(e),n=t%1;return t==t?n?t-n:t:0}},91936:function(e,t,n){var i=n(74833),a=n(11611),s=n(55193),o=0/0,r=/^[-+]0x[0-9a-f]+$/i,l=/^0b[01]+$/i,d=/^0o[0-7]+$/i,c=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(s(e))return o;if(a(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=a(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=i(e);var n=l.test(e);return n||d.test(e)?c(e.slice(2),n?2:8):r.test(e)?o:+e}},86850:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/data-discovery/action-center/[monitorId]",function(){return n(53426)}])},37541:function(e,t,n){"use strict";var i=n(24246),a=n(41748),s=n(53614);t.Z=e=>{let{heading:t,breadcrumbItems:n,isSticky:o=!0,children:r,rightContent:l,style:d,...c}=e;return(0,i.jsxs)("div",{...c,style:o?{position:"sticky",top:"-24px",paddingTop:"24px",paddingBottom:"24px",paddingLeft:"40px",marginLeft:"-40px",paddingRight:"40px",marginRight:"-40px",marginTop:"-24px",left:0,zIndex:20,backgroundColor:"white",...d}:{paddingBottom:"24px",...d},children:[(0,i.jsxs)(a.jqI,{justify:"space-between",children:["string"==typeof t?(0,i.jsx)(a.X6q,{className:n||r?"pb-4":void 0,fontSize:"2xl","data-testid":"page-heading",children:t}):t,l&&(0,i.jsx)("div",{"data-testid":"page-header-right-content",children:l})]}),!!n&&(0,i.jsx)(s.m,{className:r?"pb-4":void 0,items:n,"data-testid":"page-breadcrumb"}),r]})}},19310:function(e,t,n){"use strict";var i=n(24246),a=n(64925),s=n.n(a),o=n(27378),r=n(44296),l=n(91650),d=n(79851),c=n(47411);let u=()=>{let{isLoading:e}=(0,d.fd)(),t=(0,r.C)(d.U3),{isLoading:n}=(0,c.MO)(),i=(0,r.C)(c.qb),{isLoading:a}=(0,l.te)();return{dataUses:t,dataSubjects:(0,r.C)(l.ZL),dataCategories:i,isLoading:e||n||a}};t.Z=()=>{let{dataUses:e,dataCategories:t,dataSubjects:n,isLoading:a}=u(),r=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return e.split(".").slice(0,t).join(".")},l=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=t(e);if(!i)return{};let a=t(r(e,n)),s=!!i.parent_key;return{name:i.name||void 0,primaryName:s&&(null==a?void 0:a.name)!==i.name&&(null==a?void 0:a.name)||void 0}},d=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,{name:a,primaryName:s}=l(e,t,n);return a?s?(0,i.jsxs)(o.Fragment,{children:[(0,i.jsxs)("strong",{children:[s,":"]})," ",a]},e):(0,i.jsx)("strong",{children:a},e):e},c=t=>s()(e,{fides_key:t}),g=e=>s()(t,{fides_key:e}),m=e=>s()(n,{fides_key:e});return{getDataUses:()=>e,getDataUseByKey:c,getDataUseDisplayName:e=>d(e,c,1),getDataUseDisplayNameProps:e=>l(e,c,1),getDataCategories:()=>t,getDataCategoryByKey:g,getDataCategoryDisplayName:e=>d(e,g,2),getDataCategoryDisplayNameProps:e=>l(e,g,2),getDataSubjects:()=>n,getDataSubjectByKey:m,getDataSubjectDisplayName:e=>{let t=m(e);return t?t.name:e},getPrimaryKey:r,isLoading:a}}},53614:function(e,t,n){"use strict";n.d(t,{m:function(){return d}});var i=n(24246),a=n(41748),s=n(79894),o=n.n(s),r=n(27378);let{Text:l}=a.AntTypography,d=e=>{let{items:t,...n}=e,s=(0,r.useMemo)(()=>null==t?void 0:t.map((e,n)=>{let s=n===t.length-1,r={...e},d=r.onClick&&!r.href;return("string"==typeof r.title&&(r.title=(0,i.jsx)(l,{style:{color:"inherit",maxWidth:s?void 0:400},ellipsis:!s,children:r.title})),d)?r.title=(0,i.jsx)(a.wpx,{type:"text",size:"small",icon:r.icon,onClick:r.onClick,className:"ant-breadcrumb-link -mt-px px-1 text-inherit",children:r.title}):(r.icon&&(r.title=(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("span",{className:"anticon align-text-bottom",children:r.icon}),r.title]})),r.href&&r.title&&(r.title=(0,i.jsx)(o(),{href:r.href,className:"ant-breadcrumb-link",children:r.title}),delete r.href)),r}),[t]);return(0,i.jsx)(a.zrq,{items:s,...n})}},2686:function(e,t,n){"use strict";n.d(t,{dK:function(){return c},Rv:function(){return m},$P:function(){return g},zj:function(){return h},Kr:function(){return x},q1:function(){return u},QL:function(){return f}});var i=n(24246),a=n(41748);let s=(0,a.IUT)({displayName:"CircleIcon",viewBox:"0 0 200 200",path:(0,i.jsx)("path",{fill:"currentColor",d:"M 100, 100 m -75, 0 a 75,75 0 1,0 150,0 a 75,75 0 1,0 -150,0"})}),o=(0,a.IUT)({displayName:"RightDownArrowIcon",viewBox:"0 0 8 8",path:(0,i.jsx)("path",{fill:"currentColor",d:"M7.23192 8H8V7.23192V1.85539V1.08731H6.46385V1.85539V5.37654L1.62976 0.544855L1.08731 0L0 1.08731L0.542454 1.62976L5.37654 6.46385H1.85539H1.08731V8H1.85539H7.23192Z"})}),r=(0,a.IUT)({displayName:"RightUpArrowIcon",viewBox:"0 0 8 8",path:(0,i.jsx)("path",{fill:"currentColor",d:"M7.23192 0H8V0.768077V6.14461V6.91269H6.46385V6.14461V2.62346L1.62976 7.45515L1.08731 8L0 6.91269L0.542454 6.37024L5.37654 1.53615H1.85539H1.08731V0H1.85539H7.23192Z"})}),l=(0,a.IUT)({displayName:"TagIcon",viewBox:"0 0 9 10",path:(0,i.jsx)("path",{fill:"currentColor",d:"M0 0.5V5L4.5 9.5L9 5L4.5 0.5H0ZM2.25 2.10714C2.4205 2.10714 2.58401 2.17487 2.70457 2.29543C2.82513 2.41599 2.89286 2.5795 2.89286 2.75C2.89286 2.9205 2.82513 3.08401 2.70457 3.20457C2.58401 3.32513 2.4205 3.39286 2.25 3.39286C2.0795 3.39286 1.91599 3.32513 1.79543 3.20457C1.67487 3.08401 1.60714 2.9205 1.60714 2.75C1.60714 2.5795 1.67487 2.41599 1.79543 2.29543C1.91599 2.17487 2.0795 2.10714 2.25 2.10714Z"})});var d=n(51557);let c=()=>(0,i.jsx)(r,{color:"green.400",boxSize:2,mr:2,"data-testid":"add-icon"}),u=()=>(0,i.jsx)(o,{color:"red.400",boxSize:2,mr:2,"data-testid":"remove-icon"}),g=()=>(0,i.jsx)(l,{color:"orange.400",boxSize:3,mr:1,"data-testid":"classify-icon"}),m=()=>(0,i.jsx)(s,{color:"blue.400",boxSize:2,mr:2,"data-testid":"change-icon"}),h=()=>(0,i.jsx)(s,{color:"green.400",boxSize:2,mr:2,"data-testid":"monitored-icon"}),x=()=>(0,i.jsx)(s,{color:"red.400",boxSize:2,mr:2,"data-testid":"muted-icon"}),f={[d.E.ADDITION]:(0,i.jsx)(c,{}),[d.E.REMOVAL]:(0,i.jsx)(u,{}),[d.E.CLASSIFICATION]:(0,i.jsx)(g,{}),[d.E.CHANGE]:(0,i.jsx)(m,{}),[d.E.MONITORED]:(0,i.jsx)(h,{}),[d.E.MUTED]:(0,i.jsx)(x,{}),[d.E.IN_PROGRESS]:(0,i.jsx)(()=>(0,i.jsx)(s,{color:"orange.400",boxSize:2,mr:2,"data-testid":"in-progress-icon"}),{}),[d.E.NONE]:null}},51557:function(e,t,n){"use strict";var i,a;n.d(t,{E:function(){return i}}),(a=i||(i={})).ADDITION="Addition",a.CHANGE="Change",a.REMOVAL="Removal",a.CLASSIFICATION="Classification",a.IN_PROGRESS="Classifying",a.MONITORED="Monitoring",a.MUTED="Unmonitored",a.NONE="--"},53426:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return N}});var i=n(24246),a=n(86677),s=n(65464),o=n(87162),r=n(37541),l=n(59003),d=n(92222),c=n(41748),u=n(27378),g=n(60136),m=n(53359),h=n(8540),x=n(83543),f=n(43073),p=n(22770),v=n(19310),j=n(98320),y=n(89721),b=e=>{var t,n;let{system:a}=e,{getDataUseDisplayName:s}=(0,v.Z)(),o=(null!==(n=null===(t=a.data_uses)||void 0===t?void 0:t.filter(e=>(0,y.Z)(e)))&&void 0!==n?n:[]).map(e=>({label:s(e),key:e}));return(0,i.jsx)(j.mb,{values:o,bgColor:"white",borderWidth:"1px",borderColor:"gray.200"})};let C=e=>{let{monitorId:t,system:n}=e,[a,{isLoading:s}]=(0,x.rs)(),[r,{isLoading:l}]=(0,x.nP)(),{successAlert:d,errorAlert:u}=(0,m.V)(),h=s||l,{id:f,name:p,system_key:v,total_updates:j}=n,y=async()=>{let e=await a({monitor_config_key:t,resolved_system_ids:[f]});(0,g.D4)(e)?u((0,g.e$)(e.error)):d(v?"".concat(j," assets from ").concat(p," have been added to the system inventory."):"".concat(p," and ").concat(j," assets have been added to the system inventory. ").concat(p," is now configured for consent."),"Confirmed")},b=async()=>{let e=await r({monitor_config_key:t,resolved_system_ids:[f||o.Kl]});(0,g.D4)(e)?u((0,g.e$)(e.error)):d(p?"".concat(j," assets from ").concat(p," have been ignored and will not appear in future scans."):"".concat(j," uncategorized assets have been ignored and will not appear in future scans."),"Confirmed")};return(0,i.jsxs)(c.vyj,{children:[(0,i.jsx)(c.esZ,{title:n.id?void 0:"These assets must be categorized before you can add them to the inventory.",children:(0,i.jsx)(c.wpx,{"data-testid":"add-btn",size:"small",onClick:y,disabled:!n.id||h,loading:s,children:"Add"})}),(0,i.jsx)(c.wpx,{"data-testid":"ignore-btn",size:"small",onClick:b,disabled:h,loading:l,children:"Ignore"})]})};var w=n(2686);let _=e=>{let{system:t}=e;return(0,i.jsxs)(c.kCb,{alignItems:"center",height:"100%",children:[!(null==t?void 0:t.system_key)&&(0,i.jsx)(c.ua7,{label:"New system",children:(0,i.jsx)("span",{children:w.QL.Change})}),(0,i.jsx)(c.xvT,{fontSize:"xs",fontWeight:"semibold",lineHeight:4,overflow:"hidden",textOverflow:"ellipsis",children:(null==t?void 0:t.name)||"Uncategorized assets"})]})},k=e=>{let t=(0,d.Cl)();return{columns:[t.display({id:"select",cell:e=>{let{row:t}=e;return(0,i.jsx)(h.k,{isChecked:t.getIsSelected(),onChange:t.getToggleSelectedHandler(),dataTestId:"select-".concat(t.original.name||t.id)})},header:e=>{let{table:t}=e;return(0,i.jsx)(h.k,{isChecked:t.getIsAllPageRowsSelected(),isIndeterminate:t.getIsSomeRowsSelected(),onChange:t.getToggleAllRowsSelectedHandler(),dataTestId:"select-all-rows"})},maxSize:40,meta:{disableRowClick:!0}}),t.accessor(e=>e.name,{id:"system_name",cell:e=>(0,i.jsx)(_,{system:e.row.original}),header:"System",meta:{width:"auto"}}),t.accessor(e=>e.total_updates,{id:"total_updates",cell:e=>(0,i.jsx)(h.G3,{value:e.getValue()}),header:"Assets",size:80}),t.display({id:"data_use",cell:e=>(0,i.jsx)(b,{system:e.row.original}),header:"Categories of consent",meta:{width:"auto",disableRowClick:!0}}),t.accessor(e=>e.locations,{id:"locations",cell:e=>(0,i.jsx)(h.G3,{value:e.getValue().length>1?"".concat(e.getValue().length," locations"):e.getValue()[0]}),header:"Locations"}),t.accessor(e=>e.domains,{id:"domains",cell:e=>(0,i.jsx)(h.G3,{value:e.getValue().length>1?"".concat(e.getValue().length," domains"):e.getValue()[0]}),header:"Domains"}),t.display({id:"actions",cell:t=>(0,i.jsx)(C,{system:t.row.original,monitorId:e}),header:"Actions",meta:{width:"auto",disableRowClick:!0}})]}},I=e=>{let{monitorId:t}=e,n=(0,a.useRouter)(),{PAGE_SIZES:s,pageSize:r,setPageSize:v,onPreviousPageClick:j,isPreviousPageDisabled:y,onNextPageClick:b,isNextPageDisabled:C,startRange:w,endRange:_,pageIndex:I,setTotalPages:N,resetPageIndexToDefault:S}=(0,h.oi)(),[E,{isLoading:R}]=(0,x.rs)(),[D,{isLoading:L}]=(0,x.nP)(),{successAlert:z,errorAlert:A}=(0,m.V)(),[T,V]=(0,u.useState)(""),[P,M]=(0,u.useState)({});(0,u.useEffect)(()=>{S()},[t,T,S]);let{data:O,isLoading:H,isFetching:U}=(0,x.wi)({key:t,page:I,size:r,search:T});(0,u.useEffect)(()=>{O&&N(O.pages||1)},[O,N]);let{columns:Z}=k(t),$=(0,l.b7)({getCoreRowModel:(0,d.sC)(),columns:Z,manualPagination:!0,data:(null==O?void 0:O.items)||[],columnResizeMode:"onChange",onRowSelectionChange:M,state:{rowSelection:P}}),q=$.getSelectedRowModel().rows,G=q.some(e=>null===e.original.id);if(H)return(0,i.jsx)(h.I4,{rowHeight:36,numRows:36});let B=async()=>{let e=q.reduce((e,t)=>e+t.original.total_updates,0),n=await E({monitor_config_key:t,resolved_system_ids:q.map(e=>e.original.id)});(0,f.D4)(n)?A((0,g.e$)(n.error)):(z("".concat(e," assets have been added to the system inventory.")),M({}))},K=async()=>{let e=q.reduce((e,t)=>e+t.original.total_updates,0),n=await D({monitor_config_key:t,resolved_system_ids:q.map(e=>{var t;return null!==(t=e.original.id)&&void 0!==t?t:o.Kl})});(0,f.D4)(n)?A((0,g.e$)(n.error)):(z("".concat(e," assets have been ignored and will not appear in future scans.")),M({}))};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(h.Q$,{children:(0,i.jsxs)(c.kCb,{direction:"row",alignItems:"center",justifyContent:"space-between",width:"full",children:[(0,i.jsx)(c.kCb,{gap:6,align:"center",children:(0,i.jsx)(c.xuv,{flexShrink:0,children:(0,i.jsx)(p.M,{value:T,onChange:V})})}),(0,i.jsxs)(c.kCb,{align:"center",children:[!!q.length&&(0,i.jsx)(c.xvT,{fontSize:"xs",fontWeight:"semibold",minW:16,mr:6,"data-testid":"selected-count",children:"".concat(q.length," selected")}),(0,i.jsxs)(c.v2r,{children:[(0,i.jsx)(c.j2t,{as:c.wpx,icon:(0,i.jsx)(c.PJP._ME,{}),iconPosition:"end",loading:R||L,"data-testid":"bulk-actions-menu",disabled:!q.length,type:"primary",children:"Actions"}),(0,i.jsxs)(c.qyq,{children:[(0,i.jsx)(c.esZ,{title:G?"Uncategorized assets can't be added to the inventory":null,placement:"left",children:(0,i.jsx)(c.sNh,{fontSize:"small",onClick:B,"data-testid":"bulk-add",isDisabled:G,children:"Add"})}),(0,i.jsx)(c.sNh,{fontSize:"small",onClick:K,"data-testid":"bulk-ignore",children:"Ignore"})]})]})]})]})}),(0,i.jsx)(h.ZK,{tableInstance:$,onRowClick:e=>{var i;n.push("".concat(o.vi,"/").concat(t,"/").concat(null!==(i=e.id)&&void 0!==i?i:o.Kl))},emptyTableNotice:(0,i.jsx)(c.oj8,{image:c.oj8.PRESENTED_IMAGE_SIMPLE,description:"All caught up!"})}),(0,i.jsx)(h.s8,{totalRows:(null==O?void 0:O.items.length)||0,pageSizes:s,setPageSize:v,onPreviousPageClick:j,isPreviousPageDisabled:y||U,onNextPageClick:b,isNextPageDisabled:C||U,startRange:w,endRange:_})]})};var N=()=>{let e=decodeURIComponent((0,a.useRouter)().query.monitorId);return(0,i.jsxs)(s.Z,{title:"Action center - Discovered assets by system",children:[(0,i.jsx)(r.Z,{heading:"Action center",breadcrumbItems:[{title:"All activity",href:o.vi},{title:e}]}),(0,i.jsx)(I,{monitorId:e})]})}}},function(e){e.O(0,[8033,5559,4554,2866,9278,8540,3089,2888,9774,179],function(){return e(e.s=86850)}),_N_E=e.O()}]);