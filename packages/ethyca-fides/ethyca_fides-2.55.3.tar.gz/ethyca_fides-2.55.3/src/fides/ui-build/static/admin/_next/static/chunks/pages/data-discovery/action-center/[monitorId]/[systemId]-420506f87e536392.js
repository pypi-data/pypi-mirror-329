(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4154],{58095:function(e,t,s){var n=s(8817);e.exports=function(e,t){return!!(null==e?0:e.length)&&n(e,t,0)>-1}},21796:function(e){e.exports=function(e,t,s){for(var n=-1,a=null==e?0:e.length;++n<a;)if(s(t,e[n]))return!0;return!1}},8817:function(e,t,s){var n=s(95372),a=s(1129),i=s(58263);e.exports=function(e,t,s){return t==t?i(e,t,s):n(e,a,s)}},1129:function(e){e.exports=function(e){return e!=e}},92198:function(e,t,s){var n=s(52485),a=s(58095),i=s(21796),l=s(65581),r=s(47111),o=s(43735);e.exports=function(e,t,s){var d=-1,c=a,u=e.length,m=!0,h=[],g=h;if(s)m=!1,c=i;else if(u>=200){var x=t?null:r(e);if(x)return o(x);m=!1,c=l,g=new n}else g=t?[]:h;e:for(;++d<u;){var v=e[d],p=t?t(v):v;if(v=s||0!==v?v:0,m&&p==p){for(var f=g.length;f--;)if(g[f]===p)continue e;t&&g.push(p),h.push(v)}else c(g,p,s)||(g!==h&&g.push(p),h.push(v))}return h}},47111:function(e,t,s){var n=s(46151),a=s(50344),i=s(43735),l=n&&1/i(new n([,-0]))[1]==1/0?function(e){return new n(e)}:a;e.exports=l},58263:function(e){e.exports=function(e,t,s){for(var n=s-1,a=e.length;++n<a;)if(e[n]===t)return n;return -1}},50344:function(e){e.exports=function(){}},83766:function(e,t,s){var n=s(92198);e.exports=function(e){return e&&e.length?n(e):[]}},25654:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/data-discovery/action-center/[monitorId]/[systemId]",function(){return s(5441)}])},78973:function(e,t,s){"use strict";s.d(t,{d:function(){return d}});var n=s(24246),a=s(41748),i=s(34090),l=s(27378),r=s(39514),o=s(34803);let d=e=>{let{name:t,label:s,labelProps:d,tooltip:c,isRequired:u,layout:m="inline",...h}=e,[g,x,{setValue:v}]=(0,i.U$)(t),p=!!(x.touched&&x.error),[f,y]=(0,l.useState)("");g.value||"tags"!==h.mode&&"multiple"!==h.mode||(g.value=[]),"tags"===h.mode&&"string"==typeof g.value&&(g.value=[g.value]);let j="tags"===h.mode?(e,t)=>e?e.value!==f||g.value.includes(f)?h.optionRender?h.optionRender(e,t):e.label:'Create "'.concat(f,'"'):void 0:h.optionRender||void 0,b=e=>{y(e),h.onSearch&&h.onSearch(e)},C=(e,t)=>{v(e),h.onChange&&h.onChange(e,t)};return"inline"===m?(0,n.jsx)(a.NIc,{isInvalid:p,isRequired:u,children:(0,n.jsxs)(a.rjZ,{templateColumns:s?"1fr 3fr":"1fr",children:[s?(0,n.jsx)(o.__,{htmlFor:h.id||t,...d,children:s}):null,(0,n.jsxs)(a.jqI,{align:"center",children:[(0,n.jsxs)(a.jqI,{vertical:!0,flex:1,className:"mr-2",children:[(0,n.jsx)(a.WPr,{...g,id:h.id||t,"data-testid":"controlled-select-".concat(g.name),...h,optionRender:j,onSearch:"tags"===h.mode?b:void 0,onChange:C,value:g.value||void 0}),(0,n.jsx)(o.Bc,{isInvalid:p,message:x.error,fieldName:g.name})]}),c?(0,n.jsx)(r.Z,{label:c}):null]})]})}):(0,n.jsx)(a.NIc,{isInvalid:p,isRequired:u,children:(0,n.jsxs)(a.gCW,{alignItems:"start",children:[(0,n.jsxs)(a.jqI,{align:"center",children:[s?(0,n.jsx)(o.__,{htmlFor:h.id||t,fontSize:"xs",my:0,mr:1,...d,children:s}):null,c?(0,n.jsx)(r.Z,{label:c}):null]}),(0,n.jsx)(a.WPr,{...g,id:h.id||t,"data-testid":"controlled-select-".concat(g.name),...h,optionRender:j,onSearch:"tags"===h.mode?b:void 0,onChange:C,value:g.value||void 0}),(0,n.jsx)(o.Bc,{isInvalid:p,message:x.error,fieldName:g.name})]})})}},73269:function(e,t,s){"use strict";s.d(t,{Gt:function(){return m},eB:function(){return h},oI:function(){return u}});var n=s(24246),a=s(34090),i=s(27378),l=s(44296),r=s(3073),o=s(77650);let d=(0,i.createRef)(),c=(0,i.createRef)(),u=()=>{let e=(0,l.T)(),t=(0,l.C)(r.DB),s=(0,i.useCallback)(()=>{c.current=void 0,d.current=void 0},[]),n=(0,i.useCallback)(()=>{e((0,r.Mr)()),c.current&&(c.current(!0),s())},[e,s]),a=(0,i.useCallback)(()=>{e((0,r.Mr)()),c.current&&(c.current(!1),s())},[e,s]);return{attemptAction:(0,i.useCallback)(()=>t?(e((0,r.h7)()),d.current||(d.current=new Promise(e=>{c.current=e})),d.current):Promise.resolve(!0),[t,e]),onConfirm:n,onClose:a}},m=e=>{let{id:t,name:s}=e,{dirty:n}=(0,a.u6)(),o=(0,l.T)();return(0,i.useEffect)(()=>(o((0,r.Zu)({id:t,name:s})),()=>{o((0,r.dz)({id:t}))}),[o,t,s]),(0,i.useEffect)(()=>{o((0,r.$p)({id:t,isDirty:n}))},[n,o,t]),null},h=()=>{let{onConfirm:e,onClose:t}=u(),s=(0,l.C)(r.uv);return(0,n.jsx)(o.Z,{isOpen:s,onClose:t,onConfirm:e,isCentered:!0,title:"Unsaved Changes",message:"You have unsaved changes"})}},98198:function(e,t,s){"use strict";var n=s(24246),a=s(41748);t.Z=e=>{let{title:t,children:s,isOpen:i,onClose:l,...r}=e;return(0,n.jsxs)(a.u_l,{isOpen:i,onClose:l,isCentered:!0,scrollBehavior:"inside",size:"xl",id:"add-modal",...r,children:[(0,n.jsx)(a.ZAr,{}),(0,n.jsxs)(a.hzk,{textAlign:"left",p:0,"data-testid":"add-modal-content",children:[(0,n.jsx)(a.xBx,{p:0,children:(0,n.jsx)(a.xuv,{backgroundColor:"gray.50",px:6,py:4,border:"1px",borderColor:"gray.200",borderTopRadius:6,display:"flex",justifyContent:"space-between",alignItems:"center",children:(0,n.jsx)(a.X6q,{as:"h3",size:"sm",children:t})})}),(0,n.jsx)(a.fef,{pb:4,overflow:"auto",children:s})]})]})}},55827:function(e,t,s){"use strict";s.d(t,{E:function(){return n}});let n=e=>e.toLowerCase().replace(/ /g,"_").replace(/[^a-zA-Z0-9._<>-]/g,"")},56048:function(e,t,s){"use strict";s.d(t,{Z:function(){return v}});var n=s(24246),a=s(41748),i=s(34090),l=s(27378),r=s(44296),o=s(34803);let d=(0,a.IUT)({displayName:"CompassIcon",viewBox:"0 0 512 512",path:(0,n.jsx)("path",{fill:"currentColor",d:"M464 256A208 208 0 1 0 48 256a208 208 0 1 0 416 0zM0 256a256 256 0 1 1 512 0A256 256 0 1 1 0 256zm306.7 69.1L162.4 380.6c-19.4 7.5-38.5-11.6-31-31l55.5-144.3c3.3-8.5 9.9-15.1 18.4-18.4l144.3-55.5c19.4-7.5 38.5 11.6 31 31L325.1 306.7c-3.2 8.5-9.9 15.1-18.4 18.4zM288 256a32 32 0 1 0 -64 0 32 32 0 1 0 64 0z"})});var c=s(39514),u=s(62711);let{Text:m}=a.AntTypography,h=e=>{let{searchText:t,suggestion:s,...a}=e;return t&&s?(0,n.jsxs)(m,{"aria-hidden":!0,style:{pointerEvents:"none",position:"absolute",zIndex:10,top:"var(--ant-line-width)",bottom:"var(--ant-line-width)",left:"var(--ant-padding-sm)",lineHeight:"calc(var(--ant-control-height) - var(--ant-line-width))"},...a,children:[(0,n.jsx)(m,{className:"text-transparent",children:t}),(0,n.jsx)(m,{type:"secondary",children:s.substring(t.length)})]}):null},g="Create new system",x=e=>{let{active:t,disabled:s,onRefreshSuggestions:i}=e,l={bg:t?"complimentary.500":"gray.100"};return(0,n.jsxs)(a.gCW,{children:[(0,n.jsx)(a.LZC,{minHeight:"18px"}),(0,n.jsxs)(a.v2r,{children:[(0,n.jsx)(a.j2t,{as:a.hU,size:"sm",isDisabled:s,icon:(0,n.jsx)(d,{color:t?"white":"gray.700",boxSize:4}),"aria-label":"Update information from Compass","data-testid":"refresh-suggestions-btn",_hover:{_disabled:l},...l}),(0,n.jsx)(a.qyq,{children:(0,n.jsx)(a.sNh,{onClick:i,children:(0,n.jsx)(a.xvT,{fontSize:"xs",lineHeight:4,children:"Reset to Compass defaults"})})})]})]})};var v=e=>{var t,s;let{label:d,isCreate:m,lockedForGVL:v,options:p,isLoading:f,onVendorSelected:y}=e,j=(0,r.C)(u.bN),[b,C,{setValue:w}]=(0,i.U$)("name"),S=!!(C.touched&&C.error),_={...b,value:null!==(t=b.value)&&void 0!==t?t:""},{touched:I,values:k,setTouched:N,setFieldValue:R,validateForm:z}=(0,i.u6)(),[A,T]=(0,l.useState)(!0),P=null!==(s=p.find(e=>e.value===_.value))&&void 0!==s?s:{label:_.value,value:_.value,description:""},Z=(e,t)=>!!(null==t?void 0:t.label.toLowerCase().startsWith(e.toLowerCase())),[E,q]=(0,l.useState)(""),D=(0,l.useMemo)(()=>p.filter(e=>Z(E,e)),[p,E]),L=(0,l.useMemo)(()=>{let e=p;return m&&E&&(e=[...p,{label:"".concat(g,' "').concat(E,'"...'),value:E}]),e},[m,p,E]),U=!!E&&D.length>0,W=v&&!m;(0,l.useEffect)(()=>{T(!_.value&&!k.vendor_id)},[_.value,k.vendor_id,T]),(0,l.useEffect)(()=>{z()},[A,z]);let B=async()=>{q(""),R("vendor_id",void 0),await w(""),N({...I,vendor_id:!1,name:!1}),y(void 0)},F=async e=>{if(e){let t=p.some(t=>t.value===e.value)?e.value:void 0;R("vendor_id",t),await w(e.label.startsWith(g)?e.value:e.label),N({...I,vendor_id:!0,name:!0}),y(t)}},M=async e=>{_.onBlur(e),E&&await w(E),N({...I,name:!0})},$=async e=>{D.length>0&&E!==D[0].label?(e.preventDefault(),q(D[0].label),R("vendor_id",D[0].value),await w(D[0].label),y(D[0].value)):(R("vendor_id",void 0),await w(E)),N({...I,name:!0})},V=(0,n.jsx)(a.NIc,{isInvalid:S,isRequired:!0,width:"100%",children:(0,n.jsxs)(a.gCW,{alignItems:"start",position:"relative",width:"100%",children:[(0,n.jsxs)(a.Ugi,{spacing:1,children:[(0,n.jsx)(o.__,{htmlFor:"vendorName",fontSize:"xs",my:0,mr:1,children:d}),(0,n.jsx)(c.Z,{label:"Enter the system name"})]}),(0,n.jsxs)(a.xuv,{width:"100%",className:"relative",children:[(0,n.jsx)(a.WPr,{id:"vendorName",labelInValue:!0,autoFocus:!0,allowClear:!0,options:L,loading:f,filterOption:(e,t)=>Z(e,t)||!!(null==t?void 0:t.label.startsWith(g)),optionFilterProp:"label",value:P,placeholder:"Enter system name...",disabled:W,onChange:F,onSearch:q,onClear:B,onBlur:M,onInputKeyDown:e=>{E&&"Tab"===e.key&&$(e)},status:S?"error":void 0,"data-testid":"vendor-name-select"}),(0,n.jsx)(h,{searchText:E,suggestion:D.length?D[0].label:""})]}),(0,n.jsx)(o.Bc,{isInvalid:S,message:C.error,fieldName:"name"})]})});return(0,n.jsxs)(a.Ugi,{alignItems:"flex-start",width:"full",children:[A?V:(0,n.jsx)(o.j0,{autoFocus:!0,id:"name",name:"name",label:"System name",tooltip:"Enter the system name",variant:"stacked",disabled:W,isRequired:!0,inputRightElement:W?null:(0,n.jsx)(a.PZ7,{onClick:B,size:"sm","data-testid":"clear-btn"})}),(0,n.jsx)(x,{active:!!k.vendor_id||U,disabled:!k.vendor_id||"showing"===j,onRefreshSuggestions:()=>y(k.vendor_id)})]})}},43894:function(e,t,s){"use strict";s.d(t,{Sv:function(){return g},Yb:function(){return h},dQ:function(){return x},lm:function(){return v}});var n=s(24246),a=s(41748),i=s(34090),l=s(27378),r=s(44296),o=s(34803),d=s(39514),c=s(96878),u=s(62711);let m=(e,t,s)=>{var n,a;let[o,d,{setValue:m,setTouched:h}]=(0,i.U$)({name:e,type:s||void 0}),g=!!(d.touched&&d.error),{error:x}=d,v={...o,value:null!==(n=o.value)&&void 0!==n?n:""},[p,f]=(0,l.useState)(null!==(a=v.value)&&void 0!==a?a:""),{values:y}=(0,i.u6)(),{vendor_id:j}=y,b=(0,r.C)((0,c.$e)(j||"")),C=(0,r.C)(u.bN),w=(0,l.useRef)();return(0,l.useEffect)(()=>{"showing"===C&&f(v.value)},[C,f]),(0,l.useEffect)(()=>{if("showing"===C&&b){let s=t?t(b):b[e];v.value!==s&&(m(s),setTimeout(()=>{var e;h(!0),null===(e=w.current)||void 0===e||e.blur()},300))}},[C,m,b,w.current]),(0,l.useEffect)(()=>{"hiding"===C&&m(p)},[C,m,p]),{field:v,isInvalid:g,isShowingSuggestions:C,error:x,inputRef:w}},h=e=>{let{label:t,tooltip:s,disabled:i,isRequired:l=!1,dictField:r,name:c,placeholder:u,id:h}=e,{field:g,isInvalid:x,isShowingSuggestions:v,error:p,inputRef:f}=m(c,r);return(0,n.jsx)(a.NIc,{isInvalid:x,isRequired:l,children:(0,n.jsxs)(a.gCW,{alignItems:"start",children:[(0,n.jsxs)(a.kCb,{alignItems:"center",children:[(0,n.jsx)(o.__,{htmlFor:h||c,fontSize:"xs",my:0,mr:1,children:t}),s?(0,n.jsx)(d.Z,{label:s}):null]}),(0,n.jsx)(o.oi,{...g,ref:f,isRequired:l,isDisabled:i,"data-testid":"input-".concat(g.name),placeholder:u,isPassword:!1,color:"showing"===v?"complimentary.500":"gray.800"}),(0,n.jsx)(o.Bc,{isInvalid:x,message:p,fieldName:g.name})]})})},g=e=>{let{label:t,tooltip:s,disabled:i,isRequired:l=!1,dictField:r,name:c,id:u}=e,{field:h,isInvalid:g,isShowingSuggestions:x,error:v}=m(c,r);return(0,n.jsx)(a.NIc,{isInvalid:g,isRequired:l,children:(0,n.jsxs)(a.gCW,{alignItems:"start",children:[(0,n.jsxs)(a.kCb,{alignItems:"center",children:[(0,n.jsx)(o.__,{htmlFor:u||c,fontSize:"xs",my:0,mr:1,children:t}),s?(0,n.jsx)(d.Z,{label:s}):null]}),(0,n.jsx)(a.gxH,{...h,size:"sm","data-testid":"input-".concat(h.name),focusBorderColor:"primary.600",color:"showing"===x?"complimentary.500":"gray.800",isDisabled:i}),(0,n.jsx)(o.Bc,{isInvalid:g,message:v,fieldName:h.name})]})})},x=e=>{let{label:t,tooltip:s,dictField:l,name:r,id:c,disabled:u}=e,{field:h,isInvalid:g,error:x}=m(r,l,"checkbox");return(0,n.jsxs)(a.NIc,{isInvalid:g,width:"full",children:[(0,n.jsxs)(a.xuv,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[(0,n.jsxs)(a.Ugi,{spacing:1,children:[(0,n.jsx)(o.__,{htmlFor:c||r,fontSize:"xs",my:0,mr:0,children:t}),s?(0,n.jsx)(d.Z,{label:s}):null]}),(0,n.jsx)(a.Ugi,{children:(0,n.jsx)(i.gN,{name:h.name,children:e=>{let{form:{setFieldValue:t}}=e;return(0,n.jsx)(a.rAg,{checked:h.checked,onChange:e=>{t(h.name,e)},disabled:u,className:"mr-2","data-testid":"input-".concat(h.name),size:"small"})}})})]}),(0,n.jsx)(o.Bc,{isInvalid:g,message:x,fieldName:h.name})]})},v=e=>{let{label:t,tooltip:s,dictField:l,name:r,id:c,disabled:u}=e,{field:h,isInvalid:g,error:x,isShowingSuggestions:v}=m(r,l,"numeric"),{setFieldValue:p}=(0,i.u6)();return(0,n.jsxs)(a.NIc,{isInvalid:g,width:"full",children:[(0,n.jsxs)(a.xuv,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[(0,n.jsxs)(a.Ugi,{spacing:1,children:[(0,n.jsx)(o.__,{htmlFor:c||r,fontSize:"xs",my:0,mr:0,children:t}),s?(0,n.jsx)(d.Z,{label:s}):null]}),(0,n.jsx)(a.Ugi,{children:(0,n.jsxs)(a.Y2U,{value:h.value,name:h.name,size:"xs",onBlur:h.onBlur,onChange:e=>{p(h.name,e)},w:"100%",colorScheme:"terracotta",inputMode:"numeric","data-testid":"input-".concat(h.name),color:"showing"===v?"complimentary.500":"gray.800",focusBorderColor:"primary.600",isDisabled:u,children:[(0,n.jsx)(a.zuI,{}),(0,n.jsxs)(a.FiK,{children:[(0,n.jsx)(a.WQu,{}),(0,n.jsx)(a.Y_d,{})]})]})})]}),(0,n.jsx)(o.Bc,{isInvalid:g,message:x,fieldName:h.name})]})}},5441:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return er}});var n=s(24246),a=s(86677),i=s(27378),l=s(65464),r=s(87162),o=s(37541),d=s(59003),c=s(92222),u=s(41748),m=s(83766),h=s.n(m),g=s(60136),x=s(53359),v=s(8540),p=s(83543),f=s(98198),y=s(74588),j=s(19310),b=s(89721),C=e=>{let{selectedTaxonomies:t,...s}=e,{getDataUseDisplayNameProps:a,getDataUses:i}=(0,j.Z)(),l=i().filter(e=>e.active&&b.g.includes(e.fides_key)).filter(e=>!t.includes(e.fides_key)).map(e=>{let{name:t,primaryName:s}=a(e.fides_key);return{value:e.fides_key,name:t,primaryName:s,description:e.description||""}});return(0,n.jsx)(y.l,{options:l,...s})};let{Text:w}=u.AntTypography;var S=e=>{let{onSave:t,isSaving:s,onClose:a,...l}=e,[r,o]=(0,i.useState)([]),d=()=>{o([]),a()};return(0,n.jsxs)(f.Z,{title:"Add consent category",...l,onClose:d,children:[(0,n.jsxs)(u.jqI,{vertical:!0,gap:20,className:"pb-6 pt-4",children:[(0,n.jsx)(w,{children:"Assign consent categories to selected assets. This configures the system for consent management. Consent categories apply to both individual assets and the system."}),(0,n.jsx)(C,{mode:"tags",selectedTaxonomies:r,onSelect:(e,t)=>o([...r,t.value]),variant:"outlined"})]}),(0,n.jsxs)(u.jqI,{justify:"space-between",children:[(0,n.jsx)(u.wpx,{htmlType:"reset",onClick:d,"data-testid":"cancel-btn",children:"Cancel"}),(0,n.jsx)(u.wpx,{htmlType:"submit",type:"primary",disabled:!r.length,loading:s,onClick:()=>t(r),"data-testid":"save-btn",children:"Save"})]})]})},_=s(22770),I=s(31374);let k=e=>{let{children:t,className:s,style:a,...i}=e;return(0,n.jsx)(u.wpx,{...i,type:"text",className:"w-full justify-start ".concat(s),style:{fontWeight:600,padding:"var(--ant-select-option-padding)",backgroundColor:"var(--ant-select-option-selected-bg)",...a},children:t})};var N=s(21820);let R=(e,t)=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(k,{onClick:t,"data-testid":"add-new-system",id:"add-new-system",children:"Add new system +"}),e]}),z=e=>{var t;let{onAddSystem:s,...a}=e,[l,r]=(0,i.useState)(),{data:o,isFetching:d}=(0,I.xF)({page:1,size:25,search:l||void 0}),c=null==o?void 0:null===(t=o.items)||void 0===t?void 0:t.map(e=>({value:e.fides_key,label:e.name})),m=(0,i.useCallback)(e=>{(null==e?void 0:e.length)>1&&r(e),(null==e?void 0:e.length)===0&&r(void 0)},[r]),h=(0,i.useMemo)(()=>(0,N.Ds)(m,300),[m]);return(0,n.jsx)(u.WPr,{placeholder:"Search...","aria-label":"Search for a system to select",dropdownStyle:{minWidth:"500px"},dropdownRender:s?e=>R(e,s):void 0,"data-testid":"system-select",...a,filterOption:!1,options:c,onSearch:h,loading:a.loading||d})};var A=s(34090),T=s(59389),P=s(44296),Z=s(11596),E=s(78973),q=s(34803),D=s(73269),L=s(55827),U=s(96878),W=s(62711),B=s(43894),F=s(56048);let{Text:M}=u.AntTypography,$={name:"",vendor_id:void 0,description:"",tags:[]},V=e=>{let{onSuccessfulSubmit:t,toastOnSuccess:s,...a}=e,[l,r]=(0,i.useState)(!1),o=(0,P.T)(),{tcf:d,dictionaryService:c}=(0,Z.hz)(),{isLoading:m}=(0,U.Rd)(void 0,{skip:!c}),h=(0,P.C)(U.o),v=(0,P.C)(W.gU),[p]=(0,I.in)(),[y]=(0,U.Qk)(),[j]=(0,I.f7)(),{successAlert:b,errorAlert:C}=(0,x.V)(),{setSuggestions:w,setLockedForGVL:S}=W.dictSuggestionsSlice.actions,_=(0,i.useRef)(null),k=(0,i.useMemo)(()=>T.Ry().shape({name:T.Z_().required().label("System name").test("is-unique","",async(e,t)=>{let{data:s}=await p({page:1,size:10,search:e});return!((null==s?void 0:s.items)||[]).filter(t=>t.name===e).some(t=>t.name===e)||t.createError({message:'You already have a system called "'.concat(e,'". Please specify a unique name for this system.')})})}),[p]),N=e=>{if(c){if(!e){o(w("hiding")),o(S(!1));return}o(w("showing")),d&&(0,g.cj)(e)===g.c6.GVL?o(S(!0)):o(S(!1))}},R=()=>{a.onClose(),o(w("initial")),o(S(!1))},z=async e=>{if(r(!0),e.vendor_id){let n=await y([e.vendor_id]);if((0,g.D4)(n))C((0,g.e$)(n.error));else{let{data:e}=n,a=e.systems[0];null==t||t(a.fides_key,a.name),s&&b("".concat(e.name," has been added to your system inventory."))}}else{let n={...e,fides_key:(0,L.E)(e.name),system_type:"",body:"",privacy_declarations:[]},a=await j(n);if((0,g.D4)(a))C((0,g.e$)(a.error));else{let{fides_key:n,name:i}=a.data;null==t||t(n,i),s&&b("".concat(e.name," has been added to your system inventory."))}R()}r(!1)};return(0,n.jsx)(f.Z,{title:"Add New System",...a,onClose:R,children:(0,n.jsx)(A.J9,{initialValues:$,onSubmit:z,validationSchema:k,innerRef:_,children:e=>{let{dirty:t,isValid:s}=e;return(0,n.jsxs)(A.l0,{children:[(0,n.jsx)(D.Gt,{id:"new-system-modal",name:"Add New System"}),(0,n.jsxs)(u.jqI,{vertical:!0,gap:20,className:"pb-6 pt-4",children:[(0,n.jsx)(M,{children:"Fides will add this system to your inventory and configure it for consent using the categories of consent listed below. Optionally, you can check if this system is listed within the Fides compass library by selecting the compass icon below."}),c?(0,n.jsx)(F.Z,{label:"System name",options:h,onVendorSelected:N,isCreate:!0,lockedForGVL:v,isLoading:m}):(0,n.jsx)(q.j0,{id:"name",name:"name",label:"System name",tooltip:"Give the system a unique, and relevant name for reporting purposes. e.g. “Email Data Warehouse”",variant:"stacked",isRequired:!0}),(0,n.jsx)(B.Sv,{id:"description",name:"description",label:"Description",tooltip:"What services does this system perform?",disabled:v}),(0,n.jsx)(E.d,{mode:"tags",id:"tags",name:"tags",label:"System Tags",options:[],layout:"stacked",tooltip:"Are there any tags to associate with this system?",disabled:v})]}),(0,n.jsxs)(u.jqI,{justify:"space-between",children:[(0,n.jsx)(u.wpx,{htmlType:"reset",onClick:R,disabled:m||!t||!s,"data-testid":"cancel-btn",children:"Cancel"}),(0,n.jsx)(u.wpx,{htmlType:"submit",type:"primary",disabled:m||!t||!s,loading:l,"data-testid":"save-btn",children:"Save"})]})]})}})})},{Text:O}=u.AntTypography,G=e=>{let{onSave:t,isSaving:s,...a}=e,[l,r]=(0,i.useState)(),[o,d]=(0,i.useState)(!1),c=(0,i.useCallback)(e=>{e.preventDefault(),d(!0)},[]),m=()=>{d(!1)},h=()=>{r(void 0),a.onClose()};return(0,n.jsxs)(f.Z,{title:"Assign system",...a,onClose:h,children:[(0,n.jsxs)(u.jqI,{vertical:!0,gap:20,className:"pb-6 pt-4",children:[(0,n.jsx)(O,{children:"Assign a system to the selected assets. If no system exists, select 'Add new system' to create one."}),(0,n.jsx)(z,{placeholder:"Search or select...",onSelect:(e,t)=>{r(t)},onAddSystem:c,value:l})]})," ",(0,n.jsxs)(u.jqI,{justify:"space-between",children:[(0,n.jsx)(u.wpx,{htmlType:"reset",onClick:h,"data-testid":"cancel-btn",children:"Cancel"}),(0,n.jsx)(u.wpx,{htmlType:"submit",type:"primary",disabled:!l,loading:s,onClick:()=>{t(l)},"data-testid":"save-btn",children:"Save"})]}),o&&(0,n.jsx)(V,{isOpen:!0,onClose:m,onSuccessfulSubmit:(e,t)=>{m(),r({label:t,value:e})},toastOnSuccess:!0})]})};var Y=s(1051),H=s(74473),K=s(52104),J=s(43073);let Q=e=>{let{onClick:t}=e;return(0,n.jsx)(u.wpx,{onClick:t,icon:(0,n.jsx)(u.Two,{boxSize:2}),size:"small",type:"text",className:"max-h-4 max-w-4","aria-label":"Remove data use"})};var X=e=>{var t;let{asset:s}=e,[a,l]=(0,i.useState)(!1),[r]=(0,p.Ak)(),{successAlert:o,errorAlert:d}=(0,x.V)(),{getDataUseDisplayName:c}=(0,j.Z)(),m=async e=>{let t=s.data_uses||[],n=await r({monitorId:s.monitor_config_id,urnList:[s.urn],dataUses:[...t,e]});(0,J.D4)(n)?d((0,g.e$)(n.error)):o("Consent category added to ".concat(s.resource_type,' "').concat(s.name,'" .'),"Confirmed"),l(!1)},h=async e=>{let t=s.data_uses||[],n=await r({monitorId:s.monitor_config_id,urnList:[s.urn],dataUses:t.filter(t=>t!==e)});(0,J.D4)(n)?d((0,g.e$)(n.error)):o("Consent category removed from ".concat(s.resource_type,' "').concat(s.name,'".'),"Confirmed")},v=null===(t=s.data_uses)||void 0===t?void 0:t.filter(e=>(0,b.Z)(e));return(0,n.jsxs)(H.Z,{children:[!a&&(0,n.jsxs)(n.Fragment,{children:[null==v?void 0:v.map(e=>(0,n.jsx)(K.Z,{"data-testid":"data-use-".concat(e),closeButton:(0,n.jsx)(Q,{onClick:()=>h(e)}),children:c(e)},e)),(0,n.jsx)(Y.Z,{onClick:()=>l(!0),"aria-label":"Add data use"})]}),a&&(0,n.jsx)(u.xuv,{className:"select-wrapper",position:"absolute",zIndex:10,top:"0",left:"0",width:"100%",height:"max",bgColor:"#fff",children:(0,n.jsx)(C,{selectedTaxonomies:v||[],onSelect:m,onBlur:()=>l(!1),open:!0})})]})};let ee=e=>{let{asset:t}=e,[s,{isLoading:a}]=(0,p.EY)(),[i,{isLoading:l}]=(0,p.nS)(),{successAlert:r,errorAlert:o}=(0,x.V)(),d=a||l,{urn:c,name:m,resource_type:h}=t,v=async()=>{let e=await s({urnList:[c]});(0,g.D4)(e)?o((0,g.e$)(e.error)):r("".concat(h,' "').concat(m,'" has been added to the system inventory.'),"Confirmed")},f=async()=>{let e=await i({urnList:[c]});(0,g.D4)(e)?o((0,g.e$)(e.error)):r("".concat(h,' "').concat(m,'" has been ignored and will not appear in future scans.'),"Ignored")};return(0,n.jsxs)(u.vyj,{children:[(0,n.jsx)(u.esZ,{title:t.system?void 0:"This asset requires a system before you can add it to the inventory.",children:(0,n.jsx)(u.wpx,{"data-testid":"add-btn",size:"small",onClick:v,disabled:!t.system||d,loading:a,children:"Add"})}),(0,n.jsx)(u.wpx,{"data-testid":"ignore-btn",size:"small",onClick:f,disabled:d,loading:l,children:"Ignore"})]})};var et=s(71533),es=e=>{let{children:t,onClick:s,...a}=e;return(0,n.jsx)(u.Cts,{variant:"taxonomy",textTransform:"none",fontWeight:"normal",display:"flex",alignItems:"center",gap:1.5,as:s?"button":void 0,onClick:s,_hover:s?{borderColor:"primary.900"}:void 0,...a,children:t})},en=s(6111);let ea=e=>{let{aggregateSystem:t,monitorConfigId:s}=e,{resource_type:a,name:l,urn:r,system:o}=t,[d,c]=(0,i.useState)(!1),[m,h]=(0,i.useState)(!1),[v,{isLoading:p}]=(0,en.NA)(),{successAlert:f,errorAlert:y}=(0,x.V)(),j=(0,i.useCallback)(e=>{e.preventDefault(),h(!0)},[]),b=async(e,t,n)=>{let i=await v({staged_resource_urn:r,monitor_config_id:s,system_key:e});(0,g.D4)(i)?y((0,g.e$)(i.error)):f(n?"".concat(t," has been added to your system inventory and the ").concat(a,' "').concat(l,'" has been assigned to that system.'):"".concat(a,' "').concat(l,'" has been assigned to ').concat(t,"."),"Confirmed"),c(!1)};return(0,n.jsxs)(n.Fragment,{children:[!d&&(0,n.jsx)("div",{style:(0,et.J9)(),children:o?(0,n.jsx)(es,{onClick:()=>c(!0),"data-testid":"system-badge",children:(0,n.jsxs)(n.Fragment,{children:[o,(0,n.jsx)(u.dY8,{})]})}):(0,n.jsx)(u.wpx,{size:"small",type:"text","aria-label":"add",icon:(0,n.jsx)(u.PJP.mm_,{}),onClick:()=>c(!0),"data-testid":"add-system-btn"})}),!!d&&(0,n.jsx)(z,{variant:"borderless",className:"w-full",autoFocus:!0,defaultOpen:!0,onBlur:e=>{var t;(null===(t=e.relatedTarget)||void 0===t?void 0:t.getAttribute("id"))!=="add-new-system"&&c(!1)},onAddSystem:j,onSelect:(e,t)=>b(e,t.label),loading:p}),m&&(0,n.jsx)(V,{isOpen:!0,onClose:()=>{h(!1)},onSuccessfulSubmit:(e,t)=>b(e,t,!0)})]})},ei=()=>{let e=(0,c.Cl)();return{columns:[e.display({id:"select",cell:e=>{let{row:t}=e;return(0,n.jsx)(v.k,{isChecked:t.getIsSelected(),onChange:t.getToggleSelectedHandler(),dataTestId:"select-".concat(t.original.name||t.id)})},header:e=>{let{table:t}=e;return(0,n.jsx)(v.k,{isChecked:t.getIsAllPageRowsSelected(),isIndeterminate:t.getIsSomeRowsSelected(),onChange:t.getToggleAllRowsSelectedHandler(),dataTestId:"select-all-rows"})},maxSize:40}),e.accessor(e=>e.name,{id:"name",cell:e=>(0,n.jsx)(v.G3,{value:e.getValue()}),header:"Asset"}),e.accessor(e=>e.resource_type,{id:"resource_type",cell:e=>(0,n.jsx)(v.G3,{value:e.getValue()}),header:"Type"}),e.accessor(e=>e.system,{id:"system",cell:e=>!!e.row.original.monitor_config_id&&(0,n.jsx)(ea,{aggregateSystem:e.row.original,monitorConfigId:e.row.original.monitor_config_id}),header:"System",meta:{noPadding:!0,width:"auto"}}),e.display({id:"data_use",cell:e=>(0,n.jsx)(X,{asset:e.row.original}),header:"Categories of consent",meta:{width:"auto",disableRowClick:!0}}),e.accessor(e=>e.locations,{id:"locations",cell:e=>(0,n.jsx)(v.G3,{value:e.getValue().length>1?"".concat(e.getValue().length," locations"):e.getValue()[0]}),header:"Locations"}),e.accessor(e=>e.domain,{id:"domain",cell:e=>(0,n.jsx)(v.G3,{value:e.getValue()}),header:"Domain"}),e.display({id:"actions",cell:e=>(0,n.jsx)(ee,{asset:e.row.original}),header:"Actions",meta:{width:"auto",disableRowClick:!0}})]}},el=e=>{let{monitorId:t,systemId:s,onSystemName:l}=e,o=(0,a.useRouter)(),[m,f]=(0,i.useState)(s),[y,j]=(0,i.useState)({}),[b,C]=(0,i.useState)(!1),[w,I]=(0,i.useState)(!1),[k,{isLoading:N}]=(0,p.EY)(),[R,{isLoading:z}]=(0,p.nS)(),[A,{isLoading:T}]=(0,p.rs)(),[P,{isLoading:Z}]=(0,p.sX)(),[E,{isLoading:q}]=(0,p.Vr)(),D=N||z||T||Z,L=D||s===r.Kl,{PAGE_SIZES:U,pageSize:W,setPageSize:B,onPreviousPageClick:F,isPreviousPageDisabled:M,onNextPageClick:$,isNextPageDisabled:V,startRange:O,endRange:Y,pageIndex:H,setTotalPages:K,resetPageIndexToDefault:J}=(0,v.oi)(),[Q,X]=(0,i.useState)(""),{successAlert:ee,errorAlert:et}=(0,x.V)();(0,i.useEffect)(()=>{J()},[t,Q,J]);let{data:es,isLoading:en,isFetching:ea}=(0,p.WJ)({key:t,system:s,page:H,size:W,search:Q});(0,i.useEffect)(()=>{if(es){var e;let t=(null===(e=es.items[0])||void 0===e?void 0:e.system)||s||"";K(es.pages||1),f(t),null==l||l(t)}},[es,s,l,K]);let{columns:el}=ei(),er=(0,d.b7)({getCoreRowModel:(0,c.sC)(),columns:el,manualPagination:!0,data:(null==es?void 0:es.items)||[],columnResizeMode:"onChange",onRowSelectionChange:j,state:{rowSelection:y}}),eo=er.getSelectedRowModel().rows.map(e=>e.original.urn),ed=async()=>{let e=await k({urnList:eo});(0,g.D4)(e)?et((0,g.e$)(e.error)):(er.resetRowSelection(),ee("".concat(eo.length," assets from ").concat(m," have been added to the system inventory."),"Confirmed"))},ec=async e=>{if("string"==typeof(null==e?void 0:e.value)){let s=await P({monitorId:t,urnList:eo,systemKey:e.value});(0,g.D4)(s)?et((0,g.e$)(s.error)):(er.resetRowSelection(),ee("".concat(eo.length," assets have been assigned to ").concat(e.label,"."),"Confirmed"))}C(!1)},eu=async e=>{let s=null==es?void 0:es.items.filter(e=>eo.includes(e.urn));if(!s)return;let n=s.map(t=>{let s=h()([...t.data_uses||[],...e]);return{urn:t.urn,data_uses:s}}),a=await E({monitorId:t,assets:n});(0,g.D4)(a)?et((0,g.e$)(a.error)):(er.resetRowSelection(),ee("Consent categories added to ".concat(eo.length," assets from ").concat(m,"."),"Confirmed"))},em=async()=>{let e=await R({urnList:eo});(0,g.D4)(e)?et((0,g.e$)(e.error)):(er.resetRowSelection(),ee("".concat(eo.length," assets from ").concat(m," have been ignored and will not appear in future scans."),"Confirmed"))},eh=async()=>{let e=(null==es?void 0:es.items.length)||0,n=await A({monitor_config_key:t,resolved_system_ids:[s]});(0,g.D4)(n)?et((0,g.e$)(n.error)):(o.push("".concat(r.vi,"/").concat(t)),ee("".concat(e," assets from ").concat(m," have been added to the system inventory."),"Confirmed"))};return t&&s?en?(0,n.jsx)(v.I4,{rowHeight:36,numRows:36}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(v.Q$,{children:[(0,n.jsx)(_.M,{value:Q,onChange:X}),(0,n.jsxs)(u.kCb,{alignItems:"center",children:[!!eo.length&&(0,n.jsx)(u.xvT,{fontSize:"xs",fontWeight:"semibold",minW:16,mr:6,"data-testid":"selected-count",children:"".concat(eo.length," selected")}),(0,n.jsxs)(u.Ugi,{children:[(0,n.jsxs)(u.v2r,{children:[(0,n.jsx)(u.j2t,{as:u.wpx,icon:(0,n.jsx)(u.PJP._ME,{}),iconPosition:"end",loading:D,"data-testid":"bulk-actions-menu",disabled:!eo.length||D,type:"primary",children:"Actions"}),(0,n.jsxs)(u.qyq,{children:[(0,n.jsx)(u.sNh,{fontSize:"small",onClick:ed,"data-testid":"bulk-add",children:"Add"}),(0,n.jsx)(u.sNh,{fontSize:"small",onClick:()=>I(!0),"data-testid":"bulk-add-data-use",children:"Add consent category"}),(0,n.jsx)(u.sNh,{fontSize:"small",onClick:()=>{C(!0)},"data-testid":"bulk-assign-system",children:"Assign system"}),(0,n.jsx)(u.RaW,{}),(0,n.jsx)(u.sNh,{fontSize:"small",onClick:em,"data-testid":"bulk-ignore",children:"Ignore"})]})]}),(0,n.jsx)(u.esZ,{title:L?"These assets require a system before you can add them to the inventory.":void 0,children:(0,n.jsx)(u.wpx,{onClick:eh,disabled:L,loading:T,type:"primary",icon:(0,n.jsx)(u.PJP.MCw,{}),iconPosition:"end","data-testid":"add-all",children:"Add all"})})]})]})]}),(0,n.jsx)(v.ZK,{tableInstance:er,emptyTableNotice:(0,n.jsx)(u.oj8,{image:u.oj8.PRESENTED_IMAGE_SIMPLE,description:"All caught up!"})}),(0,n.jsx)(v.s8,{totalRows:(null==es?void 0:es.items.length)||0,pageSizes:U,setPageSize:B,onPreviousPageClick:F,isPreviousPageDisabled:M||ea,onNextPageClick:$,isNextPageDisabled:V||ea,startRange:O,endRange:Y}),(0,n.jsx)(G,{isOpen:b,onClose:()=>{C(!1)},onSave:ec,isSaving:Z}),(0,n.jsx)(S,{isOpen:w,onClose:()=>{I(!1)},onSave:eu,isSaving:q})]}):null};var er=()=>{let e=(0,a.useRouter)(),t=decodeURIComponent(e.query.monitorId),s=decodeURIComponent(e.query.systemId),[d,c]=(0,i.useState)(s===r.Kl?"Uncategorized assets":s);return(0,n.jsxs)(l.Z,{title:"Action center - Discovered assets",children:[(0,n.jsx)(o.Z,{heading:"Action center",breadcrumbItems:[{title:"All activity",href:r.vi},{title:t,href:"".concat(r.vi,"/").concat(t)},{title:s===r.Kl?"Uncategorized assets":d}]}),(0,n.jsx)(el,{monitorId:t,systemId:s,onSystemName:c})]})}}},function(e){e.O(0,[8033,5559,4554,2866,9278,8540,950,3089,2888,9774,179],function(){return e(e.s=25654)}),_N_E=e.O()}]);