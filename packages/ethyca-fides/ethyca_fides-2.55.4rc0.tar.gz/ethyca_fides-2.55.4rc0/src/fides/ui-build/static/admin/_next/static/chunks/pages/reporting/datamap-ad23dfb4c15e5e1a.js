(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9196],{86548:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/reporting/datamap",function(){return a(83253)}])},72809:function(e,t,a){"use strict";var s=a(24246),r=a(41748),i=a(27378);let o=e=>{let t=e.split("."),a=[];return t.forEach(e=>{let t=a.length>0?a[a.length-1]:null;t?a.push("".concat(t,".").concat(e)):a.push(e)}),a},l=(e,t)=>{let a=o(t).filter(e=>e!==t);return e.filter(e=>a.includes(e)).length>0},n=(e,t)=>!!(e===t||e.startsWith("".concat(t,"."))),c=(e,t,a)=>{let s=null!=a?a:[];return e.forEach(e=>{e.children&&c(e.children,t,s),n(e.value,t)&&s.push(e)}),s},d=e=>{let{node:t,isChecked:a,onChecked:i,isExpanded:o,onExpanded:l,isIndeterminate:n,isDisabled:c,children:d}=e,{value:u,label:_}=t,p=!!t.children&&t.children.length>0;return(0,s.jsxs)(r.xuv,{children:[(0,s.jsxs)(r.xuv,{display:"flex",justifyContent:"space-between",_hover:{backgroundColor:"gray.100",cursor:"pointer"},onClick:()=>l(t),minHeight:8,children:[(0,s.jsx)(r.XZJ,{colorScheme:"complimentary",value:u,isChecked:!n&&a,isIndeterminate:n,isDisabled:c,onChange:()=>i(t),mx:2,"data-testid":"checkbox-".concat(_),children:_}),p?(0,s.jsx)(r.wpx,{"data-testid":"expand-".concat(_),"aria-label":o?"collapse":"expand",icon:(0,s.jsx)(r.v4q,{boxSize:5}),type:"text",onClick:()=>l(t),className:o?"rotate-180":void 0}):null]}),d&&(0,s.jsx)(r.xuv,{ml:5,children:d})]})};t.ZP=e=>{let{nodes:t,selected:a,onSelected:u,..._}=e,[p,m]=(0,i.useState)([]),[S,g]=(0,i.useState)([]);(0,i.useEffect)(()=>{let e=Array.from(new Set([...a.map(e=>o(e)).reduce((e,t)=>e.concat(t),[]),...a.map(e=>c(t,e)).reduce((e,t)=>e.concat(t),[]).map(e=>e.value)]));g(e),m(e)},[a,t]);let E=e=>{let s=[],r=[];p.indexOf(e.value)>=0?(s=p.filter(t=>!n(t,e.value)),r=a.filter(t=>!n(t,e.value))):(s=[...p,...c(t,e.value).map(e=>e.value)],r=[...a,e.value]),m(s),u(r)},h=e=>{S.indexOf(e.value)>=0?g(S.filter(t=>!n(t,e.value))):g([...S,e.value])},x=e=>{if(e.children){let r=p.indexOf(e.value)>=0,o=S.indexOf(e.value)>=0,n=c(t,e.value),u=r&&e.children.length>0&&p.filter(t=>t.startsWith("".concat(e.value,"."))).length+1!==n.length,_=l(a,e.value);return(0,s.jsx)(d,{node:e,isChecked:r,onChecked:E,isExpanded:o,onExpanded:h,isDisabled:_,isIndeterminate:u,children:o?e.children.map(e=>(0,s.jsx)(i.Fragment,{children:x(e)},e.value)):void 0})}return null};return(0,s.jsx)(r.xuv,{..._,children:t.map(e=>(0,s.jsx)(r.xuv,{children:x(e)},e.value))})}},65464:function(e,t,a){"use strict";var s=a(24246),r=a(41748),i=a(88038),o=a.n(i);a(27378),t.Z=e=>{let{children:t,title:a,mainProps:i}=e;return(0,s.jsxs)(r.kCb,{"data-testid":a,direction:"column",height:"calc(100vh - 48px)",width:"calc(100vw - 240px)",children:[(0,s.jsxs)(o(),{children:[(0,s.jsxs)("title",{children:["Fides Admin UI - ",a]}),(0,s.jsx)("meta",{name:"description",content:"Privacy Engineering Platform"}),(0,s.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,s.jsx)(r.kCb,{px:10,py:6,as:"main",overflow:"auto",direction:"column",flex:1,minWidth:0,...i,children:t})]})}},79711:function(e,t,a){"use strict";a.d(t,{q:function(){return r}});var s=a(24246);let r=(0,a(41748).IUT)({displayName:"TrashCanOutlineIcon",viewBox:"0 0 11 12",path:(0,s.jsx)("path",{d:"M4.5166 1.60859L4.1084 2.21875H7.22363L6.81543 1.60859C6.7832 1.56133 6.72949 1.53125 6.67148 1.53125H4.6584C4.60039 1.53125 4.54668 1.55918 4.51445 1.60859H4.5166ZM7.6748 1.03711L8.46328 2.21875H8.75977H9.79102H9.96289C10.2486 2.21875 10.4785 2.44863 10.4785 2.73438C10.4785 3.02012 10.2486 3.25 9.96289 3.25H9.79102V9.78125C9.79102 10.7309 9.02188 11.5 8.07227 11.5H3.25977C2.31016 11.5 1.54102 10.7309 1.54102 9.78125V3.25H1.36914C1.0834 3.25 0.853516 3.02012 0.853516 2.73438C0.853516 2.44863 1.0834 2.21875 1.36914 2.21875H1.54102H2.57227H2.86875L3.65723 1.03496C3.88066 0.701953 4.25664 0.5 4.6584 0.5H6.67148C7.07324 0.5 7.44922 0.701953 7.67266 1.03496L7.6748 1.03711ZM2.57227 3.25V9.78125C2.57227 10.1615 2.87949 10.4688 3.25977 10.4688H8.07227C8.45254 10.4688 8.75977 10.1615 8.75977 9.78125V3.25H2.57227ZM4.29102 4.625V9.09375C4.29102 9.28281 4.13633 9.4375 3.94727 9.4375C3.7582 9.4375 3.60352 9.28281 3.60352 9.09375V4.625C3.60352 4.43594 3.7582 4.28125 3.94727 4.28125C4.13633 4.28125 4.29102 4.43594 4.29102 4.625ZM6.00977 4.625V9.09375C6.00977 9.28281 5.85508 9.4375 5.66602 9.4375C5.47695 9.4375 5.32227 9.28281 5.32227 9.09375V4.625C5.32227 4.43594 5.47695 4.28125 5.66602 4.28125C5.85508 4.28125 6.00977 4.43594 6.00977 4.625ZM7.72852 4.625V9.09375C7.72852 9.28281 7.57383 9.4375 7.38477 9.4375C7.1957 9.4375 7.04102 9.28281 7.04102 9.09375V4.625C7.04102 4.43594 7.1957 4.28125 7.38477 4.28125C7.57383 4.28125 7.72852 4.43594 7.72852 4.625Z",fill:"currentColor"})})},38615:function(e,t,a){"use strict";a.d(t,{Tg:function(){return o}});var s=a(24246),r=a(44296),i=a(96451);let o=e=>(0,r.C)(i.uu).filter(t=>e.includes(t)).length>0;t.ZP=e=>{let{scopes:t,children:a}=e;return o(t)?(0,s.jsx)(s.Fragment,{children:a}):null}},91591:function(e,t,a){"use strict";a.d(t,{d:function(){return r}});var s=a(24246);let r=(0,a(41748).IUT)({displayName:"AddIcon",viewBox:"0 0 10 10",path:(0,s.jsx)("path",{d:"M4.33331 4.33398V0.333984H5.66665V4.33398H9.66665V5.66732H5.66665V9.66732H4.33331V5.66732H0.333313V4.33398H4.33331Z",fill:"currentColor"})})},19310:function(e,t,a){"use strict";var s=a(24246),r=a(64925),i=a.n(r),o=a(27378),l=a(44296),n=a(91650),c=a(79851),d=a(47411);let u=()=>{let{isLoading:e}=(0,c.fd)(),t=(0,l.C)(c.U3),{isLoading:a}=(0,d.MO)(),s=(0,l.C)(d.qb),{isLoading:r}=(0,n.te)();return{dataUses:t,dataSubjects:(0,l.C)(n.ZL),dataCategories:s,isLoading:e||a||r}};t.Z=()=>{let{dataUses:e,dataCategories:t,dataSubjects:a,isLoading:r}=u(),l=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return e.split(".").slice(0,t).join(".")},n=function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,s=t(e);if(!s)return{};let r=t(l(e,a)),i=!!s.parent_key;return{name:s.name||void 0,primaryName:i&&(null==r?void 0:r.name)!==s.name&&(null==r?void 0:r.name)||void 0}},c=function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,{name:r,primaryName:i}=n(e,t,a);return r?i?(0,s.jsxs)(o.Fragment,{children:[(0,s.jsxs)("strong",{children:[i,":"]})," ",r]},e):(0,s.jsx)("strong",{children:r},e):e},d=t=>i()(e,{fides_key:t}),_=e=>i()(t,{fides_key:e}),p=e=>i()(a,{fides_key:e});return{getDataUses:()=>e,getDataUseByKey:d,getDataUseDisplayName:e=>c(e,d,1),getDataUseDisplayNameProps:e=>n(e,d,1),getDataCategories:()=>t,getDataCategoryByKey:_,getDataCategoryDisplayName:e=>c(e,_,2),getDataCategoryDisplayNameProps:e=>n(e,_,2),getDataSubjects:()=>a,getDataSubjectByKey:p,getDataSubjectDisplayName:e=>{let t=p(e);return t?t.name:e},getPrimaryKey:l,isLoading:r}}},91311:function(e,t,a){"use strict";var s,r;a.d(t,{C:function(){return i},L:function(){return s}});let i="root";(r=s||(s={})).DATA_CATEGORIES="Data categories",r.DATA_USES="Data uses",r.DATA_SUBJECTS="Data subjects"},62091:function(e,t,a){"use strict";a.d(t,{Cd:function(){return i},Xl:function(){return o}});var s=a(46042),r=a(91311);let i=(e,t)=>{let a;if(null==t&&e.every(e=>void 0===e.parent_key))a=e;else{let s=null!=t?t:null;a=e.filter(e=>e.parent_key===s)}return a.map(t=>{var a,s;let r=t.fides_key;return{value:t.fides_key,label:""===t.name||null==t.name?t.fides_key:t.name,description:t.description,children:i(e,r),is_default:null!==(a=t.is_default)&&void 0!==a&&a,active:null!==(s=t.active)&&void 0!==s&&s}})},o=e=>{switch(e){case r.L.DATA_CATEGORIES:return s.P6.DATA_CATEGORY;case r.L.DATA_SUBJECTS:return s.P6.DATA_SUBJECT;case r.L.DATA_USES:return s.P6.DATA_USE;default:return}}},83253:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return eA}});var s,r,i,o,l=a(24246),n=a(27378),c=a(65464),d=a(37541),u=a(56721),_=a(46042);(s=i||(i={})).COLUMN_EXPANSION_STATE="datamap-column-expansion-state",s.COLUMN_NAMES="datamap-column-names",s.COLUMN_ORDER="datamap-column-order",s.COLUMN_SIZING="datamap-column-sizing",s.COLUMN_VISIBILITY="datamap-column-visibility",s.CUSTOM_REPORT_ID="datamap-custom-report-id",s.FILTERS="datamap-filters",s.GROUP_BY="datamap-group-by",s.SORTING_STATE="datamap-sorting-state",s.WRAPPING_COLUMNS="datamap-wrapping-columns",(r=o||(o={})).SYSTEM_NAME="system_name",r.DATA_USE="data_uses",r.DATA_CATEGORY="data_categories",r.DATA_SUBJECT="data_subjects",r.LEGAL_NAME="legal_name",r.DPO="dpo",r.LEGAL_BASIS_FOR_PROCESSING="legal_basis_for_processing",r.ADMINISTRATING_DEPARTMENT="administrating_department",r.COOKIE_MAX_AGE_SECONDS="cookie_max_age_seconds",r.PRIVACY_POLICY="privacy_policy",r.LEGAL_ADDRESS="legal_address",r.COOKIE_REFRESH="cookie_refresh",r.DATA_SECURITY_PRACTICES="data_security_practices",r.DATA_SHARED_WITH_THIRD_PARTIES="data_shared_with_third_parties",r.DATA_STEWARDS="data_stewards",r.DECLARATION_NAME="declaration_name",r.DOES_INTERNATIONAL_TRANSFERS="does_international_transfers",r.DPA_LOCATION="dpa_location",r.DESTINATIONS="egress",r.EXEMPT_FROM_PRIVACY_REGULATIONS="exempt_from_privacy_regulations",r.FEATURES="features",r.FIDES_KEY="fides_key",r.FLEXIBLE_LEGAL_BASIS_FOR_PROCESSING="flexible_legal_basis_for_processing",r.IMPACT_ASSESSMENT_LOCATION="impact_assessment_location",r.SOURCES="ingress",r.JOINT_CONTROLLER_INFO="joint_controller_info",r.LEGAL_BASIS_FOR_PROFILING="legal_basis_for_profiling",r.LEGAL_BASIS_FOR_TRANSFERS="legal_basis_for_transfers",r.LEGITIMATE_INTEREST_DISCLOSURE_URL="legitimate_interest_disclosure_url",r.PROCESSES_PERSONAL_DATA="processes_personal_data",r.REASON_FOR_EXEMPTION="reason_for_exemption",r.REQUIRES_DATA_PROTECTION_ASSESSMENTS="requires_data_protection_assessments",r.RESPONSIBILITY="responsibility",r.RETENTION_PERIOD="retention_period",r.SHARED_CATEGORIES="shared_categories",r.SPECIAL_CATEGORY_LEGAL_BASIS="special_category_legal_basis",r.THIRD_PARTIES="third_parties",r.COOKIES="cookies",r.USES_COOKIES="uses_cookies",r.USES_NON_COOKIE_ACCESS="uses_non_cookie_access",r.USES_PROFILING="uses_profiling",r.SYSTEM_UNDECLARED_DATA_CATEGORIES="system_undeclared_data_categories",r.DATA_USE_UNDECLARED_DATA_CATEGORIES="data_use_undeclared_data_categories",r.PROCESSES_SPECIAL_CATEGORY_DATA="processes_special_category_data";let p={system_name:"System",data_uses:"Data use",data_categories:"Data categories",data_subjects:"Data subject",legal_name:"Legal name",dpo:"Data privacy officer",legal_basis_for_processing:"Legal basis for processing",administrating_department:"Administrating department",cookie_max_age_seconds:"Cookie max age seconds",privacy_policy:"Privacy policy",legal_address:"Legal address",cookie_refresh:"Cookie refresh",data_security_practices:"Data security practices",data_shared_with_third_parties:"Data shared with third parties",data_stewards:"Data stewards",declaration_name:"Declaration name",does_international_transfers:"Does international transfers",dpa_location:"DPA location",egress:"Destination",exempt_from_privacy_regulations:"Exempt from privacy regulations",features:"Features",fides_key:"Fides key",flexible_legal_basis_for_processing:"Flexible legal basis for processing",impact_assessment_location:"Impact assessment location",ingress:"Source",joint_controller_info:"Joint controller info",legal_basis_for_profiling:"Legal basis for profiling",legal_basis_for_transfers:"Legal basis for transfers",legitimate_interest_disclosure_url:"Legitimate interest disclosure URL",processes_personal_data:"Processes personal data",reason_for_exemption:"Reason for exemption",requires_data_protection_assessments:"Requires data protection assessments",responsibility:"Responsibility",retention_period:"Retention period",shared_categories:"Shared categories",special_category_legal_basis:"Special category legal basis",third_parties:"Third parties",system_undeclared_data_categories:"System undeclared data categories",data_use_undeclared_data_categories:"Data use undeclared data categories",cookies:"Cookies",uses_cookies:"Uses cookies",uses_non_cookie_access:"Uses non-cookie access",uses_profiling:"Uses profiling",processes_special_category_data:"Processes special category data"},m={[o.SYSTEM_UNDECLARED_DATA_CATEGORIES]:!1,[o.DATA_USE_UNDECLARED_DATA_CATEGORIES]:!1},S={dataUses:[],dataSubjects:[],dataCategories:[]},g=(0,n.createContext)({}),E=e=>{let{children:t}=e,[a,s]=(0,u._)(i.CUSTOM_REPORT_ID,""),[r,o]=(0,u._)(i.GROUP_BY,_.fI.SYSTEM_DATA_USE),[c,d]=(0,u._)(i.FILTERS,S),[p,E]=(0,u._)(i.COLUMN_ORDER,[]),[h,x]=(0,u._)(i.COLUMN_VISIBILITY,m),[f,A]=(0,u._)(i.COLUMN_SIZING,{}),[C,T]=(0,u._)(i.COLUMN_NAMES,{}),O=(0,n.useMemo)(()=>({savedCustomReportId:a,setSavedCustomReportId:s,groupBy:r,setGroupBy:o,selectedFilters:c,setSelectedFilters:d,columnOrder:p,setColumnOrder:E,columnVisibility:h,setColumnVisibility:x,columnSizing:f,setColumnSizing:A,columnNameMapOverrides:C,setColumnNameMapOverrides:T}),[a,s,r,o,c,d,p,E,h,x,f,A,C,T]);return(0,l.jsx)(g.Provider,{value:O,children:t})},h=()=>{let e=(0,n.useContext)(g);if(!e||0===Object.keys(e).length)throw Error("useDatamapReport must be used within a DatamapReportProvider");return e};var x=a(59003),f=a(92222),A=a(8540),C=a(41748),T=a(34090),O=a(66726),j=a.n(O),b=a(44296),v=a(19310),R=a(62528),y=a(38615),I=a(21820),D=a(12003),N=a(54321),L=e=>{let{children:t,heading:a,onCancel:s,onConfirm:r,isLoading:i,cancelButtonText:o,continueButtonText:n,"data-testid":c="standard-dialog",...d}=e,{onClose:u}=d;return(0,l.jsxs)(C.u_l,{closeOnOverlayClick:i,...d,children:[(0,l.jsx)(C.ZAr,{}),(0,l.jsxs)(C.hzk,{"data-testid":c,children:[a&&(0,l.jsx)(C.xBx,{children:a}),(0,l.jsx)(C.olH,{isDisabled:i,"data-testid":"standard-dialog-close-btn"}),t&&(0,l.jsx)(C.fef,{children:t}),(0,l.jsxs)(C.mzw,{gap:3,width:"100%",sx:{"& button":{width:"100%"}},children:[(0,l.jsx)(C.wpx,{onClick:()=>{s&&s(),u()},"data-testid":"".concat(c?"".concat(c,"-"):"","cancel-btn"),disabled:i,children:o||"Cancel"}),(0,l.jsx)(C.wpx,{onClick:r,type:"primary","data-testid":"".concat(c?"".concat(c,"-"):"","continue-btn"),loading:i,children:n||"Continue"})]})]})]})},M=a(31404),w=e=>{let[t,a]=(0,n.useState)(M.T2.csv),{onConfirm:s}=e;return(0,l.jsx)(L,{heading:"Export report",continueButtonText:"Download",size:"xl",...e,onConfirm:()=>s(t),"data-testid":"export-modal",children:(0,l.jsxs)(C.kCb,{direction:"column",gap:3,pb:3,children:[(0,l.jsx)(C.xvT,{textAlign:"left",children:"Export your data map report using the options below. Depending on the number of rows, the file may take a few minutes to process."}),(0,l.jsxs)(C.NIc,{children:[(0,l.jsx)(C.lXp,{htmlFor:"format",children:"Choose Format"}),(0,l.jsx)(C.WPr,{id:"format",value:t,onChange:a,"data-testid":"export-format-select",options:[{value:M.T2.csv,label:"CSV"},{value:M.T2.xlsx,label:"XLSX"}],className:"w-full"})]})]})})},P=a(72809),k=a(91650),U=a(79851),G=a(62091),H=a(35249);let F=e=>{let{label:t,children:a,...s}=e;return(0,l.jsxs)(C.Qdk,{...s,children:[(0,l.jsx)(C.X6q,{children:(0,l.jsxs)(C.KFZ,{height:"100%","data-testid":"filter-modal-accordion-button",textAlign:"left",fontWeight:600,children:[(0,l.jsx)(C.xuv,{flex:1,children:t}),(0,l.jsx)(C.XEm,{boxSize:7})]})}),(0,l.jsx)(C.Hk3,{children:a})]})},V=e=>{let{columnNameMap:t,selectedFilters:a,onFilterChange:s,onClose:r,...i}=e;(0,U.fd)(),(0,k.te)(),(0,H.MO)();let{dataUses:o,dataSubjects:c,dataCategories:d}=a,u=(0,b.C)(U.U3),_=(0,b.C)(k.ZL),p=(0,b.C)(H.qb),[m,S]=(0,n.useState)(o),[g,E]=(0,n.useState)(c),[h,x]=(0,n.useState)(d);(0,n.useEffect)(()=>{S(o)},[o]),(0,n.useEffect)(()=>{E(c)},[c]),(0,n.useEffect)(()=>{x(d)},[d]);let f=(0,n.useMemo)(()=>(0,G.Cd)(u),[u]),A=(0,n.useMemo)(()=>(0,G.Cd)(_),[_]),T=(0,n.useMemo)(()=>(0,G.Cd)(p),[p]);return(0,l.jsx)(L,{heading:"Filter Datamap Report",...i,onCancel:()=>{S([]),E([]),x([]),s({dataUses:[],dataSubjects:[],dataCategories:[]}),r()},onConfirm:()=>{s({dataUses:m,dataSubjects:g,dataCategories:h}),r()},onClose:r,cancelButtonText:"Reset filters",continueButtonText:"Done","data-testid":"datamap-report-filter-modal",children:(0,l.jsxs)(C.UQy,{allowToggle:!0,children:[(0,l.jsx)(F,{label:t.data_uses,children:(0,l.jsx)(P.ZP,{nodes:f,selected:m,onSelected:S,"data-testid":"filter-modal-checkbox-tree-uses"})}),(0,l.jsx)(F,{label:t.data_categories,children:(0,l.jsx)(P.ZP,{nodes:T,selected:h,onSelected:x,"data-testid":"filter-modal-checkbox-tree-categories"})}),(0,l.jsx)(F,{label:t.data_subjects,children:(0,l.jsx)(P.ZP,{nodes:A,selected:g,onSelected:E,"data-testid":"filter-modal-checkbox-tree-subjects"})})]})})};var Y=a(96878),Z=a(91591),z=a(60136),B=a(79711);let{useGetMinimalCustomReportsQuery:W,useLazyGetCustomReportByIdQuery:q,usePostCustomReportMutation:X,useDeleteCustomReportMutation:K}=a(21618).u.injectEndpoints({endpoints:e=>({getMinimalCustomReports:e.query({query:e=>{let{pageIndex:t=1,pageSize:a=50,report_type:s=_.C2.DATAMAP}=e,r="page=".concat(t,"&size=").concat(a,"&report_type=").concat(s);return{url:"plus/custom-report/minimal?".concat(r)}},providesTags:["Custom Reports"]}),getCustomReportById:e.query({query:e=>({url:"plus/custom-report/".concat(e)}),providesTags:(e,t,a)=>[{type:"Custom Reports",id:a}]}),postCustomReport:e.mutation({query:e=>({method:"POST",url:"plus/custom-report",body:e}),invalidatesTags:["Custom Reports"]}),deleteCustomReport:e.mutation({query:e=>({method:"DELETE",url:"plus/custom-report/".concat(e)}),invalidatesTags:["Custom Reports"]})})});var J=a(59389),Q=a(34803);let $="Report name",ee=e=>{let{isOpen:t,handleClose:a,tableStateToSave:s,columnMapToSave:r={},unavailableNames:i,onCreateCustomReport:o}=e,c=(0,C.pmc)(),[d]=X(),u=(0,n.useMemo)(()=>J.Ry().shape({reportName:J.Z_().label($).required("Please provide a name for this report").test("is-unique","",async(e,t)=>null==i||!i.includes(e)||t.createError({message:"This name already exists"})).max(80,"Report name is too long (max 80 characters)")}),[i]),p=async e=>{var t;let i={};Object.entries(r).forEach(e=>{let[t,a]=e;i[t]={label:a,enabled:!0}}),Object.entries(null!==(t=null==s?void 0:s.columnVisibility)&&void 0!==t?t:{}).forEach(e=>{let[t,a]=e;i[t]||(i[t]={}),i[t].enabled=a});try{let t={name:e.trim(),type:_.C2.DATAMAP,config:{column_map:i,table_state:s}},r=await d(t);if((0,z.D4)(r))throw r.error;o(r.data),a()}catch(e){c({status:"error",description:(0,z.e$)(e,"A problem occurred while creating the report.")})}};return(0,l.jsxs)(C.u_l,{size:"lg",isOpen:t,onClose:a,motionPreset:"none",children:[(0,l.jsx)(C.ZAr,{}),(0,l.jsxs)(C.hzk,{children:[(0,l.jsx)(C.xBx,{pb:0,children:"Create a report"}),(0,l.jsx)(T.J9,{initialValues:{reportName:""},onSubmit:e=>p(e.reportName),onReset:a,validateOnBlur:!1,validationSchema:u,children:e=>{let{dirty:t,isValid:a}=e;return(0,l.jsxs)(T.l0,{"data-testid":"custom-report-form",children:[(0,l.jsxs)(C.fef,{children:[(0,l.jsx)(C.xvT,{fontSize:"sm",color:"gray.600",pb:6,children:"Customize and save your current filter settings for easy access in the future. This saved report will include the column layout and currently applied filter settings."}),(0,l.jsx)(Q.j0,{id:"reportName",name:"reportName",isRequired:!0,label:$,placeholder:"Enter a name for the report...",variant:"stacked",maxLength:80})]}),(0,l.jsxs)(C.mzw,{gap:2,children:[(0,l.jsx)(C.wpx,{size:"small",htmlType:"reset",children:"Cancel"}),(0,l.jsx)(C.wpx,{size:"small",disabled:!t||!a,type:"primary","data-testid":"custom-report-form-submit",htmlType:"submit",children:"Save"})]})]})}})]})]})},et="Report",ea="Reports",es=e=>{var t;let{reportType:a,savedReportId:s,tableStateToSave:r,currentColumnMap:i,onCustomReportSaved:o,onSavedReportDeleted:c}=e,d=(0,y.Tg)([_.Sh.CUSTOM_REPORT_CREATE]),u=(0,y.Tg)([_.Sh.CUSTOM_REPORT_DELETE]),p=(0,C.pmc)({id:"custom-report-toast"}),{data:m,isLoading:S}=W({report_type:a}),[g,E]=(0,n.useState)(),[h]=q(),[x]=K(),{isOpen:f,onToggle:A,onOpen:O,onClose:j}=(0,C.qY0)(),{isOpen:b,onOpen:v,onClose:R}=(0,C.qY0)(),{isOpen:I,onOpen:D,onClose:N}=(0,C.qY0)(),[L,M]=(0,n.useState)(),[w,P]=(0,n.useState)(),[k,U]=(0,n.useState)(),[G,H]=(0,n.useState)(!1),F=(0,n.useMemo)(()=>{var e;let t=null==m?void 0:null===(e=m.items.find(e=>e.id===s))||void 0===e?void 0:e.name;return null!=t?t:ea},[null==m?void 0:m.items,s]),V=!S&&!(null==m?void 0:null===(t=m.items)||void 0===t?void 0:t.length),Y=e=>{E(null==m?void 0:m.items.filter(t=>t.name.toLowerCase().includes(e.toLowerCase())))},X=async e=>{M(e);let{data:t,isError:a,error:s}=await h(e);if(a){let e=(0,z.e$)(s,"A problem occurred while fetching the ".concat(et,"."));e.includes("not found")&&c(),p({status:"error",description:e})}else P(t)},J=()=>{M(""),P(void 0),H(!1)},Q=()=>{w?(H(!1),w.id!==s&&o(w),j()):L?H(!0):(o(null),j())},$=async e=>{e===(null==w?void 0:w.id)&&(J(),c()),x(e)};(0,n.useEffect)(()=>{m&&E(m.items)},[m]),(0,n.useEffect)(()=>{G&&(H(!1),Q())},[w]),(0,n.useEffect)(()=>{s?X(s):J()},[s]),(0,n.useEffect)(()=>{k&&D()},[D,k]);let es=!w&&!s||(null==w?void 0:w.id)===s;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(C.J2e,{placement:"bottom-end",isOpen:f,onClose:Q,id:"custom-reports-selection",children:[(0,l.jsx)(C.xol,{children:(0,l.jsx)(C.wpx,{className:"max-w-40",icon:(0,l.jsx)(C.v4q,{}),iconPosition:"end","data-testid":"custom-reports-trigger",onClick:A,children:(0,l.jsx)(C.xvT,{noOfLines:1,display:"inline-block",children:F})})}),(0,l.jsx)(C.h_i,{children:(0,l.jsxs)(C.yky,{"data-testid":"custom-reports-popover",children:[(0,l.jsx)(C.QHN,{}),(0,l.jsx)(T.J9,{initialValues:{},onSubmit:Q,onReset:J,children:(0,l.jsxs)(T.l0,{children:[(0,l.jsx)(C.wpx,{size:"small",disabled:V,htmlType:"reset",className:"absolute left-2 top-2","data-testid":"custom-reports-reset-button",children:"Reset"}),(0,l.jsxs)(C.Ytg,{textAlign:"center",children:[(0,l.jsx)(C.xvT,{fontSize:"sm",children:ea}),(0,l.jsx)(C.BZy,{size:"sm",mt:3,children:(0,l.jsx)(C.IIB,{type:"text",borderRadius:"md",placeholder:"Search...",onChange:e=>Y(e.target.value)})})]}),(0,l.jsx)(C.usR,{top:2,onClick:()=>{s?X(s):J(),j()},"data-testid":"custom-report-popover-cancel"}),(0,l.jsxs)(C.baG,{px:6,pt:5,pb:1,children:[V&&(0,l.jsxs)(C.gCW,{px:2,pt:6,pb:3,"data-testid":"custom-reports-empty-state",children:[(0,l.jsx)(C.hU,{variant:"primary",backgroundColor:"gray.500",isRound:!0,size:"xs","aria-label":"add ".concat(et),icon:(0,l.jsx)(Z.d,{}),onClick:v,"data-testid":"add-report-button"}),(0,l.jsxs)(C.xvT,{fontSize:"sm",textAlign:"center",color:"gray.500",children:["No ",ea.toLowerCase()," have been created. Start by applying your preferred filter and column settings, then create a"," ",et.toLowerCase()," for easy access later."]})]}),!V&&(S?(0,l.jsxs)(C.gCW,{pb:2,children:[(0,l.jsx)(C.OdW,{width:"100%",height:C.rSc.space[4]}),(0,l.jsx)(C.OdW,{width:"100%",height:C.rSc.space[4]}),(0,l.jsx)(C.OdW,{width:"100%",height:C.rSc.space[4]})]}):(0,l.jsx)(C.y02.Group,{onChange:e=>X(e.target.value),value:L,className:"flex flex-col gap-2",children:null==g?void 0:g.map(e=>(0,l.jsxs)(C.jqI,{className:u?"justify-between":"justify-start",children:[(0,l.jsx)(C.y02,{value:e.id,name:"custom-report-id","data-testid":"custom-report-item",children:(0,l.jsx)(C.xvT,{fontSize:"sm",children:e.name})}),u&&(0,l.jsx)(C.wpx,{type:"text",size:"small",icon:(0,l.jsx)(B.q,{fontSize:16}),onClick:()=>U(e),"data-testid":"delete-report-button"})]},e.id))}))]}),(0,l.jsx)(C.DT9,{border:"none",px:6,pb:4,pt:4,children:(0,l.jsxs)(C.Ugi,{children:[d&&r&&(0,l.jsxs)(C.wpx,{size:"small",onClick:v,className:"w-full","data-testid":"create-report-button",htmlType:"button",children:["+ Create ",et.toLowerCase()]}),(0,l.jsx)(C.wpx,{size:"small",type:"primary",loading:G,disabled:es,className:"w-full","data-testid":"apply-report-button",htmlType:"submit",children:"Apply"})]})})]})})]})})]}),(0,l.jsx)(ee,{isOpen:b,handleClose:()=>{R(),setTimeout(()=>{O()},100)},tableStateToSave:r,columnMapToSave:i,unavailableNames:null==m?void 0:m.items.map(e=>e.name),onCreateCustomReport:o}),(0,l.jsx)(C.cVQ,{isOpen:I,onClose:()=>{U(void 0),N()},onConfirm:()=>{k&&$(k.id),N()},title:"Delete ".concat(et),message:(0,l.jsxs)(C.xvT,{children:["You are about to permanently delete the"," ",et.toLowerCase()," named"," ",(0,l.jsx)("strong",{children:null==k?void 0:k.name}),". Are you sure you would like to continue?"]})})]})};var er=a(19785),ei=a.n(er),eo=a(55807),el=a.n(eo),en=a(32526),ec=a.n(en),ed=a(98320),eu=a(71533);let e_=(0,f.Cl)(),ep=(e,t)=>({cell:e=>(0,l.jsx)(A.G3,{value:e.getValue()}),header:a=>{let s={};return Object.keys(e).forEach(t=>{"string"==typeof e[t]?s[t]=e[t]:e[t].label&&(s[t]=e[t].label||"")}),(0,l.jsx)(ed.Hm,{value:(0,eu.AH)({columnId:a.column.id,columnNameMap:s}),defaultValue:p[a.column.id]||(0,eu.AH)({columnId:a.column.id}),isEditing:t,...a})}}),em=(e,t)=>{var a;let s=(null==e?void 0:null===(a=e.items)||void 0===a?void 0:a.length)?Object.keys(e.items[0]):[],r=Object.values(o);return s.filter(e=>!r.includes(e)).filter(e=>e.startsWith("privacy_declaration_")||e.startsWith("system_")).map(e=>{let a=t.find(t=>e.includes(ec()(t.name)));return e_.accessor(t=>t[e],{id:e,cell:e=>Array.isArray(e.getValue())?(0,l.jsx)(A.WP,{value:e.getValue(),ignoreZero:!0,...e}):(0,l.jsx)(A.G3,{value:e.getValue()}),meta:{showHeaderMenu:(null==a?void 0:a.field_type)==="string[]"}})})},eS=e=>{let{onSelectRow:t,getDataUseDisplayName:a,getDataCategoryDisplayName:s,getDataSubjectDisplayName:r,datamapReport:i,customFields:n,isRenaming:c=!1}=e,d=em(i,n);return[e_.accessor(e=>e.system_name,{enableGrouping:!0,id:o.SYSTEM_NAME,meta:{onCellClick:t}}),e_.accessor(e=>e.data_uses,{id:o.DATA_USE,cell:e=>{let t=e.getValue();return(0,l.jsx)(A.WP,{suffix:"data uses",ignoreZero:!0,value:ei()(t)?el()(t,a):a(t||""),badgeProps:{variant:"taxonomy"},...e})},meta:{width:"auto"}}),e_.accessor(e=>e.data_categories,{id:o.DATA_CATEGORY,cell:e=>{let t=e.getValue();if(!t||0===t.length)return null;let a=ei()(t)?t.map(e=>({label:s(e),key:e})):[{label:s(t),key:t}];return(0,l.jsx)(ed.mb,{values:a,cellProps:e,variant:"taxonomy"})},meta:{showHeaderMenu:!c,showHeaderMenuWrapOption:!0,width:"auto",overflow:"hidden"}}),e_.accessor(e=>e.data_subjects,{id:o.DATA_SUBJECT,cell:e=>{let t=e.getValue();return(0,l.jsx)(A.WP,{suffix:"data subjects",ignoreZero:!0,value:ei()(t)?el()(t,r):r(t||""),badgeProps:{variant:"taxonomy"},...e})},meta:{showHeaderMenu:!c}}),e_.accessor(e=>e.legal_name,{id:o.LEGAL_NAME}),e_.accessor(e=>e.dpo,{id:o.DPO}),e_.accessor(e=>e.legal_basis_for_processing,{id:o.LEGAL_BASIS_FOR_PROCESSING}),e_.accessor(e=>e.administrating_department,{id:o.ADMINISTRATING_DEPARTMENT}),e_.accessor(e=>e.cookie_max_age_seconds,{id:o.COOKIE_MAX_AGE_SECONDS}),e_.accessor(e=>e.privacy_policy,{id:o.PRIVACY_POLICY}),e_.accessor(e=>e.legal_address,{id:o.LEGAL_ADDRESS}),e_.accessor(e=>e.cookie_refresh,{id:o.COOKIE_REFRESH}),e_.accessor(e=>e.data_security_practices,{id:o.DATA_SECURITY_PRACTICES}),e_.accessor(e=>e.data_shared_with_third_parties,{id:o.DATA_SHARED_WITH_THIRD_PARTIES}),e_.accessor(e=>e.processes_special_category_data,{id:o.PROCESSES_SPECIAL_CATEGORY_DATA}),e_.accessor(e=>e.data_stewards,{id:o.DATA_STEWARDS,cell:e=>(0,l.jsx)(A.WP,{suffix:"data stewards",ignoreZero:!0,value:e.getValue(),...e}),meta:{showHeaderMenu:!c,width:"auto"}}),e_.accessor(e=>e.declaration_name,{id:o.DECLARATION_NAME}),e_.accessor(e=>e.does_international_transfers,{id:o.DOES_INTERNATIONAL_TRANSFERS}),e_.accessor(e=>e.dpa_location,{id:o.DPA_LOCATION}),e_.accessor(e=>e.egress,{id:o.DESTINATIONS,cell:e=>(0,l.jsx)(A.WP,{suffix:"destinations",ignoreZero:!0,value:e.getValue(),...e}),meta:{showHeaderMenu:!c,width:"auto"}}),e_.accessor(e=>e.exempt_from_privacy_regulations,{id:o.EXEMPT_FROM_PRIVACY_REGULATIONS}),e_.accessor(e=>e.features,{id:o.FEATURES,cell:e=>(0,l.jsx)(A.WP,{suffix:"features",ignoreZero:!0,value:e.getValue(),...e}),meta:{showHeaderMenu:!c,width:"auto"}}),e_.accessor(e=>e.fides_key,{id:o.FIDES_KEY}),e_.accessor(e=>e.flexible_legal_basis_for_processing,{id:o.FLEXIBLE_LEGAL_BASIS_FOR_PROCESSING}),e_.accessor(e=>e.impact_assessment_location,{id:o.IMPACT_ASSESSMENT_LOCATION}),e_.accessor(e=>e.ingress,{id:o.SOURCES,cell:e=>(0,l.jsx)(A.WP,{suffix:"sources",ignoreZero:!0,value:e.getValue(),...e}),meta:{showHeaderMenu:!c,width:"auto"}}),e_.accessor(e=>e.joint_controller_info,{id:o.JOINT_CONTROLLER_INFO}),e_.accessor(e=>e.legal_basis_for_profiling,{id:o.LEGAL_BASIS_FOR_PROFILING,cell:e=>(0,l.jsx)(A.WP,{suffix:"profiles",ignoreZero:!0,value:e.getValue(),...e}),meta:{showHeaderMenu:!c,width:"auto"}}),e_.accessor(e=>e.legal_basis_for_transfers,{id:o.LEGAL_BASIS_FOR_TRANSFERS,cell:e=>(0,l.jsx)(A.WP,{suffix:"transfers",ignoreZero:!0,value:e.getValue(),...e}),meta:{showHeaderMenu:!c,width:"auto"}}),e_.accessor(e=>e.legitimate_interest_disclosure_url,{id:o.LEGITIMATE_INTEREST_DISCLOSURE_URL}),e_.accessor(e=>e.processes_personal_data,{id:o.PROCESSES_PERSONAL_DATA}),e_.accessor(e=>e.reason_for_exemption,{id:o.REASON_FOR_EXEMPTION}),e_.accessor(e=>e.requires_data_protection_assessments,{id:o.REQUIRES_DATA_PROTECTION_ASSESSMENTS}),e_.accessor(e=>e.responsibility,{id:o.RESPONSIBILITY,cell:e=>(0,l.jsx)(A.WP,{suffix:"responsibilities",ignoreZero:!0,value:e.getValue(),...e}),meta:{showHeaderMenu:!c,width:"auto"}}),e_.accessor(e=>e.retention_period,{id:o.RETENTION_PERIOD}),e_.accessor(e=>e.shared_categories,{id:o.SHARED_CATEGORIES,cell:e=>(0,l.jsx)(A.WP,{suffix:"shared categories",ignoreZero:!0,value:e.getValue(),badgeProps:{variant:"taxonomy"},...e}),meta:{showHeaderMenu:!c,width:"auto"}}),e_.accessor(e=>e.special_category_legal_basis,{id:o.SPECIAL_CATEGORY_LEGAL_BASIS}),e_.accessor(e=>e.third_parties,{id:o.THIRD_PARTIES}),e_.accessor(e=>e.system_undeclared_data_categories,{id:o.SYSTEM_UNDECLARED_DATA_CATEGORIES,cell:e=>{let t=e.getValue();if(!t||0===t.length)return null;let a=ei()(t)?t.map(e=>({label:s(e),key:e})):[{label:s(t),key:t}];return(0,l.jsx)(ed.mb,{values:a,cellProps:e,variant:"taxonomy"})},meta:{showHeaderMenu:!c,showHeaderMenuWrapOption:!0,width:"auto",overflow:"hidden"}}),e_.accessor(e=>e.data_use_undeclared_data_categories,{id:o.DATA_USE_UNDECLARED_DATA_CATEGORIES,cell:e=>{let t=e.getValue();if(!t||0===t.length)return null;let a=ei()(t)?t.map(e=>({label:s(e),key:e})):[{label:s(t),key:t}];return(0,l.jsx)(ed.mb,{values:a,cellProps:e,variant:"taxonomy"})},meta:{showHeaderMenu:!c,showHeaderMenuWrapOption:!0,width:"auto",overflow:"hidden"}}),e_.accessor(e=>e.cookies,{id:o.COOKIES,cell:e=>(0,l.jsx)(A.WP,{ignoreZero:!0,suffix:"cookies",value:e.getValue(),...e}),meta:{showHeaderMenu:!c,width:"auto"}}),e_.accessor(e=>e.uses_cookies,{id:o.USES_COOKIES}),e_.accessor(e=>e.uses_non_cookie_access,{id:o.USES_NON_COOKIE_ACCESS}),e_.accessor(e=>e.uses_profiling,{id:o.USES_PROFILING}),...d]},eg=e=>e===_.fI.DATA_USE_SYSTEM?[o.DATA_USE]:[o.SYSTEM_NAME],eE=e=>{let t=[];return _.fI.SYSTEM_DATA_USE===e&&(t=[o.SYSTEM_NAME,o.DATA_USE]),_.fI.DATA_USE_SYSTEM===e&&(t=[o.DATA_USE,o.SYSTEM_NAME]),t},eh=(e,t)=>eE(e).concat(t.filter(e=>e!==o.SYSTEM_NAME&&e!==o.DATA_USE)),ex={items:[],total:0,page:1,size:25,pages:1},ef=()=>{let e=(0,y.Tg)([_.Sh.CUSTOM_REPORT_READ]),{isLoading:t}=(0,Y.x8)(),{PAGE_SIZES:a,pageSize:s,setPageSize:r,onPreviousPageClick:o,isPreviousPageDisabled:c,onNextPageClick:d,isNextPageDisabled:u,startRange:g,endRange:E,pageIndex:O,setTotalPages:L,resetPageIndexToDefault:M}=(0,A.oi)(),P=(0,C.pmc)({id:"datamap-report-toast"}),{isOpen:k,onClose:U,onOpen:G}=(0,C.qY0)(),{getDataUseDisplayName:H,getDataCategoryDisplayName:F,getDataSubjectDisplayName:Z,isLoading:z}=(0,v.Z)(),[B,W]=(0,n.useState)(),{savedCustomReportId:q,setSavedCustomReportId:X,groupBy:K,setGroupBy:J,selectedFilters:Q,setSelectedFilters:$,columnOrder:ee,setColumnOrder:et,columnVisibility:ea,setColumnVisibility:er,columnSizing:ei,setColumnSizing:eo,columnNameMapOverrides:el,setColumnNameMapOverrides:en}=h(),[ec,ed]=(0,n.useState)(!1),eu=e=>{X(""),J(e),ed(!0),M()},[e_,em]=(0,n.useState)(""),ef=(0,n.useCallback)(e=>{M(),em(e)},[M,em]),eA={pageIndex:O,pageSize:s,groupBy:K,search:e_,dataUses:(0,I.du)(Q.dataUses,"data_uses"),dataSubjects:(0,I.du)(Q.dataSubjects,"data_subjects"),dataCategories:(0,I.du)(Q.dataCategories,"data_categories")},{data:eC,isLoading:eT,isFetching:eO}=(0,D.tH)(eA),[ej,{isLoading:eb,isError:ev}]=(0,D.Eo)(),{data:eR,totalRows:ey}=(0,n.useMemo)(()=>{let e=eC||ex,t=e.items;return ec&&ed(!1),L(e.pages),{totalRows:e.total,data:t}},[eC]);(0,Y.GH)();let eI=(0,b.C)(Y.fN),[eD,eN]=(0,n.useState)(!1),eL=(0,n.useMemo)(()=>eC?eS({onSelectRow:e=>W(e.fides_key),getDataUseDisplayName:H,getDataCategoryDisplayName:F,getDataSubjectDisplayName:Z,datamapReport:eC,customFields:eI,isRenaming:eD}):[],[H,Z,F,eC,eI,eD]),{isOpen:eM,onOpen:ew,onClose:eP}=(0,C.qY0)(),{isOpen:ek,onOpen:eU,onClose:eG}=(0,C.qY0)(),eH=(0,x.b7)({getCoreRowModel:(0,f.sC)(),getGroupedRowModel:(0,f.qe)(),getExpandedRowModel:(0,f.rV)(),manualPagination:!0,enableColumnResizing:!0,columnResizeMode:"onChange",columns:eL,defaultColumn:ep({...p,...el},eD),data:eR,initialState:{expanded:!0,columnSizing:ei,columnOrder:ee,columnVisibility:ea,grouping:eg(K)}});(0,n.useEffect)(()=>{K&&eH&&eC&&(0===eH.getState().columnOrder.length?et(eh(K,eH.getAllColumns().map(e=>e.id))):et(eh(K,eH.getState().columnOrder)))},[K,eH,eC]),(0,n.useEffect)(()=>{let e=eg(K);eC&&eH.setGrouping(e)},[eC]);let eF=(0,n.useMemo)(()=>j()(eo,300),[eo]);(0,n.useEffect)(()=>{let e=eH.getState().columnSizing;e&&eF(e)},[eH.getState().columnSizing]);let eV=()=>{switch(K){case _.fI.SYSTEM_DATA_USE:return"system";case _.fI.DATA_USE_SYSTEM:return"data use";default:return"system"}},eY=(e,t)=>{if(e||q){if(!e){try{X(""),er(m),eH.toggleAllColumnsVisible(!0),eH.setColumnVisibility(m),et([]),eH.setColumnOrder([]),J(_.fI.SYSTEM_DATA_USE),$(S),en({}),t({values:{}})}catch(e){P({status:"error",description:"There was a problem resetting the report."})}return}try{var a,s,r,i;if(null===(a=e.config)||void 0===a?void 0:a.table_state){let{groupBy:t,filters:a,columnOrder:s}=e.config.table_state,i={};Object.entries(null!==(r=e.config.column_map)&&void 0!==r?r:{}).forEach(e=>{let[t,a]=e;i[t]=a.enabled||!1}),t&&J(t),a&&$(a),s&&(et(s),eH.setColumnOrder(s)),i&&(er(i),eH.setColumnVisibility(i))}if(null===(s=e.config)||void 0===s?void 0:s.column_map){let a={};Object.entries(null!==(i=e.config.column_map)&&void 0!==i?i:{}).forEach(e=>{let[t,s]=e;s.label&&(a[t]=s.label)}),en(a),t({values:a})}X(e.id),P({status:"success",description:"Report applied successfully."})}catch(e){P({status:"error",description:"There was a problem applying report."})}}};return eT||t||z?(0,l.jsx)(A.I4,{rowHeight:36,numRows:15}):(0,l.jsxs)(C.kCb,{flex:1,direction:"column",overflow:"auto",children:[(0,l.jsx)(V,{columnNameMap:{...p,...el},selectedFilters:Q,isOpen:k,onClose:U,onFilterChange:e=>{X(""),$(e)}}),(0,l.jsx)(A.F1,{isOpen:eM,onClose:eP,headerText:"Data map settings",columnNameMap:{...p,...el},prefixColumns:eE(K),tableInstance:eH,savedCustomReportId:q,onColumnOrderChange:e=>{X(""),eH.setColumnOrder(e),et(e)},onColumnVisibilityChange:e=>{X(""),eH.setColumnVisibility(e),er(e)}}),(0,l.jsx)(w,{isOpen:ek,onClose:eG,onConfirm:e=>{let t={};Object.entries(ea).forEach(e=>{let[a,s]=e;t[a]={enabled:s}}),Object.entries(el).forEach(e=>{let[a,s]=e;if(t[a])t[a].label=s;else{var r;t[a]={label:s,enabled:null===(r=ea[a])||void 0===r||r}}}),ej({...eA,format:e,report_id:q,report:{name:"",type:"datamap",config:{column_map:t,table_state:{groupBy:K,filters:Q,columnOrder:ee}}}}).then(()=>{ev||eG()})},isLoading:eb}),(0,l.jsx)(T.J9,{initialValues:el,onSubmit:e=>{X(""),en(e),eN(!1)},children:t=>{let{submitForm:a,resetForm:s}=t;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(A.Q$,{children:[(0,l.jsx)(A.HO,{globalFilter:e_,setGlobalFilter:ef,placeholder:"System name, Fides key, or ID"}),(0,l.jsxs)(C.kCb,{alignItems:"center",gap:2,children:[e&&(0,l.jsx)(es,{reportType:_.C2.DATAMAP,savedReportId:q,tableStateToSave:{groupBy:K,filters:Q,columnOrder:ee,columnVisibility:ea},currentColumnMap:el,onCustomReportSaved:e=>eY(e,s),onSavedReportDeleted:()=>{X("")}}),(0,l.jsxs)(C.v2r,{children:[(0,l.jsxs)(C.j2t,{as:C.wpx,icon:(0,l.jsx)(C.v4q,{}),iconPosition:"end",loading:ec,"data-testid":"group-by-menu",children:["Group by ",eV()]}),(0,l.jsxs)(C.qyq,{zIndex:11,"data-testid":"group-by-menu-list",children:[(0,l.jsx)(C.iiZ,{onClick:()=>{eu(_.fI.SYSTEM_DATA_USE)},isChecked:_.fI.SYSTEM_DATA_USE===K,value:_.fI.SYSTEM_DATA_USE,"data-testid":"group-by-system-data-use",children:"System"}),(0,l.jsx)(C.iiZ,{onClick:()=>{eu(_.fI.DATA_USE_SYSTEM)},isChecked:_.fI.DATA_USE_SYSTEM===K,value:_.fI.DATA_USE_SYSTEM,"data-testid":"group-by-data-use-system",children:"Data use"})]})]}),(0,l.jsx)(C.wpx,{"data-testid":"filter-multiple-systems-btn",onClick:G,children:"Filter"}),(0,l.jsx)(C.wpx,{"aria-label":"Export report","data-testid":"export-btn",onClick:eU,icon:(0,l.jsx)(R.nM,{ml:"1.5px"})}),(0,l.jsxs)(C.v2r,{placement:"bottom-end",children:[(0,l.jsx)(C.j2t,{as:C.wpx,icon:(0,l.jsx)(C.nXP,{className:"rotate-90"}),"data-testid":"more-menu","aria-label":"More options",className:"w-6 gap-0"}),(0,l.jsxs)(C.qyq,{"data-testid":"more-menu-list",children:[(0,l.jsx)(C.sNh,{onClick:ew,"data-testid":"edit-columns-btn",children:"Edit columns"}),(0,l.jsx)(C.sNh,{onClick:()=>eN(!0),"data-testid":"rename-columns-btn",children:"Rename columns"})]})]}),eD&&(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsx)(C.wpx,{size:"small","data-testid":"rename-columns-reset-btn",onClick:()=>{en({}),X(""),s({values:{}}),eN(!1)},children:"Reset all"}),(0,l.jsx)(C.wpx,{size:"small","data-testid":"rename-columns-cancel-btn",onClick:()=>{s({values:el}),eN(!1)},children:"Cancel"}),(0,l.jsx)(C.wpx,{size:"small",type:"primary",htmlType:"submit","data-testid":"rename-columns-apply-btn",onClick:a,children:"Apply"})]})]})]}),(0,l.jsx)(T.l0,{children:(0,l.jsx)(A.ZK,{tableInstance:eH,columnExpandStorageKey:i.COLUMN_EXPANSION_STATE,columnWrapStorageKey:i.WRAPPING_COLUMNS})})]})}}),(0,l.jsx)(A.s8,{totalRows:ey||0,pageSizes:a,setPageSize:r,onPreviousPageClick:o,isPreviousPageDisabled:c||eO,onNextPageClick:d,isNextPageDisabled:u||eO,startRange:g,endRange:E}),(0,l.jsx)(N.Z,{selectedSystemId:B,resetSelectedSystemId:()=>W(void 0)})]})};var eA=()=>(0,l.jsxs)(c.Z,{title:"Datamap Report",children:[(0,l.jsx)(d.Z,{"data-testid":"datamap-report-heading",heading:"Data map report"}),(0,l.jsx)(E,{children:(0,l.jsx)(ef,{})})]})}},function(e){e.O(0,[8033,5559,4554,2866,9278,3967,8540,5973,2017,4321,2888,9774,179],function(){return e(e.s=86548)}),_N_E=e.O()}]);