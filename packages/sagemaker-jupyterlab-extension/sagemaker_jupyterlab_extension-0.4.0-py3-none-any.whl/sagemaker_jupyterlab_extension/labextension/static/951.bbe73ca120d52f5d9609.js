"use strict";(self.webpackChunk_amzn_sagemaker_jupyterlab_extensions=self.webpackChunk_amzn_sagemaker_jupyterlab_extensions||[]).push([[951],{9951:(e,t,a)=>{a.r(t),a.d(t,{default:()=>rt});var n=a(9434);const s="@amzn/sagemaker-jupyterlab-extensions:gitclone",o="@amzn/sagemaker-jupyterlab-extensions:performance-metering",i="@amzn/sagemaker-jupyterlab-extension-common:projects-clonerepository",r="@amzn/sagemaker-jupyterlab-extensions:spacemenu",l={shutdown:"filemenu:shutdown"},c="Sso",d=3e5,u=500,p=100,m=12e4,g={SignInSession:{closeButton:"Close",signInButton:"Sign In",saveButton:"Save",saveAndRenewButton:"Save and renew session",signinDialog:{title:"Please sign in again",restartSessionBody:"You were logged out of your account. You are not able to perform actions in your workplace at this time. Please start a new session.",loggedOutBody:"You were logged out of your account. Choose 'Sign In' to continue using this workplace."},sessionExpiredDialog:{title:"Session Expired please signin"},renewSessionDialog:{title:"Session expiring soon",defaultBodyText:"If your session expires, you could lose unsaved changes.",renewSessionBody:'To renew the session, log out from Studio App via "File" -> "Log Out" and then "Sign out" from AWS IAM Identity Center (successor to AWS SSO) user portal.',saveAllChanges:"Do you want to save all changes now?",renewSessionNow:"Do you want to renew your session now?",remindText:"Remind me in 5 minutes",soonExpiringSessionBody:"This session will expire soon.",contDownTimerMessage:"This session will expire ",fromNow:"from now.",loseUnsavedChanges:"If your session expires, you could lose unsaved changes."}},ResourceUsage:{cpuMetricTitle:"CPU:",memoryMetricTitle:"MEM:",storageMetricTitle:"Storage:",instanceMemoryProgressBarTitle:"Instance MEM",instanceMetricsTitle:"Instance",stoargeSpaceLimitDialog:{title:"Free up storage space"}},GitClone:{dialogTitle:"Clone Git Repository",repoTitle:"Git repositories URL(.git):",pathTitle:"Project directory to clone into:",afterCloningTitle:"After cloning",openReadMeFilesLabel:"Open README files.",cancelButton:"Cancel",cloneButton:"Clone",errors:{directoryNotExistTitle:"Destination directory doesn’t exist.",directoryNotExistBody:"The destination directory doesn’t exist. Create this directory and then try cloning the repository again. directory: ",localGitCloneExistTitle:"Repository clone already exists in project.",localGitCloneExistBody:"It looks like the Git repository has already been cloned into the given directory. Click Dismiss to navigate to your existing clone. repositoy: ",noURLErrorTitle:"Missing valid URL.",noURLErrorBody:'No URL listed to clone the repository. Please input a valid URL ending with ".git".',generalCloneErrorTitle:"Unable to clone repository to project.",generalCloneErrorBody:"Something went wrong when trying to clone the repository to your project. Please try again later. ",failedOptions:"Failed to handle additional options.",failedOptionsBody:"Something went wrong when trying to open README file within the repo.",invalidCloneUrlTitle:"Invalid URL provided",invalidCloneUrlBody:"The URL provided is not valid. Please input a valid URL to clone."}},Space:{privateSpaceHeader:"Personal Studio",unknownUser:"Unknown User",unknownSpace:"Unknown Space"},ProjectsCloneRepo:{errorDialog:{errorTitle:"Unable to clone repository",defaultErrorMessage:"Something went wrong when cloning the repository.",invalidRequestErrorMessage:"A request to clone the reposioty is invalid.",invalidProjectName:"Invalid project name: Project does not exist.",invalidCloneUrlBody:"The URL provided is not valid. Please input a valid URL to clone."}}},h="GitCloneDialogError",y="ValidRepoPathError",v="spaceMenuHeader",w={id:"@amzn/sagemaker-jupyterlab-extensions:hideshutdown",requires:[n.IMainMenu],autoStart:!0,activate:(e,t)=>{e.commands._commands.get(l.shutdown).isVisible=()=>!1}};var f=a(9801),E=a.n(f),b=a(6029),x=a.n(b),S=a(7765),M=a(3352);class C{constructor(){this._dismissTime=0,this._count=0}setDismissTime(e){e&&(this._dismissTime=e,this._count=1)}getDismissTime(){return this._dismissTime}}const j=()=>{const e=R("authMode");return e&&e[1]&&e[1]===c},R=e=>document.cookie.match("\\b"+e+'="?([^;]*)"?\\b'),k=()=>{const e=R("expiryTime"),t=R("ssoExpiryTimestamp");return j()&&t?Number(t[1]):e?Number(e[1]):null},T=(e,t)=>{var a,n;t?null===(a=e.serviceManager)||void 0===a||a.connectionFailure.disconnect(S.ConnectionLost):null===(n=e.serviceManager)||void 0===n||n.connectionFailure.connect(S.ConnectionLost)},D=()=>{const e=R("redirectURL");let t;try{if(t=new URL(e?e[1]:void 0),"http:"===t.protocol||"https:"===t.protocol)return t.toString()}catch(e){return}},_=(e,t)=>{const a=k(),n=window.open(e,"signin window","width=800, height=600");let s=!1;const o=window.setInterval((()=>{if(n&&n.closed&&!s)return void window.clearInterval(o);const e=k();if(null!==e&&null!==a&&(e>a||isNaN(e))){window.clearInterval(o),n&&n.close(),s=!0;for(const e of t)e.kernel.reconnect();M.Dialog.tracker.forEach((e=>e.reject()))}}),p)},N=async()=>{const{SignInSession:e}=g,{signinDialog:t}=e,a=D(),n=a?[M.Dialog.okButton({label:e.signInButton})]:[M.Dialog.cancelButton({label:e.closeButton})],s=a?x().createElement("div",{"data-testid":"session-signin-log-out"},t.loggedOutBody):x().createElement("div",{"data-testid":"session-signin-restart"},t.restartSessionBody),o=new M.Dialog({title:t.title,body:s,buttons:n,hasClose:!1});return{sigInDialogResult:await o.launch(),confirmDialog:o}};var B=a(6797),I=a(6697),U=a(3798),z=a(7651),A=a(4075);const L=(e,t,a,n,s,o,i)=>{const r=k(),l=i(),c=l&&l+d;if(null===r)T(e,!1);else{const i=E().unix(r/1e3).diff(E()()),u=Date.now();((e,t,a)=>((e,t)=>-1===e&&t)(t,e)||((e,t)=>e<=0&&!t)(a,e))(j(),r,i)?(n(),(async(e,t,a)=>{const{SignInSession:n}=g,s=D();M.Dialog.tracker.forEach((e=>e.reject())),T(e,!0);const{sigInDialogResult:o,confirmDialog:i}=await N();if(o&&o.button)if(a(),s)_(D(),t);else if(o&&o.button.label===n.closeButton){const e=k(),t=e&&e/1e3,a=t&&E().unix(t).diff(E()());null!==a&&a&&a>d&&(i.dispose(),setTimeout((async()=>{await N()}),d))}else i.dispose(),_(D(),t)})(e,t,s)):i<=9e5&&(void 0===l||c&&u>c)?(n(),(async(e,t,a,n,s)=>{const{SignInSession:o}=g,{renewSessionDialog:i}=g.SignInSession,{renewSessionDialogResult:r,confirmDialog:l}=await(async()=>{const{SignInSession:e}=g,{renewSessionDialog:t}=g.SignInSession,a=D(),n=k(),s=n&&E().unix(n/1e3).fromNow(),o=`${t.contDownTimerMessage}${s}.`,i=`${j()?t.soonExpiringSessionBody:o}`,r=t.renewSessionBody,l=j()?x().createElement(x().Fragment,null,x().createElement("div",{"data-testid":"session-renew-lose-unsaved-changes"},i," ",t.loseUnsavedChanges," ",t.saveAllChanges),x().createElement("div",null,r)):x().createElement("div",{"data-testid":"session-renew-now"},x().createElement("p",null,i),x().createElement("p",null,t.renewSessionNow)),c=[M.Dialog.okButton({label:t.remindText}),a&&M.Dialog.okButton({label:e.saveAndRenewButton})],d=new M.Dialog({title:t.title,body:l,buttons:c,hasClose:!1});return{renewSessionDialogResult:await d.launch(),confirmDialog:d}})();if(r&&r.button.label===i.remindText){const e=new C;0===e._count?(e.setDismissTime(Date.now()),s(e._dismissTime)):e.getDismissTime(),l.dispose(),n()}else r&&r.button.label===o.saveAndRenewButton&&(l.dispose(),a(),n(),j()||_(D(),t))})(0,t._sessions,a,s,o),T(e,!1)):T(e,!1)}},P={id:"@amzn/sagemaker-jupyterlab-extensions:sessionmanagement",requires:[],autoStart:!0,activate:async e=>{let t;const a=e.serviceManager.sessions,n=()=>{s.start()},s=((e,t,a,n,s,o,i)=>new B.Poll({auto:!0,factory:async()=>L(e,t,a,n,s,o,i),frequency:{interval:u,backoff:!0,max:m}}))(e,a,(()=>{const t=new U.TextModelFactory,a=new U.DocumentRegistry({textModelFactory:t}),n=new z.ServiceManager({}),s=new A.DocumentManager({registry:a,manager:n,opener:{open:e=>{},get opened(){return{connect:()=>!1,disconnect:()=>!1}}}});(0,I.each)(e.shell.widgets("main"),(e=>{const t=s.contextForWidget(e);void 0!==t&&t.save().then((()=>t.createCheckpoint())).catch((e=>{if("Cancel"!==e.message)throw e}))}))}),(()=>{s.stop()}),n,(e=>{t=e}),(()=>t));n()}};var G=a(2144);const $=[200,201];var O,F=a(6004);!function(e){e.POST="POST",e.GET="GET"}(O||(O={}));const Z=async(e,t)=>{const a=z.ServerConnection.makeSettings(),n=F.URLExt.join(a.baseUrl,e);try{const e=await z.ServerConnection.makeRequest(n,{method:t},a);if(!$.includes(e.status))throw new Error("Unable to fetch data");return e}catch(e){throw Error(e)}};var V=a(5933);const H="8px",q="12px",W=V.css`
  border-bottom: solid 1px var(--sm-border-color2);
`,J=V.css`
  background-color: var(--jp-layout-color2);
  border: solid 1px var(--jp-border-color2);
  color: var(--jp-ui-font-color1);
  font-size: var(--jp-ui-font-size1);
  position: fixed;
  bottom: 25px;
`,Q=V.css`
  margin: 0 ${q} ${H};
`,Y=V.css`
  font-weight: bold;
  margin: ${H} 0 0 ${H};
`,K=(V.css`
  margin: 0 ${q} 0 ${"16px"};
`,V.css`
  border-radius: 10px;
  height: 100%;
  width: 30px;
`),X=V.css`
  line-height: 24px;
  padding: 0 5px;

  &:hover {
    background-color: var(--jp-layout-color2);
  }
`,ee=(V.css`
  padding-left: 4px;
`,V.css`
  display: flex;
  justify-content: flex-start;
  align-items: center;
  margin: 6px 12px;
`),te=V.css`
  color: var(--jp-ui-font-color1);
  font-size: var(--jp-ui-font-size1);
  padding-right: 5px;
`,ae=V.css`
  border-radius: 10px;
  width: 40px;
  margin: 0 0 2px 4px;
  height: 6px !important;
`,ne=(V.css`
  border-radius: 10px;
  display: inline-block;
  width: 40px;
  height: 8px;
`,V.css`
  display: flex;
  align-items: center;
`);var se=a(8441);const oe=({value:e,singleProgressBarStyle:t,displayValue:a,label:n,labelClassName:s,conatinerClassName:o})=>x().createElement("div",{role:"container","data-testid":"linear-progress-bar-container"},x().createElement("div",{className:o},n&&x().createElement("span",{className:s},n," ",a,"%"),x().createElement(se.Z,{"data-testid":"linear-progress-bar",className:t,variant:"determinate",value:e}))),ie="jlStudio-",re=`${ie}ResourceUsageWidgetContainer`,le=`${ie}MetricsWidgetContainer`,ce=({onClickHandler:e,instanceMetricsResponse:t,instanceMetricsDisplayValue:a})=>{const[n,s]=(0,b.useState)(!1),[o,i]=(0,b.useState)(0),[r,l]=(0,b.useState)(0),[c,d]=(0,b.useState)(0),[u,p]=(0,b.useState)(!1),m=e=>e&&void 0!==e?Math.round(e):0,h=e=>0===e?"0.0":e&&void 0!==e?e.toFixed(2).toString():"--";(0,b.useEffect)((()=>{if(void 0!==t&&(null==t?void 0:t.metrics)){const{metrics:e}=t,a=e.cpu.cpu_percentage,n=e.memory.memory_percentage,s=e.storage.used_space_in_bytes,o=e.storage.total_space_in_bytes,r=s&&o&&s/o*100;i(a),l(n),d(r)}}),[t]),(0,b.useEffect)((()=>{if(c&&c>95&&!1===u){const{stoargeSpaceLimitDialog:e}=g.ResourceUsage;M.Notification.info(e.title),p(!0)}}),[u,c]);const{instanceMemoryProgressBarTitle:y,instanceMetricsTitle:v,cpuMetricTitle:w,memoryMetricTitle:f,storageMetricTitle:E}=g.ResourceUsage;return x().createElement("div",{"data-testid":"resource-usage-widget","data-analytics-type":"eventContext","data-analytics":"JupyterLab",className:`${re} ${X}`},x().createElement("div",{className:ne,onClick:()=>(t=>{s(!t),e()})(n),"data-testid":"resource-usage-widget-click-handler","data-analytics-type":"eventDetail","data-analytics":"ResourceUsage-Widget-Click"},y," ",void 0===a?x().createElement(se.Z,{"data-testid":"resource-usage-linear-progress-spinner",className:ae}):x().createElement("div",{className:ne,"data-testid":"resource-usage-status-bar-container"},x().createElement(se.Z,{className:ae,variant:"determinate",value:0|a}),a?Math.round(a):0,"%")),n&&x().createElement("div",{className:`${le} ${J}`,"data-testid":"resource-usage-data-container"},x().createElement("div",{className:W},x().createElement("div",{className:Y},v),x().createElement("div",{className:Q},x().createElement("div",null,x().createElement(oe,{value:m(o),displayValue:h(o),label:w,labelClassName:te,singleProgressBarStyle:K,conatinerClassName:ee,"data-testid":"resource-usage-data-container-cpu"}),x().createElement(oe,{value:m(r),displayValue:h(r),label:f,labelClassName:te,singleProgressBarStyle:K,conatinerClassName:ee,"data-testid":"resource-usage-data-container-memory"}),x().createElement(oe,{value:m(c),displayValue:h(c),label:E,labelClassName:te,singleProgressBarStyle:K,conatinerClassName:ee,"data-testid":"resource-usage-data-container-storage"}))))))};class de extends M.ReactWidget{constructor(){super(),this.clickHandler=()=>{this.update()},this.getInstanceMetrics=async()=>{await Z("aws/sagemaker/api/instance/metrics",O.GET).then((e=>{e&&e.json().then((e=>{var t,a;this._instanceMetricsResponse=e||null,(null===(t=this._instanceMetricsResponse)||void 0===t?void 0:t.metrics.memory)?this._instanceMetricsDisplayValue=null===(a=this._instanceMetricsResponse)||void 0===a?void 0:a.metrics.memory.memory_percentage:this._instanceMetricsDisplayValue=void 0}))})),this.update()},this._getInstanceMetricsLoop=setInterval(this.getInstanceMetrics,5e3),this._instanceMetricsResponse=null,this._instanceMetricsDisplayValue=void 0}getInstanceMetricsResponse(){return this._instanceMetricsResponse}render(){return x().createElement(ce,{onClickHandler:this.clickHandler,instanceMetricsResponse:this._instanceMetricsResponse,instanceMetricsDisplayValue:this._instanceMetricsDisplayValue})}}const ue={id:"@amzn/sagemaker-jupyterlab-extensions:resourceusage",requires:[G.IStatusBar],autoStart:!0,activate:async(e,t)=>{const a=new de;t.registerStatusItem("@amzn/sagemaker-jupyterlab-extensions:resourceusage:resource-usage-widget",{item:a,align:"left",isActive:()=>!0,rank:100})}};var pe=a(3108),me=a(2715);const ge=V.css`
  .MuiInputBase-input MuiInput-input {
    width: 400px;
    margin-bottom: 20px;
  }
`,he=({label:e,id:t,helperText:a,error:n,handleChange:s,regEx:o,...i})=>{const[r,l]=(0,b.useState)(""),[c,d]=(0,b.useState)(!0);return x().createElement(me.Z,{variant:"standard",className:ge,"data-testid":"text-field-container",error:!c,id:t,label:e,helperText:a,value:r,onChange:e=>(e=>{l(e.target.value);const t=new RegExp(o);d(t.test(e.target.value)),s(e.target.value)})(e),...i})},ye=V.css`
  z-index: 2;
`,ve=V.css`
  width: 460px;
  input {
    width: 460px;
  }
  .MuiFormControl-root.MuiTextField-root {
    margin-bottom: 20px;
  }
`;V.css`
  margin-bottom: 20px;
`;var we=a(3776);const fe=(e=!1)=>V.css`
  color: var(--jp-color-root-light-800);
  font-weight: 400;
  font-size: var(--jp-ui-font-size1);
  line-height: var(--jp-ui-font-size1);
  margin-bottom: var(--jp-ui-font-size1);
  ${e&&"\n    &:after {\n      content: '*';\n      color: var(--jp-error-color1);\n    }\n  "}
`,Ee=V.css`
  margin-top: 20px;
`,be=({options:e,handleChange:t,label:a,freeSolo:n})=>{const s=(e,a)=>{t(a)};return b.createElement("div",{className:Ee},b.createElement("label",{className:fe(!0)},a),b.createElement(we.Z,{id:"autocomplete",freeSolo:n,autoSelect:!0,onChange:(e,t)=>s(0,t),onInputChange:(e,t)=>s(0,t),options:e.map((e=>e.label)),renderInput:e=>b.createElement(me.Z,{...e,variant:"outlined",size:"small",margin:"dense"})}))};var xe=a(2671),Se=a(847);const Me=({label:e,id:t,handleChange:a,...n})=>{const[s,o]=(0,b.useState)(!0);return x().createElement(x().Fragment,null,x().createElement(Se.Z,{control:x().createElement(xe.Z,{"data-testid":"checkbox-field",inputProps:{"aria-label":"controlled"},checked:s,onChange:e=>{o(e.target.checked),a(e.target.checked)},id:t,...n}),label:e}))},Ce=({gitRepositories:e,setGitURL:t,setPath:a,setOpenREADME:n})=>{const[s,o]=(0,b.useState)(""),[i,r]=(0,b.useState)(""),[l,c]=(0,b.useState)(!0),[d,u]=(0,b.useState)([]),{repoTitle:p,pathTitle:m,openReadMeFilesLabel:h}=g.GitClone;return(0,b.useEffect)((()=>{if(e&&e.GitCodeRepositories.length>=0){const t=[];e.GitCodeRepositories.length>0&&e.GitCodeRepositories.forEach((e=>t.push({value:e,label:e}))),u(t)}}),[e]),x().createElement("div",{className:ve,"data-testid":"git-clone-container","data-analytics-type":"eventContext","data-analytics":"JupyterLab"},x().createElement(be,{"data-testid":"autocomplete-field-container","data-analytics-type":"eventDetail","data-analytics":"GitClone-Repo-AutoComplete",label:p,options:d,value:i,handleChange:e=>{r(e),t(e)},freeSolo:!0}),x().createElement(he,{"data-testid":"text-field-container","data-analytics-type":"eventDetail","data-analytics":"GitClone-Path-TextField",error:!1,id:"path",label:m,helperText:"",valuePassed:s,handleChange:e=>{o(e),a(e)},regEx:"^([A-Za-z]*|[0-9]*|[/]*|[.]*|[A-Za-z0-9/.]*)$"}),x().createElement(Me,{"data-testid":"read-me-field","data-analytics-type":"eventDetail","data-analytics":"GitClone-OpenReadMeCheckbox",label:h,id:"openReadMe",handleChange:e=>{c(e),n(e)},checked:l}))};class je extends M.ReactWidget{constructor(){super(),this.setGitURL=e=>{this.URL=e},this.setPath=e=>{this.path=e},this.setOpenREADME=e=>{this.openREADME=e},this.getGitRepositories=async()=>{await Z("aws/sagemaker/api/git/list-repositories",O.GET).then((e=>{e&&e.json().then((e=>{this._gitCloneRepositories=e||null,this.update()}))}))},this.URL="",this.path="",this.openREADME=!0,this._gitCloneRepositories=null,this.getGitRepositories()}getValue(){return{URL:this.URL,path:this.path,openREADME:this.openREADME}}render(){return x().createElement(Ce,{gitRepositories:this._gitCloneRepositories,setGitURL:this.setGitURL,setPath:this.setPath,setOpenREADME:this.setOpenREADME})}}var Re=a(5717),ke=a(2190);const{name:Te,version:De}=a(4147),_e=(e,t,a)=>e.child({ExtensionName:Te,ExtensionVersion:De,PluginId:t},a);var Ne;!function(e){e[e.CanClone=0]="CanClone",e[e.NotExist=1]="NotExist",e[e.AlreadyCloned=2]="AlreadyCloned"}(Ne||(Ne={}));const Be=[{name:"README.ipynb",factory:"Notebook"},{name:"README.md",factory:"Markdown Preview"}],Ie=async(e,t,a)=>{const{repoPath:n,openREADME:s}=a;if(await e.execute("filebrowser:go-to-path",{path:n}),!0===s)try{await(async(e,t,a)=>{const n=await t.get(e);if("directory"===n.type){const t=Be.find((e=>n.content.some((t=>t.name===e.name))));t&&await a.execute("docmanager:open",{path:F.PathExt.join(e,t.name),factory:t.factory})}})(n,t,e)}catch(e){}},Ue=async(e,t)=>{let a;try{a=await t.get(e)}catch(e){return!1}return"directory"===a.type};var ze=a(1775),Ae=a(248),Le=a(4337),Pe=a(9510);const{dialogTitle:Ge,cancelButton:$e,cloneButton:Oe,errors:Fe}=g.GitClone,Ze={id:s,requires:[pe.IFileBrowserFactory,pe.IDefaultFileBrowser,ke.IGitExtension,M.IToolbarWidgetRegistry,Ae.ILogger,Re.ITranslator],autoStart:!0,activate:async(e,t,a,n,o,i,r)=>{const{commands:l,serviceManager:c}=e,d=c.contents,u=_e(i,s),p=(r=r||Re.nullTranslator).load("sagemaker_studio");l.addCommand(Le.TQ.gitClone,{label:"Git Clone Repo",caption:"",execute:()=>(async(e,t,a,n,s)=>{var o,i;const r=t.model;let l="";const c=null===(i=null===(o=null==e?void 0:e.tracker)||void 0===o?void 0:o.currentWidget)||void 0===i?void 0:i.model.path;let d,u=null!=c?c:"",p=!0,m=!0;const v=new M.Dialog({title:Ge,body:new je,focusNodeSelector:"input",buttons:[M.Dialog.cancelButton({label:$e}),M.Dialog.okButton({label:Oe})],hasClose:!1});v.addClass(ye);try{d=await v.launch()}catch(e){return void s.error({Message:h,Error:e})}if(!d.button.accept||!d.value)return;var w;if(({URL:l,path:u,openREADME:p,findEnvironment:m}=d.value),"string"==typeof(w=u)&&w.length>0||(u="./"),!(e=>/^(https:\/\/|git)([:/@.~\-_a-zA-Z0-9])+$/.test(e))(l))return void await(0,M.showErrorMessage)(Fe.invalidCloneUrlTitle,{message:Fe.invalidCloneUrlBody});const f=(e=>{const t=F.URLExt.parse(e);return F.PathExt.basename(t.pathname,".git")})(l),E=F.PathExt.join(u,f);let b;try{b=await(async(e,t,a,n)=>{const{errors:s}=g.GitClone;return await Ue(t,e)?await Ue(n,e)?(await(0,M.showErrorMessage)(s.localGitCloneExistTitle,{message:s.localGitCloneExistBody+a}),Ne.AlreadyCloned):Ne.CanClone:(await(0,M.showErrorMessage)(s.directoryNotExistTitle,{message:s.directoryNotExistBody+t}),Ne.NotExist)})(a,u,l,E)}catch(e){s.error({Message:y,Error:new Error(JSON.stringify(e))})}const x={repoPath:E,openREADME:p,findEnvironment:m};b===Ne.CanClone?(async(e,t,a,n,s,o)=>{const{errors:i}=g.GitClone,r=await e.execute("terminal:create-new");let l="";s&&(l+=`cd ${s} && `),l+=`git clone ${o} && exit\r`;try{const s=r.content;s.session.send({type:"stdin",content:[l]}),s.session.connectionStatusChanged.connect((async n=>{if("disconnected"===n.connectionStatus)try{await Ie(e,t,a)}catch(e){await(0,M.showErrorMessage)(i.failedOptions,i.failedOptionsBody,[M.Dialog.warnButton({label:"DISMISS"})])}})),await n.refresh()}catch(e){r.dispose(),await(0,M.showErrorMessage)(i.generalCloneErrorTitle,{message:i.generalCloneErrorBody+e})}})(n,a,x,r,u,l):b===Ne.AlreadyCloned&&Ie(n,a,x)})(t,a,d,l,u),isEnabled:()=>e.serviceManager.terminals.isAvailable()}),o.addFactory("FileBrowser","gitClone",(()=>M.ReactWidget.create(x().createElement(M.UseSignal,{signal:n.repositoryChanged,initialArgs:{name:"pathRepository",oldValue:null,newValue:n.pathRepository}},((t,a)=>x().createElement(M.ToolbarButtonComponent,{enabled:null===(null==a?void 0:a.newValue),icon:Pe.W6,onClick:()=>{e.commands.execute(Le.TQ.gitClone)},tooltip:p.__("Git Clone")})))))),(0,ze.ZM)(n,a,e.serviceManager.contents,e.contextMenu,p),u.info({Message:"Successfully loaded Git extension"})}},Ve=e=>{var t,a;const n=`${e}.AWSSageMakerUI`;return performance.mark(n),performance.measure(n,void 0,n),null!==(a=null===(t=performance.getEntriesByName(n,"measure")[0])||void 0===t?void 0:t.duration)&&void 0!==a?a:0},He={id:o,requires:[Ae.ILogger],autoStart:!0,activate:(e,t)=>{((e,t)=>{const a=null===window||void 0===window?void 0:window.performance.getEntriesByType("resource");let n={};Array.isArray(a)&&a.length>0&&a.forEach((e=>{const{duration:t,requestStart:a,responseStart:s,startTime:o}=e;a&&t&&(n={...n,TimeToFirstByteMS:Math.round(s-o)})}));let s=null,o=null,i=null,r=null,l=null;const c=performance.getEntriesByType("navigation")[0];if(c)s=c.redirectCount,o=c.redirectEnd-c.redirectStart,i=Math.round(c.domContentLoadedEventEnd),r=Math.round(c.responseStart),l=Math.round(c.loadEventEnd);else{const e=performance.timing;s=performance.navigation.redirectCount,o=e.redirectEnd-e.redirectStart,i=e.domContentLoadedEventEnd-e.navigationStart,r=e.responseStart-e.navigationStart,l=e.loadEventEnd-e.navigationStart}n={...n,RedirectCount:s,RedirectTimeMS:o,TimeToDOMContentLoadedMS:i,TimeToFirstByteMS:r,TimeToOnLoadMS:l},e.info(n),t.started.then((()=>{e.info({TimeToAppStartedMS:Math.round(Ve("timeToAppStarted"))})})),t.restored.then((()=>{const t=(a=Math.round(Ve("timeToAppRestored")))>0?a:null;var a;e.info({TimeToAppRestoredMS:t||void 0})}))})(_e(t,o,Ae.logSchemas.performance),e)}};var qe=a(87),We=a(8201);const Je={SpaceMenuHeader:V.css`
  margin: -6px 0;
  padding: 0 var(--jp-size-2);
  height: 10;
  border-radius: var(--jp-radius-small);
  font-size: var(--jp-size-3);
  display: flex;
  justify-content: center;
  align-items: center;

  & > p {
    display: inline-block;
    user-select: none;
    color: var(--jp-color-root-light-800);
  }

  & > svg {
    padding: 0 var(--jp-size-2);
  }
`},{unknownSpace:Qe,unknownUser:Ye}=g.Space,Ke=({spaceName:e})=>{const t=!!e,a=R("studioUserProfileName");return x().createElement("div",{className:Je.SpaceMenuHeader,"data-testid":v},t?x().createElement(qe.Z,{fontSize:"small"}):x().createElement(We.Z,{fontSize:"small"}),x().createElement("p",null,`${a&&a[1]||Ye} / ${t?e:Qe}`))};class Xe extends M.ReactWidget{constructor(){super(),this.getSpaceName=async()=>{await Z("aws/sagemaker/api/context",O.GET).then((e=>{e&&e.json().then((e=>{this.spaceName=e?null==e?void 0:e.spaceName:null,this.update()}))}))},this.spaceName="",this.getSpaceName()}render(){return x().createElement(Ke,{spaceName:this.spaceName})}}const et={id:r,requires:[Ae.ILogger],autoStart:!0,activate:async(e,t)=>{const a=new Xe;a.id=M.DOMUtils.createDomID();const n=_e(t,r);e.shell.add(a,"top",{rank:1e3}),window&&window.panorama&&window.panorama("trackCustomEvent",{eventType:"render",eventDetail:"Space-Plugin",eventContext:"JupyterLab",timestamp:Date.now()}),n.info({Message:"Successfully loaded Space plugin"})}};var tt=a(1973),at=a.n(tt);const nt=g.ProjectsCloneRepo.errorDialog,st=[{name:"README.ipynb",factory:"Notebook"},{name:"README.md",factory:"Markdown Preview"}],ot=async(e,t,a,n)=>{let s=F.PathExt.join(e,t);s=s.replace("$HOME","."),a.commands.execute("filebrowser:go-to-path",{path:s});const o=await n.get(s);if("directory"===o.type){const e=st.find((e=>o.content.some((t=>t.name===e.name))));e&&await a.commands.execute("docmanager:open",{path:F.PathExt.join(s,e.name),factory:e.factory})}},it=async e=>(0,M.showErrorMessage)(nt.errorTitle,{message:e}),rt=[w,P,ue,Ze,He,et,{id:i,requires:[S.IRouter,Ae.ILogger,pe.IDefaultFileBrowser],autoStart:!0,activate:async(e,t,a,n)=>{const{commands:s,serviceManager:o}=e,r=o.contents,l="projects:clone-repository",c=_e(a,i);s.addCommand(l,{execute:()=>(async(e,t,a,n,s)=>{const{search:o}=e.current;if(!o)return await it(nt.invalidRequestErrorMessage),void a.error({Error:new Error("Invalid cloning parameters: Query params must be specified")});const i=s.model,{is_efs:r,project_name:l="",repo_name:c="",clone_url:d="",code_commit:u}=F.URLExt.queryStringToObject(o),p=await(async()=>{let e;try{e=await Z("aws/sagemaker/api/projects/list-projects",O.GET)}catch(e){throw await it(nt.defaultErrorMessage),e}const t=await e.json(),{projectsList:a}=t;return a})();if(!(e=>""!==e&&/^https:\/\/[-\w.]+\.[A-Za-z]+\/[-\w@/.]+(?:\.git)?\/?(?:#.*)?$/.test(e))(d))return await it(nt.invalidCloneUrlBody),void a.error({Message:"Invalid cloning parameters: Clone URL is not valid"});if(!p.includes(l))return await it(nt.invalidProjectName),void a.error({Message:"Invalid project name: Project does not exist"});const m="$HOME",g=F.PathExt.join(m,"user-default-efs"),h=F.PathExt.join("true"===r?g:m,l),y=at()([h.replace("$HOME",".")]);let v=`if ! [[ -d ${y} ]]; then mkdir ${y}; fi && cd ${y} && `;u&&(v+="git config --global credential.https://git-codecommit.*.amazonaws.com.helper '!aws codecommit credential-helper $@' && git config --global credential.https://git-codecommit.*.amazonaws.com.usehttppath true &&"),v+="git config --global credential.helper 'cache --timeout=3600' && git config --global credential.usehttppath true &&";const w=at()([d]);v+=`git clone ${w} && exit\r`,t.restored.then((async()=>{try{let e=F.PathExt.join(h,c);if(e=e.replace("$HOME","."),"directory"===(await n.get(e)).type)return ot(h,c,t,n),void await i.refresh()}catch(e){a.info({Message:"Directory does not exist, creating directory."})}const e=await t.commands.execute("terminal:create-new");try{const a=e.content;a.session.send({type:"stdin",content:[v]}),t.commands.execute("launcher:create"),a.session.connectionStatusChanged.connect((async e=>{"disconnected"===e.connectionStatus&&(ot(h,c,t,n),a.session.shutdown())})),await i.refresh()}catch(t){try{const e=F.PathExt.join(h,c);await n.delete(e)}catch(e){a.error({Message:"Failed to cleanup partial clone"})}e.dispose();const s=t instanceof Error?t.message:String(t);await it(s)}}))})(t,e,c,r,n)}),t.register({command:l,pattern:new RegExp("[?]command=clone-repository"),rank:10})}}]},8201:(e,t,a)=>{var n=a(5318);t.Z=void 0;var s=n(a(4938)),o=a(5893),i=(0,s.default)((0,o.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 4c1.93 0 3.5 1.57 3.5 3.5S13.93 13 12 13s-3.5-1.57-3.5-3.5S10.07 6 12 6zm0 14c-2.03 0-4.43-.82-6.14-2.88C7.55 15.8 9.68 15 12 15s4.45.8 6.14 2.12C16.43 19.18 14.03 20 12 20z"}),"AccountCircle");t.Z=i},87:(e,t,a)=>{var n=a(5318);t.Z=void 0;var s=n(a(4938)),o=a(5893),i=(0,s.default)((0,o.jsx)("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zm6.93 6h-2.95c-.32-1.25-.78-2.45-1.38-3.56 1.84.63 3.37 1.91 4.33 3.56zM12 4.04c.83 1.2 1.48 2.53 1.91 3.96h-3.82c.43-1.43 1.08-2.76 1.91-3.96zM4.26 14C4.1 13.36 4 12.69 4 12s.1-1.36.26-2h3.38c-.08.66-.14 1.32-.14 2 0 .68.06 1.34.14 2H4.26zm.82 2h2.95c.32 1.25.78 2.45 1.38 3.56-1.84-.63-3.37-1.9-4.33-3.56zm2.95-8H5.08c.96-1.66 2.49-2.93 4.33-3.56C8.81 5.55 8.35 6.75 8.03 8zM12 19.96c-.83-1.2-1.48-2.53-1.91-3.96h3.82c-.43 1.43-1.08 2.76-1.91 3.96zM14.34 14H9.66c-.09-.66-.16-1.32-.16-2 0-.68.07-1.35.16-2h4.68c.09.65.16 1.32.16 2 0 .68-.07 1.34-.16 2zm.25 5.56c.6-1.11 1.06-2.31 1.38-3.56h2.95c-.96 1.65-2.49 2.93-4.33 3.56zM16.36 14c.08-.66.14-1.32.14-2 0-.68-.06-1.34-.14-2h3.38c.16.64.26 1.31.26 2s-.1 1.36-.26 2h-3.38z"}),"Language");t.Z=i},4147:e=>{e.exports=JSON.parse('{"name":"@amzn/sagemaker-jupyterlab-extensions","description":"SageMaker JupyterLab workspace primary extension module","version":"0.4.0","author":"Amazon","homepage":"https://aws.amazon.com/sagemaker/","license":"Amazon Software License","licenses":[{"type":"Amazon Software License","url":"http://aws.amazon.com/asl"}],"directories":{"test":"__tests__"},"files":["lib/**/*.{d.ts,eot,gif,html,jpg,js,js.map,json,png,svg,woff2,ttf}","style/**/*.{css,js,eot,gif,html,jpg,json,png,svg,woff2,ttf}","schema/*.json"],"scripts":{"build":"tsc","build:labextension":"tsc && jupyter labextension build .","build:labextension:dev":"jupyter labextension build --development True --source-map True .","lint:check":"eslint . --ext .js,.ts,.tsx","lint:fix":"eslint --fix . --ext .js,.ts,.tsx","release":"run-s build","install:extension":"jlpm run build","watch:src":"tsc -w","watch:labextension":"jupyter labextension watch .","watch":"run-p watch:src watch:labextension","dev:setup":"run-s -n dev:docker:build dev:docker:reset dev:docker:create","dev:docker:build":"(cd devSetup ; sh pull-jupyterlab-base-image.sh && docker build . --tag jupyterlab_ext_dev_image --build-arg CONTAINER_USER_ID=$(id -u) --build-arg CONTAINER_GROUP_ID=$(id -g))","dev:docker:reset":"docker stop jupyterlab_ext_dev_container || true && docker rm jupyterlab_ext_dev_container || true","dev:docker:create":"docker create --name jupyterlab_ext_dev_container --publish 8888:8888 --volume $(pwd):/sagemaker-studio-extension jupyterlab_ext_dev_image","dev:start":"docker start jupyterlab_ext_dev_container --attach","test":"jest","test:watch":"jest --watch"},"main":"lib/index.js","dependencies":{"@amzn/sagemaker-jupyterlab-extension-common":"^0.1.2","@emotion/css":"^11.1.3","@emotion/styled":"^11.11.0","@jupyterlab/application":"^4.0.5","@jupyterlab/apputils":"^4.0.5","@jupyterlab/coreutils":"^6.0.5","@jupyterlab/docmanager":"^4.0.5","@jupyterlab/docregistry":"^4.0.5","@jupyterlab/filebrowser":"^4.0.5","@jupyterlab/git":"^0.50.0","@jupyterlab/mainmenu":"^4.0.5","@jupyterlab/services":"^7.0.0","@jupyterlab/statusbar":"^4.0.5","@jupyterlab/terminal":"^4.0.5","@jupyterlab/translation":"^4.0.5","@lumino/algorithm":"^2.0.0","@lumino/commands":"^2.0.0","@lumino/coreutils":"^2.2.0","@lumino/polling":"^2.1.2","@lumino/signaling":"^2.1.2","@lumino/widgets":"^2.0.0","@mui/icons-material":"5.14","@mui/material":"^5.14.4","@testing-library/react":"^13.0.0","cookie":"0.6.0","isomorphic-fetch":"^3.0.0","moment":"^2.29.4","p-retry":"^5.1.2","react":"^18.2.0","react-dom":"^18.2.0","shell-escape":"^0.2.0"},"jupyterlab":{"extension":true,"outputDir":"sagemaker_jupyterlab_extension/labextension","disabledExtensions":["@jupyterlab/git:clone"],"sharedPackages":{"@amzn/sagemaker-jupyterlab-extension-common":{"bundled":false,"singleton":true,"strictVersion":false}}},"style":"src/style/index.css","devDependencies":{"@babel/preset-env":"^7.22.7","@babel/preset-react":"^7.22.5","@jupyterlab/builder":"^4.0.5","@types/jest":"^27.5.2","@types/lodash":"^4.14.172","@types/react":"^18.2.21","@types/react-dom":"^18.2.7","@types/shell-escape":"^0.2.3","@typescript-eslint/eslint-plugin":"^5.61.0","eslint-config-prettier":"^8.8.0","eslint-plugin-import":"^2.27.5","eslint-plugin-json":"^3.1.0","eslint-plugin-prettier":"^4.2.1","eslint-plugin-react":"^7.32.2","eslint-plugin-react-hooks":"^4.6.0","jest":"^27.2.4","npm-run-all":"^4.1.5","prettier":"^2.4.1","ts-jest":"^27.0.5","typescript":"^4.3.5"}}')}}]);