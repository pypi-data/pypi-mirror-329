/*! For license information please see 603.17c6fa7216ebca44db94.js.LICENSE.txt */
"use strict";(self.webpackChunk_aolney_jupyterlab_blockly_python_extension=self.webpackChunk_aolney_jupyterlab_blockly_python_extension||[]).push([[603],{3603:(e,t,n)=>{n.r(t),n.d(t,{BlocklyWidget_$ctor_A44FDC6:()=>q,BlocklyWidget__ActiveCellSerializedBlocksWorkspaceOption:()=>ae,BlocklyWidget__RenderBlocks:()=>re,BlocklyWidget__RenderCode:()=>se,BlocklyWidget__RenderCodeToLastCell:()=>ce,BlocklyWidget__clearBlocks:()=>ue,BlocklyWidget__get_Notebooks:()=>J,BlocklyWidget__get_blocksRendered:()=>Q,BlocklyWidget__get_lastCell:()=>ne,BlocklyWidget__get_notHooked:()=>ee,BlocklyWidget__get_onActiveCellChanged:()=>ie,BlocklyWidget__get_onKernelExecuted:()=>le,BlocklyWidget__get_workspace:()=>Z,BlocklyWidget__set_blocksRendered_Z1FBCCD16:()=>$,BlocklyWidget__set_lastCell_Z4422E5A0:()=>oe,BlocklyWidget__set_notHooked_Z1FBCCD16:()=>te,BlocklyWidget__set_workspace_Z1D3C0780:()=>K,attachWidget:()=>de,createMainAreaWidget:()=>pe,default:()=>be,onKernelChanged:()=>he,onNotebookChanged:()=>me,runCommandOnNotebookChanged:()=>ye});var o=n(4738),l=n(2209),i=n(8614),a=n(5256),s=n(123),r=n(4983),c=n(203),u=n(1324);function d(e){const t=e.getSourceBlock();if(t.isInFlyout)return;r.Events.setGroup(!0);const n=t.mutationToDom(),o=n&&r.Xml.domToText(n);t.minus(e.args_);const l=t.mutationToDom(),i=l&&r.Xml.domToText(l);o!=i&&r.Events.fire(new r.Events.BlockChange(t,"mutation",null,o,i)),r.Events.setGroup(!1)}function p(e=void 0){return new r.FieldImage(m,15,15,void 0,h)}function h(e){const t=e.getSourceBlock();if(t.isInFlyout)return;r.Events.setGroup(!0);const n=t.mutationToDom(),o=n&&r.Xml.domToText(n);t.plus(e.args_);const l=t.mutationToDom(),i=l&&r.Xml.domToText(l);o!=i&&r.Events.fire(new r.Events.BlockChange(t,"mutation",null,o,i)),r.Events.setGroup(!1)}const m="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZlcnNpb249IjEuMSIgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0Ij48cGF0aCBkPSJNMTggMTBoLTR2LTRjMC0xLjEwNC0uODk2LTItMi0ycy0yIC44OTYtMiAybC4wNzEgNGgtNC4wNzFjLTEuMTA0IDAtMiAuODk2LTIgMnMuODk2IDIgMiAybDQuMDcxLS4wNzEtLjA3MSA0LjA3MWMwIDEuMTA0Ljg5NiAyIDIgMnMyLS44OTYgMi0ydi00LjA3MWw0IC4wNzFjMS4xMDQgMCAyLS44OTYgMi0ycy0uODk2LTItMi0yeiIgZmlsbD0id2hpdGUiIC8+PC9zdmc+Cg==";var y=n(8569),b=n.n(y),_=_||{};class g extends b().FieldTextInput{constructor(e,t,n){super(e,n),this.imageElement_=null,this.INITWORDS=t,this.WORDS=this.INITWORDS,this.setSpellcheck(!1),this.clickWrapper_=null,this.moveWrapper_=null,this.downWrapper_=null}static fromJson(e){return new g("",e.fieldFilter,null)}showEditor_(e){const t=this.getSourceBlock();if(t){var n=t.workspace;b().common.setMainWorkspace(n)}if(null==b().WidgetDiv.getDiv()){var o=document.querySelector(".blocklyWidgetDiv");o&&o.remove(),b().WidgetDiv.createDom()}if(null==b().DropDownDiv.getContentDiv()){var l=document.querySelector(".blocklyDropDownDiv");l&&l.remove(),b().DropDownDiv.createDom()}super.showEditor_(e);var i=b().WidgetDiv.getDiv();if(!i||i.firstChild){var a=this.dropdownCreate_();if(b().DropDownDiv.getContentDiv().appendChild(a),t){var s=t.getColour();b().DropDownDiv.setColour(s,s)}b().DropDownDiv.showPositionedByField(this,this.dropdownDispose_.bind(this)),this.imageElement_&&(this.clickWrapper_=b().utils.browserEvents.bind(this.imageElement_,"click",this,this.hide_)),this.imageElement_&&(this.moveWrapper_=b().utils.browserEvents.bind(this.imageElement_,"mousemove",this,this.onMouseMove)),this.imageElement_&&(this.downWrapper_=b().utils.browserEvents.bind(this.imageElement_,"mousedown",this,this.onMouseDown)),this.updateGraph_()}}dropdownCreate_(){this.imageElement_=document.createElement("div"),this.imageElement_.id="fieldFilter",this.WORDS=this.INITWORDS;var e=18*this.WORDS.length;return this.imageElement_.style.cssText="border: 1px solid #ccc;height: "+e+"px;width: 150px;font-size: 12px;padding: 0px;font: normal 12pt sans-serif",this.imageElement_.innerHTML=this.WORDS.join("<br>"),this.imageElement_}dropdownDispose_(){this.clickWrapper_&&(b().utils.browserEvents.unbind(this.clickWrapper_),this.clickWrapper_=null),this.moveWrapper_&&(b().utils.browserEvents.unbind(this.moveWrapper_),this.moveWrapper_=null),this.downWrapper_&&(b().utils.browserEvents.unbind(this.downWrapper_),this.downWrapper_=null),this.imageElement_=null}hide_(){b().WidgetDiv.hide(),b().DropDownDiv.hideWithoutAnimation()}onMouseMove(e){if(this.imageElement_){var t=this.imageElement_.getBoundingClientRect(),n=e.clientY-t.top,o=Array.from(this.WORDS),l=Math.round((n-5)/18)<o.length?Math.round((n-5)/18):-1;-1!=l&&(o[l]="<font color='white'>"+o[l]+"</font>"),this.imageElement_.innerHTML=o.join("<br>")}}onMouseDown(e){if(this.imageElement_){var t=this.imageElement_.getBoundingClientRect(),n=e.clientY-t.top,o=Array.from(this.WORDS),l=Math.round((n-5)/18)<o.length?Math.round((n-5)/18):-1;this.setEditorValue_(l)}}valueToNote(e){return this.WORDS?this.WORDS[Number(e)]:""}noteToValue(e){var t=e.trim(),n=this.WORDS.indexOf(t);this.WORDS=[];for(var o=this.WORDS,l=this.INITWORDS,i=0;i<l.length;i++)-1==l[i].toUpperCase().indexOf(t.toUpperCase())&&""!=t||o.push(l[i]);0==this.WORDS.length&&o.push([""]);var a=18*this.WORDS.length;return this.imageElement_&&(this.imageElement_.style.cssText="border: 1px solid #ccc;height: "+a+"px;width: 150px;font-size: 12px;padding: 0px",this.imageElement_.innerHTML=this.WORDS.join("<br>")),n>-1?0:-1}getText_(){return this.isBeingEdited_?super.getText_():this.valueToNote(this.getValue())||null}getEditorText_(e){return this.valueToNote(e)}getValueFromEditorText_(e){return this.noteToValue(e)}render_(){super.render_(),this.updateGraph_()}updateGraph_(){this.imageElement_}doClassValidation_(e){return null==e?null:this.valueToNote(e)?e:""}}_.FieldFilter=g;const k=_;function f(){const e=r.Xml.workspaceToDom(r.getMainWorkspace());return r.Xml.domToText(e)}function v(e,t,n){r.Blocks[e]={init:function(){const o=t?this.appendValueInput("INPUT").setCheck(null):this.appendDummyInput();console.log(e+" init"),o.appendField(new r.FieldTextInput("type code here..."),"CODE"),n?this.setOutput(!0,null):(this.setNextStatement(!0),this.setPreviousStatement(!0)),this.setColour(230),this.setTooltip("You can put any Python code in this block. Use this block if you "+(t?"do":"don't")+" need to connect an input block and "+(n?"do":"don't")+" need to connect an output block."),this.setHelpUrl("https://docs.python.org/3/")}},c.pythonGenerator[e]=e=>{const o=e.getFieldValue("CODE").toString();let l;return l=t?(o+" "+c.pythonGenerator.valueToCode(e,"INPUT",c.pythonGenerator.ORDER_ATOMIC)).trim():o.trim(),n?[l,c.pythonGenerator.ORDER_ATOMIC]:l+"\n"}}function E(e,t,n){r.Blocks[e]={init:function(){const o=t?this.appendValueInput("INPUT").setCheck(null):this.appendDummyInput();console.log(e+" init"),o.appendField("# ").appendField(new r.FieldTextInput("type comment here..."),"COMMENT"),n?this.setOutput(!0,null):(this.setNextStatement(!0),this.setPreviousStatement(!0)),this.setColour(230),this.setTooltip("You can put any text comment in this block. Use this block if you "+(t?"do":"don't")+" need to connect an input block and "+(n?"do":"don't")+" need to connect an output block."),this.setHelpUrl("https://docs.python.org/3/")}},c.pythonGenerator[e]=e=>{const o=e.getFieldValue("COMMENT").toString();let l;return l=t?("# "+o+" "+c.pythonGenerator.valueToCode(e,"INPUT",c.pythonGenerator.ORDER_ATOMIC)).trim():"# "+o.trim(),n?[l,c.pythonGenerator.ORDER_ATOMIC]:l+"\n"}}function C(e,t,n){r.Blocks[e]={init:function(){this.appendDummyInput().appendField(t).appendField(new r.FieldTextInput("some library"),"libraryName").appendField(n).appendField(new r.FieldVariable("variable name"),"libraryAlias"),this.setNextStatement(!0),this.setPreviousStatement(!0),this.setColour(230),this.setTooltip("Import a python package to access functions in that package"),this.setHelpUrl("https://docs.python.org/3/reference/import.html")}},c.pythonGenerator[e]=e=>t+" "+e.getFieldValue("libraryName")+" "+n+" "+c.pythonGenerator.getVariableName(e.getFieldValue("libraryAlias"))+"\n"}function T(e,t,n,o,l,i){r.Blocks[e]={init:function(){console.log(e+" init"),this.appendValueInput("x").setCheck(null).appendField(t),this.setInputsInline(!0),this.setOutput(!0,n),this.setColour(230),this.setTooltip(o),this.setHelpUrl(l)}},c.pythonGenerator[e]=e=>[i+"("+c.pythonGenerator.valueToCode(e,"x",c.pythonGenerator.ORDER_MEMBER).replace("^\\[|\\]$","")+")",c.pythonGenerator.ORDER_FUNCTION_CALL]}c.pythonGenerator.finish=e=>{const t=[],n=[];let o=Object.keys(c.pythonGenerator.definitions_);for(let e in o){const l=c.pythonGenerator.definitions_[o[e]];l.indexOf("import")>=0&&t.push(l),0!==l.indexOf("def ")&&0!==l.indexOf("# ")||n.push(l)}return delete c.pythonGenerator.definitions_,delete c.pythonGenerator.functionNames_,c.pythonGenerator.nameDB_.reset(),"\n"+t+"\n"+n+"\n\n"+e},r.Blocks.comprehensionForEach_Python={init:function(){console.log("comprehensionForEach_Python init"),this.appendValueInput("LIST").setCheck(null).appendField("for each item").appendField(new r.FieldVariable("i"),"VAR").appendField("in list"),this.appendValueInput("YIELD").setCheck(null).setAlign(r.inputs.Align.RIGHT).appendField("yield"),this.setOutput(!0,null),this.setColour(230),this.setTooltip("Use this to generate a sequence of elements, also known as a comprehension. Often used for list comprehensions."),this.setHelpUrl("https://docs.python.org/3/tutorial/datastructures.html#list-comprehensions")}},c.pythonGenerator.comprehensionForEach_Python=e=>{const t=c.pythonGenerator.getVariableName(e.getFieldValue("VAR")),n=c.pythonGenerator.valueToCode(e,"LIST",c.pythonGenerator.ORDER_ATOMIC);return[c.pythonGenerator.valueToCode(e,"YIELD",c.pythonGenerator.ORDER_ATOMIC)+" for "+t+" in "+n,c.pythonGenerator.ORDER_ATOMIC]},r.Blocks.withAs_Python={init:function(){console.log("withAs_Python init"),this.appendValueInput("EXPRESSION").setCheck(null).appendField("with"),this.appendDummyInput().appendField("as").appendField(new r.FieldVariable("item"),"TARGET"),this.appendStatementInput("SUITE").setCheck(null),this.setNextStatement(!0),this.setPreviousStatement(!0),this.setColour(230),this.setTooltip("Use this to open resources (usually file-type) in a way that automatically handles errors and disposes of them when done. May not be supported by all libraries."),this.setHelpUrl("https://docs.python.org/3/reference/compound_stmts.html#with")}},c.pythonGenerator.withAs_Python=e=>{let t=c.pythonGenerator.statementToCode(e,"SUITE");return"with "+c.pythonGenerator.valueToCode(e,"EXPRESSION",c.pythonGenerator.ORDER_ATOMIC)+" as "+c.pythonGenerator.getVariableName(e.getFieldValue("TARGET"))+":\n"+t.toString()},r.Blocks.textFromFile_Python={init:function(){console.log("textFromFile_Python init"),this.appendValueInput("FILENAME").setCheck("String").appendField("read text from file"),this.setOutput(!0,null),this.setColour(230),this.setTooltip("Use this to read a text file. It will output a string."),this.setHelpUrl("https://docs.python.org/3/tutorial/inputoutput.html")}},c.pythonGenerator.textFromFile_Python=e=>["open("+c.pythonGenerator.valueToCode(e,"FILENAME",c.pythonGenerator.ORDER_ATOMIC)+",encoding='utf-8').read()",c.pythonGenerator.ORDER_FUNCTION_CALL],r.Blocks.openReadFile_Python={init:function(){console.log("openReadFile_Python init"),this.appendValueInput("FILENAME").setCheck("String").appendField("open file for reading"),this.setOutput(!0,null),this.setColour(230),this.setTooltip("Use this to read a file. It will output a file, not a string."),this.setHelpUrl("https://docs.python.org/3/tutorial/inputoutput.html")}},c.pythonGenerator.openReadFile_Python=e=>["open("+c.pythonGenerator.valueToCode(e,"FILENAME",c.pythonGenerator.ORDER_ATOMIC)+",encoding='utf-8')",c.pythonGenerator.ORDER_FUNCTION_CALL],r.Blocks.openWriteFile_Python={init:function(){console.log("openWriteFile_Python init"),this.appendValueInput("FILENAME").setCheck("String").appendField("open file for writing"),this.setOutput(!0,null),this.setColour(230),this.setTooltip("Use this to write to a file. It will output a file, not a string."),this.setHelpUrl("https://docs.python.org/3/tutorial/inputoutput.html")}},c.pythonGenerator.openWriteFile_Python=e=>["open("+c.pythonGenerator.valueToCode(e,"FILENAME",c.pythonGenerator.ORDER_ATOMIC)+",'w',encoding='utf-8')",c.pythonGenerator.ORDER_FUNCTION_CALL],v("dummyOutputCodeBlock_Python",!1,!0),v("dummyNoOutputCodeBlock_Python",!1,!1),v("valueOutputCodeBlock_Python",!0,!0),v("valueNoOutputCodeBlock_Python",!0,!1),E("dummyOutputCommentBlock_Python",!1,!0),E("dummyNoOutputCommentBlock_Python",!1,!1),E("valueOutputCommentBlock_Python",!0,!0),E("valueNoOutputCommentBlock_Python",!0,!1),C("importAs_Python","import","as"),C("importFrom_Python","from","import"),r.Blocks.indexer_Python={init:function(){this.appendValueInput("INDEX").appendField(new r.FieldVariable("{dictVariable}"),"VAR").appendField("["),this.appendDummyInput().appendField("]"),this.setInputsInline(!0),this.setOutput(!0),this.setColour(230),this.setTooltip("Gets an item from the variable at a given index. Not supported for all variables."),this.setHelpUrl("https://docs.python.org/3/reference/datamodel.html#object.__getitem__")}},c.pythonGenerator.indexer_Python=e=>[c.pythonGenerator.getVariableName(e.getFieldValue("VAR"))+"["+c.pythonGenerator.valueToCode(e,"INDEX",c.pythonGenerator.ORDER_ATOMIC)+"]",c.pythonGenerator.ORDER_ATOMIC],T("reversedBlock_Python","reversed","None","Create a reversed iterator to reverse a list or a tuple; wrap it in a new list or tuple.","https://docs.python.org/3/library/functions.html#reversed","reversed"),T("tupleConstructorBlock_Python","tuple","None","Create a tuple from a list, e.g. ['a','b'] becomes ('a','b')","https://docs.python.org/3/library/stdtypes.html#tuple","tuple"),T("dictBlock_Python","dict","None","Create a dictionary from a list of tuples, e.g. [('a',1),('b',2)...]","https://docs.python.org/3/tutorial/datastructures.html#dictionaries","dict"),T("listBlock_Python","list","None","Create a list from an iterable, e.g. list(zip(...))","https://docs.python.org/3/library/stdtypes.html#typesseq-list","list"),T("zipBlock_Python","zip","Array","Zip together two or more lists","https://docs.python.org/3.3/library/functions.html#zip","zip"),T("sortedBlock_Python","as sorted","Array","Sort lists of stuff","https://docs.python.org/3.3/library/functions.html#sorted","sorted"),T("setBlock_Python","set","Array","Make a set with unique members of a list.","https://docs.python.org/2/library/sets.html","set"),T("boolConversion_Python","as bool","Boolean","Convert something to Boolean.","https://docs.python.org/3/library/stdtypes.html#boolean-values","bool"),T("strConversion_Python","as str","String","Convert something to String.","https://docs.python.org/3/library/stdtypes.html#str","str"),T("floatConversion_Python","as float","Number","Convert something to Float.","https://docs.python.org/3/library/functions.html#float","float"),T("intConversion_Python","as int","Number","Convert something to Int.","https://docs.python.org/3/library/functions.html#int","int"),T("getInput_Python","input","String","Present the given prompt to the user and wait for their typed input response.","https://docs.python.org/3/library/functions.html#input","input"),r.Blocks.tupleBlock_Python={init:function(){this.appendValueInput("FIRST").setCheck(null).appendField("("),this.appendValueInput("SECOND").setCheck(null).appendField(","),this.appendDummyInput().appendField(")"),this.setInputsInline(!0),this.setOutput(!0,null),this.setColour(230),this.setTooltip("Use this to create a two-element tuple"),this.setHelpUrl("https://docs.python.org/3/tutorial/datastructures.html#tuples-and-sequences")}},c.pythonGenerator.tupleBlock_Python=e=>["("+c.pythonGenerator.valueToCode(e,"FIRST",c.pythonGenerator.ORDER_ATOMIC)+","+c.pythonGenerator.valueToCode(e,"SECOND",c.pythonGenerator.ORDER_ATOMIC)+")",c.pythonGenerator.ORDER_NONE],r.Blocks.train_test_split={init:function(){this.appendValueInput("teste_size").setAlign(r.inputs.Align.RIGHT).appendField("Test Size").setCheck("Number"),this.appendValueInput("dataframe").appendField("(train test split)").appendField("DataFrame"),this.appendValueInput("label").setAlign(r.inputs.Align.RIGHT).appendField("Label"),this.appendValueInput("features").setAlign(r.inputs.Align.RIGHT).appendField("Features"),this.setColour(230),this.setTooltip("Split a DataFrame into training and testing datasets."),this.setHelpUrl(""),this.setOutput(!0)}},c.pythonGenerator.train_test_split=function(e){const t=c.pythonGenerator.valueToCode(e,"teste_size",c.pythonGenerator.ORDER_MEMBER)||"0.2",n=c.pythonGenerator.valueToCode(e,"dataframe",c.pythonGenerator.ORDER_MEMBER)||"[]",o=c.pythonGenerator.valueToCode(e,"label",c.pythonGenerator.ORDER_MEMBER)||"[]",l=c.pythonGenerator.valueToCode(e,"features",c.pythonGenerator.ORDER_MEMBER)||"[]";return c.pythonGenerator.definitions_["import_sklearn.model_selection"]="from sklearn.model_selection import train_test_split",n&&o&&l||console.warn("Invalid inputs for train_test_split block. Generated code may be invalid."),[`train_test_split(${n}[${l}], ${n}[${o}], test_size=${t})`,c.pythonGenerator.ORDER_FUNCTION_CALL]},r.Blocks.selector_train_test_split={init:function(){this.appendValueInput("train_test").appendField("Train Test Split:").appendField(new r.FieldDropdown([["X Train","x_train"],["X Test","x_test"],["Y Train","y_train"],["Y Test","y_test"]]),"SPLITSELECTOR"),this.setColour(230),this.setTooltip("Selects the output of the train/test split (X Train, X Test, Y Train, Y Test)."),this.setHelpUrl(""),this.setOutput(!0)}},c.pythonGenerator.selector_train_test_split=function(e){const t=c.pythonGenerator.valueToCode(e,"train_test",c.pythonGenerator.ORDER_MEMBER)||"[]",n=e.getFieldValue("SPLITSELECTOR")||"";return t?[`${t}[${{x_train:0,x_test:1,y_train:2,y_test:3}[n]}]`,c.pythonGenerator.ORDER_FUNCTION_CALL]:(console.warn('No DataFrame input provided in "selector_train_test_split" block. Generated code may be invalid.'),["",c.pythonGenerator.ORDER_NONE])};class I{constructor(e,t,n,o){this.Name=e,this.Info=t,this.isFunction=n,this.isClass=o}}class w{constructor(e,t){this.VariableEntry=e,this.ChildEntries=t}}let x=null;function M(){var e;if(x){const t=x.currentWidget;if(null==t)return;{const n=t,o=null===(e=n.sessionContext.session)||void 0===e?void 0:e.kernel;return null==o?void 0:[n,o]}}}function N(e){const t=M();if(null==t)return console.log("NOKERNEL"),Promise.reject((()=>{throw 1})());{const n=t[0],o=t[1];return new Promise(((t,l)=>{o.requestInspect({code:e,cursor_pos:e.length,detail_level:0}).then((o=>{const i=o.content;if("found"in i&&i.found){const o=n.content.rendermime.preferredMimeType(i.data),a=i.data,s=new u.MimeModel({data:a});if(o){const i=n.content.rendermime.createRenderer(o);i.renderModel(s).then((()=>{t(i.node.innerText)})).catch((t=>{console.log(e+":RENDER_ERROR"),l(t)}))}}else console.log(e+":UNDEFINED"),t("UNDEFINED")})).catch((t=>{console.log(e+":UNAVAILABLE"),l(new Error(e+" is unavailable"))}))}))}}const O=new Map([]);function R(e){return e.includes("Signature:")&&e.includes("function")||e.includes("Signature:")&&e.includes("method")}function D(e){return e.includes("signature:")&&e.includes("class")}function A(e){try{const t=new r.Events.BlockChange(e,"field","VAR",0,1);t.group="INTELLISENSE",console.log("event status is "+r.Events.disabled_),r.Events.disabled_=0,r.Events.fire(t)}catch(e){e instanceof Error&&console.log("Intellisense event failed to fire; "+e.message)}}function F(e,t){return""===t||e.isInFlyout||function(e,t){N(t).then((n=>{const o=new I(t,n,R(n),D(n));let l=!0,i=O.get(o.Name);i&&(l=i.VariableEntry.Info!==o.Info||i.ChildEntries.length<=1),l?function(e){const t=M();if(null==t)return Promise.reject((()=>{throw 1})());{const n=t[1];return new Promise(((t,o)=>{setTimeout((()=>{n.requestComplete({code:e,cursor_pos:e.length}).then((e=>{const n=e.content;"matches"in n&&t(n.matches.slice())})).catch((t=>{o([e+" is unavailable"])}))}),100)}))}}(t+".").then((n=>{let l=n.filter((e=>!o.Info.startsWith("Signature: DataFrame")||!e.startsWith("_")&&!e.startsWith("style")));const i=l.map(((e,n)=>N(t+"."+e)));Promise.allSettled(i).then((n=>{let i=l.map(((e,t)=>{let o="",l=!0,i=!1;return"fulfilled"===n[t].status&&(o=n[t].value,l=R(o),i=D(o)),new I(e,o,l,i)})).sort(((e,t)=>e.Name<t.Name?-1:1)),a=new w(o,i);O.set(t,a),A(e)})).catch((e=>{console.log("Intellisense error getting inspections for children of "+t,e)}))})).catch((e=>{console.log("Intellisense error getting child completions of "+t,e)})):(console.log("Not refreshing intellisense for "+o.Name),A(e))})).catch((e=>{console.log("Intellisense error getting inspection of intellisense variable candidate (parent) "+t,e)}))}(e,t),e.isInFlyout?[[" "," "]]:""!==t&&O.has(t)?[["!Waiting for kernel to respond with options.","!Waiting for kernel to respond with options."]]:[["!Not defined until you execute code.","!Not defined until you execute code."]]}function B(e,t){var n;const o=(i=e,null,(l=O).has(i)?[!0,l.get(i)]:[!1,null]);var l,i;if(o[0]){const e=null===(n=o[1])||void 0===n?void 0:n.ChildEntries.find((e=>e.Name===t));return null==e?"!Not defined until you execute code.":e.Info}return"!Not defined until you execute code."}function P(){const e=r.getMainWorkspace(),t=e.getBlocksByType("varGetProperty_Python",!1);e.getBlocksByType("varDoMethod_Python",!1).forEach((e=>t.push(e))),t.forEach((e=>{e.updateIntellisense(e,null,(t=>F(e,t)))})),e.registerToolboxCategoryCallback("VARIABLE",r.Variables.flyoutCategoryBlocks)}function S(e,t,n){const o=e.getField(t),l=e.getInput(n);o&&(l?l.removeField(t):console.log("error removing ("+t+") from block; input ("+n+") does not exist"))}function L(e,t,n,o,l,i){r.Blocks[e]={varSelectionUserName(e,t){const n=e.getField("VAR"),o=e.workspace.getAllVariables().slice(-1)[0],l=e.data,i=l&&l.indexOf(":")>=0?l.split(":"):[""];if(null==t){const e=n.getText(),t=i[0],l=o?o.name:"";return""===e?""===t?l:t:e}{const e=n.getOptions().find((e=>e[1]===t));return e&&"string"==typeof e[0]?e[0]:""}},selectedMember:"",updateIntellisense(e,t,n){const o=e.getInput("INPUT");S(e,"MEMBER","INPUT"),S(e,"USING","INPUT");const l=e.varSelectionUserName(e,t),i=n(l).map((e=>e[0])),a=e.data?e.data:"";let s="";if(a.endsWith(":")&&i.length>0?(s=i[0],e.data=l+":"+s):a.indexOf(":")>=0&&(s=a.split(":")[1]),o){let t=new k.FieldFilter(s,i,(function(t){const n=""===t?s:this.WORDS[t];let o;return this.setTooltip(B(l,n)),e.selectedMember=(o=[0===n.indexOf("!"),this.selectedMember],""===o[1]?n:o[0]?this.selectedMember:n),""!==l&&""!==e.selectedMember&&(e.data=l+":"+e.selectedMember),n}));o.appendField(t,"MEMBER")}void 0!==e.data&&null!==e.data||(e.data=l+":"+e.selectedMember);const r=e.getField("MEMBER");r&&r.setTooltip(B(l,r.getText()))},init:function(){console.log(e+" init"),this.appendDummyInput("INPUT").appendField(t).appendField(new r.FieldVariable("variable name",(e=>(this.updateIntellisense(this,e,(e=>F(this,e))),e))),"VAR").appendField(n),this.updateIntellisense(this,null,(e=>F(this,e))),this.setOutput(!0),this.setColour(230),this.setTooltip("!Not defined until you execute code."),this.setHelpUrl(""),l&&(this.appendDummyInput("EMPTY"),r.Extensions.apply("intelliblockMutator_Python",this,!0))},onchange:function(e){if(this.workspace&&!this.isInFlyout&&"INTELLISENSE"===e.group){this.updateIntellisense(this,null,(e=>function(e,t){const n=O.get(t);return n?!n.VariableEntry.isFunction&&n.ChildEntries.length>0?n.ChildEntries.filter(e).map((e=>[e.Name,e.Name])):"UNDEFINED"===n.VariableEntry.Info?[["!Not defined until you execute code.","!Not defined until you execute code."]]:[["!No properties available.","!No properties available."]]:[["!Not defined until you execute code.","!Not defined until you execute code."]]}(o,e)));const e=this.data?this.data.toString().split(":"):"",t=this.getField("MEMBER");""!==e[1]&&t.setValue(e[1]);const n=this.varSelectionUserName(this,null);this.setTooltip(function(e){const t=O.get(e);return t?t.VariableEntry.Info:"!Not defined until you execute code."}(n))}}},c.pythonGenerator[e]=e=>{const t=c.pythonGenerator.getVariableName(e.getFieldValue("VAR")),n=e.getFieldValue("MEMBER").toString();let o="";if(0===n.indexOf("!"))o="";else if(l){const l=Array.from({length:e.itemCount_},((t,n)=>c.pythonGenerator.valueToCode(e,"ADD"+n.toString(),c.pythonGenerator.ORDER_MEMBER))).join(",");o=t+(i?".":"")+n+"("+l+")"}else o=t+(i?".":"")+n;return[o,c.pythonGenerator.ORDER_FUNCTION_CALL]}}!function(e,t,n,o,l){const i={itemCount_:0,mutationToDom:function(){const e=r.utils.xml.createElement("mutation");return e.setAttribute("items",this.itemCount_),e},domToMutation:function(e){const t=e.getAttribute("items"),n=t?parseInt(t,10):0;return this.updateShape_(n)},updateShape_:function(e){for(;this.itemCount_<e;)this.addPart_();for(;this.itemCount_>e;)this.removePart_();return this.updateMinus_()},plus:function(){return this.addPart_(),this.updateMinus_()},minus:function(){0!==this.itemCount_&&(this.removePart_(),this.updateMinus_())},addPart_:function(){0===this.itemCount_?(this.removeInput("EMPTY"),this.topInput_=this.appendValueInput("ADD"+this.itemCount_).appendField(p(),"PLUS").appendField("using").setAlign(r.inputs.Align.RIGHT)):this.appendValueInput("ADD"+this.itemCount_).appendField("and").setAlign(r.inputs.Align.RIGHT),this.itemCount_=this.itemCount_+1},removePart_:function(){this.itemCount_=this.itemCount_-1,this.removeInput("ADD"+this.itemCount_),0===this.itemCount_&&(this.topInput_=this.appendDummyInput("EMPTY").appendField(p(),"PLUS").appendField("add argument"))},updateMinus_:function(){const e=this.getField("MINUS");!e&&this.itemCount_>0?this.topInput_.insertFieldAt(1,new r.FieldImage("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZlcnNpb249IjEuMSIgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0Ij48cGF0aCBkPSJNMTggMTFoLTEyYy0xLjEwNCAwLTIgLjg5Ni0yIDJzLjg5NiAyIDIgMmgxMmMxLjEwNCAwIDItLjg5NiAyLTJzLS44OTYtMi0yLTJ6IiBmaWxsPSJ3aGl0ZSIgLz48L3N2Zz4K",15,15,void 0,d),"MINUS"):e&&this.itemCount_<1&&this.topInput_.removeField("MINUS")}};r.Extensions.registerMutator("intelliblockMutator_Python",i,(function(){return this.getInput("EMPTY").insertFieldAt(0,p(),"PLUS"),this.updateShape_(1)}))}(),L("varGetProperty_Python","from","get",(e=>!e.isFunction),!1,!0),L("varDoMethod_Python","with","do",(e=>e.isFunction),!0,!0),L("varCreateObject_Python","with","create",(e=>e.isClass),!0,!0);const U=[];r.Variables.flyoutCategoryBlocks=e=>{if(U){const t=M();if(t){const n=t[1],o=U.find((e=>e.KernelCheckFunction(n.name)));return o?o.FlyoutFunction(e):[]}return[]}return[]},U.push(new class{constructor(e,t,n){this.LanguageName=e,this.KernelCheckFunction=t,this.FlyoutFunction=n}}("Python",(e=>e.toLocaleLowerCase().indexOf("python")>=0),(function(e){const t=e.getVariablesOfType(""),n=[],o=document.createElement("button");if(o.setAttribute("text","%{BKY_NEW_VARIABLE}"),o.setAttribute("callbackKey","CREATE_VARIABLE"),e.registerButtonCallback("CREATE_VARIABLE",(function(e){r.Variables.createVariableButtonHandler(e.getTargetWorkspace())})),n.push(o),0<t.length){const e=t[t.length-1];if(r.Blocks.variables_set){const t=r.utils.xml.createElement("block");t.setAttribute("type","variables_set"),t.setAttribute("gap",r.Blocks.math_change?"8":"24"),t.appendChild(r.Variables.generateVariableFieldDom(e)),n.push(t)}if(r.Blocks.math_change){const t=r.utils.xml.createElement("block");t.setAttribute("type","math_change"),t.setAttribute("gap",r.Blocks.math_change?"20":"8"),t.appendChild(r.Variables.generateVariableFieldDom(e));const o=r.utils.xml.textToDom("<value name='DELTA'><shadow type='math_number'><field name='NUM'>1</field></shadow></value>");t.appendChild(o),n.push(t)}if(r.Blocks.varGetProperty_Python){const t=r.utils.xml.createElement("block");t.setAttribute("type","varGetProperty_Python"),t.setAttribute("gap",r.Blocks.varGetPropertyPython?"20":"8"),t.appendChild(r.Variables.generateVariableFieldDom(e)),n.push(t)}if(r.Blocks.varDoMethod_Python){const t=r.utils.xml.createElement("block");t.setAttribute("type","varDoMethod_Python"),t.setAttribute("gap",r.Blocks.varDoMethodPython?"20":"8"),t.appendChild(r.Variables.generateVariableFieldDom(e)),n.push(t)}if(r.Blocks.varCreateObject_Python){const t=r.utils.xml.createElement("block");t.setAttribute("type","varCreateObject_Python"),t.setAttribute("gap",r.Blocks.varCreateObjectPython?"20":"8"),t.appendChild(r.Variables.generateVariableFieldDom(e)),n.push(t)}if(r.Blocks.variables_get){let e=0;for(;e<t.length;){const o=t[e],l=r.utils.xml.createElement("block");l.setAttribute("type","variables_get"),l.setAttribute("gap","8"),l.appendChild(r.Variables.generateVariableFieldDom(o)),n.push(l),e++}}}return n}))),n(1499);var G=n(3808),V=n(455);function W(e,t){return{schema:"jle050824",name:e,payload:t}}let j,H,X;function Y(e){if(window.location.href.includes("olney.ai")&&(j=null!=j?j:"https://logging2.olney.ai/datawhys/log"),j){let i=window.location.href;H?i=H:(X||(l=i,X=(0,V.SHA256)(l).toString(V.enc.Hex)),i=X),window.fetch(j,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:i,json:btoa(JSON.stringify((t=e,0===(null===(o=null===(n=null==t?void 0:t.object)||void 0===n?void 0:n.element)||void 0===o?void 0:o.toString().indexOf("drag"))&&(t.object.newValue=void 0,t.object.oldValue=void 0),t)))})}).then((e=>{e.ok||console.log(e.statusText)}))}var t,n,o,l}r.setLocale(G);class z extends a.Widget{constructor(e){super(),this.onResize=e=>{let t=e.width,n=e.width;const o=document.getElementById("blocklyDivPython"),l=document.getElementById("buttonDivPython"),i=e.height-30;o.setAttribute("style","width: "+(t=e.width,t.toString()+"px; height: ")+i.toString()+"px"),l.setAttribute("style","position: absolute; top: "+i.toString()+"px; left: 0px; width: "+(n=e.width,n.toString()+"px; height: 30px")),r.svgResize(Z(this))},this.notebooks=e,this.generator=c.pythonGenerator,this.notebooks.activeCellChanged.connect(ie(this),this),function(e){x=e}(this.notebooks),this.div=document.createElement("div"),this.div.id="blocklyDivPython",this.node.appendChild(this.div);const t=document.createElement("div");t.id="buttonDivPython";const n=document.createElement("button");n.innerText="Blocks to Code",t.appendChild(n),n.addEventListener("click",(e=>{se(this)}));const o=document.createElement("button");o.innerText="Code to Blocks",o.addEventListener("click",(e=>{re(this)})),t.appendChild(o);const l=document.createElement("button");l.innerText="Report Bug",l.addEventListener("click",(e=>{const t=window.open("https://github.com/aolney/jupyterlab-blockly-python-extension/issues","_blank");t&&t.focus()})),t.appendChild(l);const i=document.createElement("input");i.setAttribute("type","checkbox"),i.checked=!0,i.id="syncCheckboxPython";const a=document.createElement("label");a.innerText="Notebook Sync",a.setAttribute("for","syncCheckboxPython"),t.appendChild(i),t.appendChild(a),this.node.appendChild(t),this["blocksRendered@"]=!1,this["notHooked@"]=!0,this["init@34"]=1}onAfterAttach(){const e=this;K(e,r.inject("blocklyDivPython",{toolbox:'<xml xmlns="https://developers.google.com/blockly/xml" id="toolbox" style="display: none">\n    <category name="IMPORT" colour="255">\n      <block type="importAs_Python"></block>\n      <block type="importFrom_Python"></block>\n    </category>\n    <category name="FREESTYLE" colour="290">\n      <block type="dummyOutputCodeBlock_Python"></block>\n      <block type="dummyNoOutputCodeBlock_Python"></block>\n      <block type="valueOutputCodeBlock_Python"></block>\n      <block type="valueNoOutputCodeBlock_Python"></block>\n    </category>\n    <category name="COMMENT" colour="%{BKY_COLOUR_HUE}">\n      <block type="dummyOutputCommentBlock_Python"></block>\n      <block type="dummyNoOutputCommentBlock_Python"></block>\n      <block type="valueOutputCommentBlock_Python"></block>\n      <block type="valueNoOutputCommentBlock_Python"></block>\n    </category>\n    <category name="LOGIC" colour="%{BKY_LOGIC_HUE}">\n      <block type="controls_if"></block>\n      <block type="logic_compare"></block>\n      <block type="logic_operation"></block>\n      <block type="logic_negate"></block>\n      <block type="logic_boolean"></block>\n      <block type="logic_null"></block>\n      <block type="logic_ternary"></block>\n    </category>\n    <category name="LOOPS" colour="%{BKY_LOOPS_HUE}">\n      <block type="controls_repeat_ext">\n        <value name="TIMES">\n          <shadow type="math_number">\n            <field name="NUM">10</field>\n          </shadow>\n        </value>\n      </block>\n      <block type="controls_whileUntil"></block>\n      <block type="controls_for">\n        <value name="FROM">\n          <shadow type="math_number">\n            <field name="NUM">1</field>\n          </shadow>\n        </value>\n        <value name="TO">\n          <shadow type="math_number">\n            <field name="NUM">10</field>\n          </shadow>\n        </value>\n        <value name="BY">\n          <shadow type="math_number">\n            <field name="NUM">1</field>\n          </shadow>\n        </value>\n      </block>\n      <block type="comprehensionForEach_Python"></block>\n      <block type="controls_forEach"></block>\n      <block type="controls_flow_statements"></block>\n    </category>\n    <category name="MATH" colour="%{BKY_MATH_HUE}">\n      <block type="math_number">\n        <field name="NUM">123</field>\n      </block>\n      <block type="math_arithmetic">\n        <value name="A">\n          <shadow type="math_number">\n            <field name="NUM">1</field>\n          </shadow>\n        </value>\n        <value name="B">\n          <shadow type="math_number">\n            <field name="NUM">1</field>\n          </shadow>\n        </value>\n      </block>\n      <block type="math_single">\n        <value name="NUM">\n          <shadow type="math_number">\n            <field name="NUM">9</field>\n          </shadow>\n        </value>\n      </block>\n      <block type="math_trig">\n        <value name="NUM">\n          <shadow type="math_number">\n            <field name="NUM">45</field>\n          </shadow>\n        </value>\n      </block>\n      <block type="math_constant"></block>\n      <block type="math_number_property">\n        <value name="NUMBER_TO_CHECK">\n          <shadow type="math_number">\n            <field name="NUM">0</field>\n          </shadow>\n        </value>\n      </block>\n      <block type="math_round">\n        <value name="NUM">\n          <shadow type="math_number">\n            <field name="NUM">3.1</field>\n          </shadow>\n        </value>\n      </block>\n      <block type="math_on_list"></block>\n      <block type="math_modulo">\n        <value name="DIVIDEND">\n          <shadow type="math_number">\n            <field name="NUM">64</field>\n          </shadow>\n        </value>\n        <value name="DIVISOR">\n          <shadow type="math_number">\n            <field name="NUM">10</field>\n          </shadow>\n        </value>\n      </block>\n      <block type="math_constrain">\n        <value name="VALUE">\n          <shadow type="math_number">\n            <field name="NUM">50</field>\n          </shadow>\n        </value>\n        <value name="LOW">\n          <shadow type="math_number">\n            <field name="NUM">1</field>\n          </shadow>\n        </value>\n        <value name="HIGH">\n          <shadow type="math_number">\n            <field name="NUM">100</field>\n          </shadow>\n        </value>\n      </block>\n      <block type="math_random_int">\n        <value name="FROM">\n          <shadow type="math_number">\n            <field name="NUM">1</field>\n          </shadow>\n        </value>\n        <value name="TO">\n          <shadow type="math_number">\n            <field name="NUM">100</field>\n          </shadow>\n        </value>\n      </block>\n      <block type="math_random_float"></block>\n      <block type="math_atan2">\n        <value name="X">\n          <shadow type="math_number">\n            <field name="NUM">1</field>\n          </shadow>\n        </value>\n        <value name="Y">\n          <shadow type="math_number">\n            <field name="NUM">1</field>\n          </shadow>\n        </value>\n      </block>\n    </category>\n    <category name="TEXT" colour="%{BKY_TEXTS_HUE}">\n      <block type="text"></block>\n      <block type="text_join"></block>\n      <block type="text_append">\n        <value name="TEXT">\n          <shadow type="text"></shadow>\n        </value>\n      </block>\n      <block type="text_length">\n        <value name="VALUE">\n          <shadow type="text">\n            <field name="TEXT">abc</field>\n          </shadow>\n        </value>\n      </block>\n      <block type="text_isEmpty">\n        <value name="VALUE">\n          <shadow type="text">\n            <field name="TEXT"></field>\n          </shadow>\n        </value>\n      </block>\n      <block type="text_indexOf">\n        <value name="VALUE">\n          <block type="variables_get">\n            <field name="VAR">{textVariable}</field>\n          </block>\n        </value>\n        <value name="FIND">\n          <shadow type="text">\n            <field name="TEXT">abc</field>\n          </shadow>\n        </value>\n      </block>\n      <block type="text_charAt">\n        <value name="VALUE">\n          <block type="variables_get">\n            <field name="VAR">{textVariable}</field>\n          </block>\n        </value>\n      </block>\n      <block type="text_getSubstring">\n        <value name="STRING">\n          <block type="variables_get">\n            <field name="VAR">{textVariable}</field>\n          </block>\n        </value>\n      </block>\n      <block type="text_changeCase">\n        <value name="TEXT">\n          <shadow type="text">\n            <field name="TEXT">abc</field>\n          </shadow>\n        </value>\n      </block>\n      <block type="text_trim">\n        <value name="TEXT">\n          <shadow type="text">\n            <field name="TEXT">abc</field>\n          </shadow>\n        </value>\n      </block>\n      <block type="text_print">\n        <value name="TEXT">\n          <shadow type="text">\n            <field name="TEXT">abc</field>\n          </shadow>\n        </value>\n      </block>\n      <block type="text_prompt_ext">\n        <value name="TEXT">\n          <shadow type="text">\n            <field name="TEXT">abc</field>\n          </shadow>\n        </value>\n      </block>\n      \x3c!-- <block type="getInput">\n        <value name="x">\n          <shadow type="text">\n            <field name="TEXT">The prompt shown to the user</field>\n          </shadow>\n        </value>\n      </block> --\x3e\n    </category>\n    <category name="LISTS" colour="%{BKY_LISTS_HUE}">\n      <block type="lists_create_with">\n        <mutation items="0"></mutation>\n      </block>\n      <block type="lists_create_with"></block>\n      <block type="lists_repeat">\n        <value name="NUM">\n          <shadow type="math_number">\n            <field name="NUM">5</field>\n          </shadow>\n        </value>\n      </block>\n      <block type="lists_length"></block>\n      <block type="lists_isEmpty"></block>\n      <block type="lists_indexOf">\n        <value name="VALUE">\n          <block type="variables_get">\n            <field name="VAR">{listVariable}</field>\n          </block>\n        </value>\n      </block>\n      <block type="lists_getIndex">\n        <value name="VALUE">\n          <block type="variables_get">\n            <field name="VAR">{listVariable}</field>\n          </block>\n        </value>\n      </block>\n      <block type="lists_setIndex">\n        <value name="LIST">\n          <block type="variables_get">\n            <field name="VAR">{listVariable}</field>\n          </block>\n        </value>\n      </block>\n      <block type="lists_getSublist">\n        <value name="LIST">\n          <block type="variables_get">\n            <field name="VAR">{listVariable}</field>\n          </block>\n        </value>\n      </block>\n      <block type="indexer_Python"></block>\n      <block type="lists_split">\n        <value name="DELIM">\n          <shadow type="text">\n            <field name="TEXT">,</field>\n          </shadow>\n        </value>\n      </block>\n      <block type="lists_sort"></block>\n      <block type="setBlock_Python"></block>\n      <block type="sortedBlock_Python"></block>\n      <block type="zipBlock_Python"></block>\n      <block type="dictBlock_Python"></block>\n      <block type="listBlock_Python"></block>\n      <block type="tupleBlock_Python"></block>\n      <block type="tupleConstructorBlock_Python"></block>\n      <block type="reversedBlock_Python"></block>\n    <block type="selector_train_test_split">\n      </block>\n    <block type="train_test_split">\n      </block>\n        </category>\n    <category name="COLOUR" colour="%{BKY_COLOUR_HUE}">\n      <block type="colour_picker"></block>\n      <block type="colour_random"></block>\n      <block type="colour_rgb">\n        <value name="RED">\n          <shadow type="math_number">\n            <field name="NUM">100</field>\n          </shadow>\n        </value>\n        <value name="GREEN">\n          <shadow type="math_number">\n            <field name="NUM">50</field>\n          </shadow>\n        </value>\n        <value name="BLUE">\n          <shadow type="math_number">\n            <field name="NUM">0</field>\n          </shadow>\n        </value>\n      </block>\n      <block type="colour_blend">\n        <value name="COLOUR1">\n          <shadow type="colour_picker">\n            <field name="COLOUR">#ff0000</field>\n          </shadow>\n        </value>\n        <value name="COLOUR2">\n          <shadow type="colour_picker">\n            <field name="COLOUR">#3333ff</field>\n          </shadow>\n        </value>\n        <value name="RATIO">\n          <shadow type="math_number">\n            <field name="NUM">0.5</field>\n          </shadow>\n        </value>\n      </block>Conversion\n    </category>\n    <category name="CONVERSION" colour="120">\n      <block type="boolConversion_Python">\n      </block>\n      <block type="intConversion_Python">\n      </block>\n      <block type="floatConversion_Python">\n      </block>\n      <block type="strConversion_Python">\n      </category>\n    <category name="I/O" colour="190">\n      <block type="withAs_Python">\n      </block>\n      <block type="textFromFile_Python">\n        <value name="FILENAME">\n          <shadow type="text">\n            <field name="TEXT">name of file</field>\n          </shadow>\n        </value>\n      </block>\n      <block type="openReadFile_Python">\n              <value name="FILENAME">\n          <shadow type="text">\n            <field name="TEXT">name of file</field>\n          </shadow>\n        </value>\n      </block>\n      <block type="openWriteFile_Python">\n              <value name="FILENAME">\n          <shadow type="text">\n            <field name="TEXT">name of file</field>\n          </shadow>\n        </value>\n      </block>\n    </category>\n    <sep></sep>\n    <category name="VARIABLES" colour="%{BKY_VARIABLES_HUE}" custom="VARIABLE"></category>\n    <category name="FUNCTIONS" colour="%{BKY_PROCEDURES_HUE}" custom="PROCEDURE"></category>\n  </xml>'})),console.log("jupyterlab_blockly_extension_python: blockly palette initialized");const t=t=>{"create"===t.type&&$(e,!1),"finished_loading"===t.type&&$(e,!0),Y({schema:"ble050824",name:t.type,object:t.toJson()})};Z(e).removeChangeListener(t),Z(e).addChangeListener(t)}}function K(e,t){e["workspace@"]=t}function Z(e){return e["workspace@"]}function J(e){return e.notebooks}function q(e){return new z(e)}function $(e,t){e["blocksRendered@"]=t}function Q(e){return e["blocksRendered@"]}function ee(e){return e["notHooked@"]}function te(e,t){e["notHooked@"]=t}function ne(e){return e["lastCell@"]}function oe(e,t){e["lastCell@"]=t}function le(e){return(e,t)=>{if(e.name.indexOf("python")>=0)switch(t.header.msg_type.toString()){case"execute_input":console.log("jupyterlab_blockly_extension_python: kernel executed code, updating intellisense"),Y(W("execute-code",t.content)),P();break;case"error":Y(W("execute-code-error",t.content))}return!0}}function ie(e){return(t,n)=>{if(n){Y(W("active-cell-change",{cell_text:n.node.outerText}));const t=document.getElementById("syncCheckboxPython"),o=document.getElementById("autosaveCheckboxPython"),l=e=>!!e&&e.checked;l(t)&&e.notebooks.activeCell&&(Q(e)&&null==ae(e)?ue():re(e),P()),l(o)&&e.notebooks.activeCell&&(ce(e),oe(e,n))}return!0}}function ae(e){if(e.notebooks.activeCell){const t=e.notebooks.activeCell.model.sharedModel.getSource();if(!(t.indexOf("xmlns")>=0))return null;{const e=/(<xml[\s\S]+<\/xml>)/;let n=t.match(e);if(n&&n[0])return n[0]}}return null}function se(e){let t;const n=e.generator.workspaceToCode(Z(e));e.notebooks.activeCell?(t=e.notebooks.activeCell.model,i.isMarkdownCellModel(t)?window.alert("You are calling 'Blocks to Code' on a MARKDOWN cell. Select an empty CODE cell and try again."):(e.notebooks.activeCell.model.sharedModel.setSource(n+"\n#"+f()),console.log("jupyterlab_blockly_extension_python: wrote to active cell\n"+n+"\n"),Y(W("blocks-to-code",{code:e.notebooks.activeCell.model.toJSON().source.toString()})),$(e,!0))):console.log("jupyterlab_blockly_extension_python: no cell active, flushed\n"+n+"\n")}function re(e){if(e.notebooks.activeCell){const t=/(<xml[\s\S]+<\/xml>)/;let n=e.notebooks.activeCell.model.sharedModel.getSource().match(t);try{if(n&&n[1]){const e=n[1];ue(),function(e){const t=(new DOMParser).parseFromString(e,"application/xml").documentElement;r.Xml.domToWorkspace(t,r.getMainWorkspace())}(e),Y(W("xml-to-blocks",{xml:e}))}}catch(e){window.alert("Unable to perform 'Code to Blocks': XML is either invald or renames existing variables. Specific error message is: "+e.message),console.log("jupyterlab_blockly_extension_python: unable to decode blocks, last line is invald xml")}}else console.log("jupyterlab_blockly_extension_python: unable to decode blocks, active cell is null")}function ce(e){let t;const n=e.generator.workspaceToCode(Z(e));ne(e)?ne(e).model&&(t=ne(e).model,i.isCodeCellModel(t)&&(()=>{try{const t=ne(e).model.sharedModel.getSource();if(t.indexOf("xmlns")>=0){const e=/(<xml[\s\S]+<\/xml>)/;let n=t.match(e);if(n&&n[0])return n[0]}}catch(e){return!1}})())&&Z(e).getAllBlocks(!1).length>0&&(ne(e).model.sharedModel.setSource(n+"\n#"+f()),console.log("jupyterlab_blockly_extension_python: wrote to active cell\n"+n+"\n"),e.notebooks.activeCell&&Y(W("blocks-to-code-autosave",e.notebooks.activeCell.model.toJSON()))):console.log("jupyterlab_blockly_extension_python: no cell active, flushed instead of autosave\n"+n+"\n")}function ue(e){const t=r.getMainWorkspace().getAllBlocks(!1);for(let e=0;e<t.length;e++)t[e].dispose(!1)}function de(e,t,n){if(!n.isAttached){const o=t.currentWidget;if(null==o)e.shell.add(n,"main");else{const e=o,t={ref:e.id,mode:"split-left"};e.context.addSibling(n,t)}}e.shell.activateById(n.id)}function pe(e){const t=new l.MainAreaWidget({content:e});return t.id="blockly-jupyterlab-python",t.title.label="Blockly Python",t.title.closable=!0,t}function he(e,t){var n;const o=this;if(ee(o)){const t=null===(n=e.session)||void 0===n?void 0:n.kernel;if(null==t||null==t);else{const e=t;e.name.indexOf("python")>=0&&(e.iopubMessage.connect(le(),o),console.log("jupyterlab_blockly_extension_python: Listening for kernel messages"),te(o,!1))}return!0}return!1}function me(e,t){const n=this,o=e.currentWidget;if(null==o);else{const e=o;console.log("jupyterlab_blockly_extension_python: notebook changed to "+e.context.path),Y(W("notebook-changed",{path:e.context.path})),e.sessionContext.kernelChanged.connect(he,n)}return!0}function ye(e,t){return null==e.currentWidget||(console.log("jupyterlab_blockly_extension_python: notebook changed, autorunning blockly python command"),this.commands.execute("blockly_python:open")),!0}const be={id:"jupyterlab-apod",description:"blockly python extension for jupyter lab.",autoStart:!0,requires:[l.ICommandPalette,s.INotebookTracker,o.ILayoutRestorer],activate:async function(e,t,n,o,i){console.log("jupyterlab_blockly_extension_python: extension is activated!");const a=q(n);let s=pe(a);const r=new l.WidgetTracker({namespace:"blockly_python"});o&&o.restore(r,{command:"blockly_python:open",name:()=>"blockly_python"}),n.currentChanged.connect(me,a),e.commands.addCommand("blockly_python:open",{label:"Blockly Python",execute:()=>{s&&!s.isDisposed||(s=pe(a)),de(e,n,s),r.has(s)||r.add(s)}}),t.addItem({command:"blockly_python:open",category:"Blockly"});const c=new URLSearchParams(window.location.search);"py"===c.get("bl")&&(console.log("jupyterlab_blockly_extension_python: openning blockly, bl=py"),e.restored.then((()=>{n.currentChanged.connect(ye,e),s.title.closable=!1})));let u=c.get("id");u&&(function(e){H=e}(u),console.log("jupyterlab_blockly_extension_py: using id="+u+" for logging"));let d=c.get("log");d&&(j=d,console.log("jupyterlab_blockly_extension_py: using log="+d+" for logging"))}}}}]);