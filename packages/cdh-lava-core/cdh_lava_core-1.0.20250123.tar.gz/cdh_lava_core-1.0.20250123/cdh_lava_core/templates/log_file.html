<!DOCTYPE html>
<html>

<head>
  <title>CDC Data Hub LAVA Log File</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <style>
    .table-theme-blue thead th {
      background-color: #006778;
      color: white;
    }

    .back-button {
      display: inline-block;
      padding: 10px 20px;
      background-color: #ccc;
      color: #333;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
  </style>

  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" .back-button {
    display: inline-block; padding: 10px 20px; background-color: #ccc; color: #333; border: none; border-radius: 4px;
    cursor: pointer; } />
  <!-- DataTables CSS -->
  <link rel="stylesheet" href="https://cdn.datatables.net/1.10.23/css/dataTables.bootstrap4.min.css" />
  <!-- jQuery, DataTables JS, Bootstrap JS -->
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
  <script src="https://cdn.datatables.net/1.10.23/js/jquery.dataTables.min.js"></script>
  <script src="https://cdn.datatables.net/1.10.23/js/dataTables.bootstrap4.min.js"></script>
  <!-- DataTables initialization -->
  <script>
    $(document).ready(function () {
      var table = $("#logTable").DataTable({ order: [[0, "desc"]] });

      // Add a filter for log level
      $("#logLevelFilter").on("change", function () {
        table.column(5).search($(this).val()).draw();
      });
    });

    function goBack() {
      window.history.back();
    }
  </script>
</head>

<body>
  <div class="container">
    <h2 class="mt-4">Log File</h2>

    <div>
      <p>
        <button class="back-button" onclick="goBack()">Back</button>
      </p>
    </div>
    <!-- Filter for log level -->
    <div class="form-group">
      <label for="logLevelFilter">Filter by Log Level:</label>
      <select id="logLevelFilter" class="form-control">
        <option value="">All</option>
        <option value="INFO">INFO</option>
        <option value="WARNING">WARNING</option>
        <option value="ERROR">ERROR</option>
      </select>
    </div>

    <table id="logTable" class="table table-striped table-theme-blue">
      <thead>
        <tr>
          <th scope="col">Date</th>
          <th scope="col">Service</th>
          <th scope="col">Module</th>
          <th scope="col">Line Number</th>
          <th scope="col">Level</th>
          <th scope="col">Message</th>
        </tr>
      </thead>
      <tbody>
        {% for entry in entries %}
        <tr>
          <td>{{ entry[0] if entry|length > 0 else 'N/A'}}</td>
          <td>{{ entry[1] if entry|length > 1 else 'N/A'}}</td>
          <td>{{ entry[2] if entry|length > 2 else 'N/A'}}</td>
          <td>{{ entry[3] if entry|length > 3 else 'N/A'}}</td>
          <td>{{ entry[4] if entry|length > 4 else 'N/A'}}</td>
          <td class="text-{{ entry[4].lower() if entry|length > 4 else 'info'}}">
            {{ entry[5] if entry|length > 5 else 'N/A'}}
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</body>

</html>