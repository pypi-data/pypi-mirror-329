"use strict";(self.webpackChunk_datalayer_ui=self.webpackChunk_datalayer_ui||[]).push([[728],{70728:(e,t,n)=>{n.d(t,{g:()=>ve});var o=n(18683),r=n(75987),s=n(63711),i=n(11796),a=n(98238),c=n(98754),l=n(9387),d=n(45222),h=n(18241),u=n(74354),_=n(17402),p=function(e,t){return p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},p(e,t)};function m(e,t){function n(){this.constructor=e}p(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function f(e){return"function"==typeof e}var g=!1,b={Promise:void 0,set useDeprecatedSynchronousErrorHandling(e){e&&(new Error).stack,g=e},get useDeprecatedSynchronousErrorHandling(){return g}};function y(e){setTimeout((function(){throw e}),0)}var w={closed:!0,next:function(e){},error:function(e){if(b.useDeprecatedSynchronousErrorHandling)throw e;y(e)},complete:function(){}},x=function(){return Array.isArray||function(e){return e&&"number"==typeof e.length}}(),v=function(){function e(e){return Error.call(this),this.message=e?e.length+" errors occurred during unsubscription:\n"+e.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=e,this}return e.prototype=Object.create(Error.prototype),e}(),k=function(){function e(e){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,e&&(this._ctorUnsubscribe=!0,this._unsubscribe=e)}return e.prototype.unsubscribe=function(){var t;if(!this.closed){var n,o=this,r=o._parentOrParents,s=o._ctorUnsubscribe,i=o._unsubscribe,a=o._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,r instanceof e)r.remove(this);else if(null!==r)for(var c=0;c<r.length;++c)r[c].remove(this);if(f(i)){s&&(this._unsubscribe=void 0);try{i.call(this)}catch(e){t=e instanceof v?C(e.errors):[e]}}if(x(a)){c=-1;for(var l=a.length;++c<l;){var d=a[c];if(null!==(n=d)&&"object"==typeof n)try{d.unsubscribe()}catch(e){t=t||[],e instanceof v?t=t.concat(C(e.errors)):t.push(e)}}}if(t)throw new v(t)}},e.prototype.add=function(t){var n=t;if(!t)return e.EMPTY;switch(typeof t){case"function":n=new e(t);case"object":if(n===this||n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if(!(n instanceof e)){var o=n;(n=new e)._subscriptions=[o]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}var r=n._parentOrParents;if(null===r)n._parentOrParents=this;else if(r instanceof e){if(r===this)return n;n._parentOrParents=[r,this]}else{if(-1!==r.indexOf(this))return n;r.push(this)}var s=this._subscriptions;return null===s?this._subscriptions=[n]:s.push(n),n},e.prototype.remove=function(e){var t=this._subscriptions;if(t){var n=t.indexOf(e);-1!==n&&t.splice(n,1)}},e.EMPTY=function(e){return e.closed=!0,e}(new e),e}();function C(e){return e.reduce((function(e,t){return e.concat(t instanceof v?t.errors:t)}),[])}var S=function(){return"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}(),P=function(e){function t(n,o,r){var s=e.call(this)||this;switch(s.syncErrorValue=null,s.syncErrorThrown=!1,s.syncErrorThrowable=!1,s.isStopped=!1,arguments.length){case 0:s.destination=w;break;case 1:if(!n){s.destination=w;break}if("object"==typeof n){n instanceof t?(s.syncErrorThrowable=n.syncErrorThrowable,s.destination=n,n.add(s)):(s.syncErrorThrowable=!0,s.destination=new E(s,n));break}default:s.syncErrorThrowable=!0,s.destination=new E(s,n,o,r)}return s}return m(t,e),t.prototype[S]=function(){return this},t.create=function(e,n,o){var r=new t(e,n,o);return r.syncErrorThrowable=!1,r},t.prototype.next=function(e){this.isStopped||this._next(e)},t.prototype.error=function(e){this.isStopped||(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this))},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){this.destination.error(e),this.unsubscribe()},t.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},t.prototype._unsubscribeAndRecycle=function(){var e=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=e,this},t}(k),E=function(e){function t(t,n,o,r){var s,i=e.call(this)||this;i._parentSubscriber=t;var a=i;return f(n)?s=n:n&&(s=n.next,o=n.error,r=n.complete,n!==w&&(f((a=Object.create(n)).unsubscribe)&&i.add(a.unsubscribe.bind(a)),a.unsubscribe=i.unsubscribe.bind(i))),i._context=a,i._next=s,i._error=o,i._complete=r,i}return m(t,e),t.prototype.next=function(e){if(!this.isStopped&&this._next){var t=this._parentSubscriber;b.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}},t.prototype.error=function(e){if(!this.isStopped){var t=this._parentSubscriber,n=b.useDeprecatedSynchronousErrorHandling;if(this._error)n&&t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else if(t.syncErrorThrowable)n?(t.syncErrorValue=e,t.syncErrorThrown=!0):y(e),this.unsubscribe();else{if(this.unsubscribe(),n)throw e;y(e)}}},t.prototype.complete=function(){var e=this;if(!this.isStopped){var t=this._parentSubscriber;if(this._complete){var n=function(){return e._complete.call(e._context)};b.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,n),this.unsubscribe()):(this.__tryOrUnsub(n),this.unsubscribe())}else this.unsubscribe()}},t.prototype.__tryOrUnsub=function(e,t){try{e.call(this._context,t)}catch(e){if(this.unsubscribe(),b.useDeprecatedSynchronousErrorHandling)throw e;y(e)}},t.prototype.__tryOrSetError=function(e,t,n){if(!b.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this._context,n)}catch(t){return b.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=t,e.syncErrorThrown=!0,!0):(y(t),!0)}return!1},t.prototype._unsubscribe=function(){var e=this._parentSubscriber;this._context=null,this._parentSubscriber=null,e.unsubscribe()},t}(P),j=function(){return"function"==typeof Symbol&&Symbol.observable||"@@observable"}();function M(e){return e}var T=function(){function e(e){this._isScalar=!1,e&&(this._subscribe=e)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(e,t,n){var o=this.operator,r=function(e,t,n){if(e){if(e instanceof P)return e;if(e[S])return e[S]()}return e||t||n?new P(e,t,n):new P(w)}(e,t,n);if(o?r.add(o.call(r,this.source)):r.add(this.source||b.useDeprecatedSynchronousErrorHandling&&!r.syncErrorThrowable?this._subscribe(r):this._trySubscribe(r)),b.useDeprecatedSynchronousErrorHandling&&r.syncErrorThrowable&&(r.syncErrorThrowable=!1,r.syncErrorThrown))throw r.syncErrorValue;return r},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){b.useDeprecatedSynchronousErrorHandling&&(e.syncErrorThrown=!0,e.syncErrorValue=t),function(e){for(;e;){var t=e,n=t.closed,o=t.destination,r=t.isStopped;if(n||r)return!1;e=o&&o instanceof P?o:null}return!0}(e)?e.error(t):console.warn(t)}},e.prototype.forEach=function(e,t){var n=this;return new(t=O(t))((function(t,o){var r;r=n.subscribe((function(t){try{e(t)}catch(e){o(e),r&&r.unsubscribe()}}),o,t)}))},e.prototype._subscribe=function(e){var t=this.source;return t&&t.subscribe(e)},e.prototype[j]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 0===e.length?this:(0===(n=e).length?M:1===n.length?n[0]:function(e){return n.reduce((function(e,t){return t(e)}),e)})(this);var n},e.prototype.toPromise=function(e){var t=this;return new(e=O(e))((function(e,n){var o;t.subscribe((function(e){return o=e}),(function(e){return n(e)}),(function(){return e(o)}))}))},e.create=function(t){return new e(t)},e}();function O(e){if(e||(e=b.Promise||Promise),!e)throw new Error("no Promise impl found");return e}var R=n(50059),N=n(42968),D=n(17055),K=n(75087),I=n(60531),A=n(38921),$=n(16950),F=n(14809),U=n(14377),W=n(55047),H=n(89895),V=n(89915),L=n(53054),J=n(62097),z=n(37706),q=n(71784),B=n(89492),G=n(67004),Y=n(39756),X=n(29028),Q=n(47798),Z=n(83303),ee=n(69882),te=n(30574),ne=n(54115),oe=n(42418),re=n(62613),se=n(72490),ie=n(97164),ae=n(5190),ce=n(48319),le=n(16608),de=n(30115);"undefined"!=typeof window&&void 0!==window.define&&(window.define("@jupyter-widgets/base",oe),window.define("@jupyter-widgets/controls",de));class he extends re.FI{constructor(e){super(),this._rendermime=e;const t=document.createElement("script"),o=document.createElement("script");o.setAttribute("data-jupyter-widgets-cdn-only","true"),document.body.appendChild(o),t.src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js",document.body.appendChild(t),t.onload=()=>{window.define("@jupyter-widgets/base",oe),window.define("@jupyter-widgets/controls",de),this._registry=new ce.R,this.register({name:"@jupyter-widgets/base",version:oe.JUPYTER_WIDGETS_VERSION,exports:()=>Promise.resolve().then(n.bind(n,42418))}),this.register({name:"@jupyter-widgets/controls",version:de.JUPYTER_CONTROLS_VERSION,exports:()=>Promise.resolve().then(n.bind(n,30115))})}}callbacks(e){return{iopub:{output:e=>{this._onUnhandledIOPubMessage.emit(e)}}}}registerWithKernel(e){this._commRegistration&&this._commRegistration.dispose(),e&&e.registerCommTarget(this.comm_target_name,this._handleCommOpen)}_handleKernelChanged({oldValue:e,newValue:t}){e&&e.removeCommTarget(this.comm_target_name,this._handleCommOpen),t&&t.registerCommTarget(this.comm_target_name,this._handleCommOpen)}disconnect(){super.disconnect(),this._restoredStatus=!1}async _loadFromKernel(){if(!this.kernel)throw new Error("Kernel not set");if(!1!==this.kernel?.handleComms)return super._loadFromKernel()}async _create_comm(e,t,n,o,r){const s=this.kernel;if(!s)throw new Error("No current kernel");const i=s.createComm(e,t);return(n||o)&&i.open(n,o,r),new oe.shims.services.Comm(i)}async _get_comm_info(){const e=this.kernel;if(!e)throw new Error("No current kernel");const t=await e.requestCommInfo({target_name:this.comm_target_name});return"ok"===t.content.status?t.content.comms:{}}get isDisposed(){return this._isDisposed}dispose(){this.isDisposed||(this._isDisposed=!0,this._commRegistration&&this._commRegistration.dispose())}async resolveUrl(e){return e}async loadClass(e,t,n){"@jupyter-widgets/base"!==t&&"@jupyter-widgets/controls"!==t||!(0,ie.valid)(n)||(n=`^${n}`);let o=this._getRegistry().getAllVersions(t);const r=2===n.split(".").length?n+".0":n;if(!o){const e=await(0,ae.l)(t,r),n={name:t,version:r.replaceAll("^",""),exports:{...e}};if(this.register(n),o=this._getRegistry().getAllVersions(t),!o)throw new Error(`No version of module ${t} is registered`)}const s=this._registry.get(t,n);if(!s){const e=Object.keys(o);throw new Error(`Module ${t}, version ${n} is not registered, however,         ${e.join(",")} ${e.length>1?"are":"is"}`)}let i;i="function"==typeof s?await s():await s;const a=i[e];if(!a)throw new Error(`Class ${e} not found in module ${t}`);return a}_getRegistry(){return this._registry}get rendermime(){return this._rendermime}get restored(){return this._restored}get restoredStatus(){return this._restoredStatus}get onUnhandledIOPubMessage(){return this._onUnhandledIOPubMessage}register(e){this._registry.set(e.name,e.version,e.exports)}register_model(e,t){super.register_model(e,t),t.then((t=>{this._modelsSync.set(e,t),t.once("comm:close",(()=>{this._modelsSync.delete(e)}))}))}async clear_state(){await super.clear_state(),this._modelsSync=new Map}get_state_sync(e={}){const t=[];for(const e of this._modelsSync.values())e.comm_live&&t.push(e);return(0,re.JV)(t,e)}_handleCommOpen=async(e,t)=>{const n=new oe.shims.services.Comm(e);await this.handle_comm_open(n,t)};_restored=new se.Signal(this);_restoredStatus=!1;_kernelRestoreInProgress=!1;_isDisposed=!1;_registry=new ce.R;_rendermime;_commRegistration;_modelsSync=new Map;_onUnhandledIOPubMessage=new se.Signal(this)}class ue extends he{constructor(e,t,n){super(t),this._context=e,this._context.sessionContext.kernelChanged.connect(((e,t)=>{this._handleKernelChanged(t)})),this._context.sessionContext.statusChanged.connect(((e,t)=>{this._handleKernelStatusChange(t)})),this._context.sessionContext.connectionStatusChanged.connect(((e,t)=>{this._handleKernelConnectionStatusChange(t)})),this._context.sessionContext.session?.kernel&&this._handleKernelChanged({name:"kernel",oldValue:null,newValue:this._context.sessionContext.session?.kernel}),this.restoreWidgets(this._context.model),this._settings=n,e.saveState.connect(((e,t)=>{"started"===t&&n.saveState&&this._saveState()}))}_saveState(){const e=this.get_state_sync({drop_defaults:!0});this._context.model.setMetadata("widgets",{"application/vnd.jupyter.widget-state+json":e})}_handleKernelConnectionStatusChange(e){"connected"===e&&(this._kernelRestoreInProgress||this.restoreWidgets(this._context.model,{loadKernel:!0,loadNotebook:!1}))}_handleKernelStatusChange(e){"restarting"===e&&this.disconnect()}async restoreWidgets(e,{loadKernel:t,loadNotebook:n}={loadKernel:!0,loadNotebook:!0}){await this.context.sessionContext.ready;try{if(t)try{this._kernelRestoreInProgress=!0,await this._loadFromKernel()}finally{this._kernelRestoreInProgress=!1}n&&await this._loadFromNotebook(e),this._restoredStatus=!0,this._restored.emit()}catch(e){}}async _loadFromNotebook(e){const t=e.getMetadata("widgets");if(t&&t[le.s]){let e=t[le.s];e=this.filterExistingModelState(e),await this.set_state(e)}}dispose(){this.isDisposed||(this._context=null,super.dispose())}async resolveUrl(e){const t=await this.context.urlResolver.resolveUrl(e);return this.context.urlResolver.getDownloadUrl(t)}get context(){return this._context}get kernel(){return this._context.sessionContext?.session?.kernel??null}register_model(e,t){super.register_model(e,t),this.setDirty()}async clear_state(){await super.clear_state(),this.setDirty()}setDirty(){this._settings.saveState&&(this._context.model.dirty=!0)}_context;_settings}class _e extends F.Zk{constructor(e,t){super(),this.mimeType=e.mimeType,t&&(this.manager=t)}set manager(e){e.restored.connect(this._rerender,this),this._manager.resolve(e)}async renderModel(e){const t=e.data[this.mimeType];this.node.textContent="Loading widget...";const n=await this._manager.promise;if(""===t.model_id)return this.hide(),Promise.resolve();let o,r;try{o=await n.get_model(t.model_id)}catch(t){return n.restoredStatus?(this.node.textContent="Please run the cell to display the IPyWidgets.",this.addClass("jupyter-widgets"),void console.error(t)):void(this._rerenderMimeModel=e)}this._rerenderMimeModel=null;try{r=(await n.create_view(o)).luminoWidget}catch(e){return this.node.textContent="Error displaying widget",this.addClass("jupyter-widgets"),void console.error(e)}this.node.textContent="",this.addWidget(r),r.disposed.connect((()=>{this.hide(),t.model_id=""}))}dispose(){this.isDisposed||(this._manager=null,super.dispose())}_rerender(){this._rerenderMimeModel&&(this.node.textContent="",this.removeClass("jupyter-widgets"),this.renderModel(this._rerenderMimeModel))}mimeType;_manager=new a.PromiseDelegate;_rerenderMimeModel=null}var pe=n(94247),me=n(70639);class fe extends me.p{_nbformat;_readonly;constructor(e){super(e),this._nbformat=e.nbformat,this._readonly=e.readonly}createNew(e){if(this._nbformat){this._nbformat.cells.forEach((e=>{e.metadata.editable=!this._readonly}));const e=new i.x;return e.fromJSON(this._nbformat),e}{const t=super.createNew(e);return t.readOnly=this._readonly,t}}}var ge=n(91923),be=n(71791);class ye{_CellSidebar;_boxPanel;_commandRegistry;_contentFactory;_context;_documentRegistry;_iPyWidgetsManager;_id;_kernel;_kernelConnection;_kernelClients;_kernelTransfer;_lite;_mimeTypeService;_nbformat;_nbgrader;_notebookModelFactory;_notebookPanel;_onSessionConnection;_path;_readonly;_renderers;_rendermime;_serverless;_serviceManager;_tracker;_url;constructor(e){console.log("Creating a new Notebook Adapter."),this._CellSidebar=e.CellSidebar,this._id=e.id,this._kernel=e.kernel,this._kernelClients=e.kernelClients,this._lite=e.lite,this._nbformat=e.nbformat,this._nbgrader=e.nbgrader,this._path=e.path,this._readonly=e.readonly,this._renderers=e.renderers,this._serverless=e.serverless,this._serviceManager=e.serviceManager,this._url=e.url,this._kernelTransfer=e.kernelTransfer,this._onSessionConnection=e.onSessionConnection,this._boxPanel=new F.e6,this._boxPanel.addClass("dla-Jupyter-Notebook"),this._boxPanel.spacing=0,this._commandRegistry=new $.J,e.url?this.loadFromUrl(e.url).then((e=>{this._nbformat=e,this.setupAdapter()})):this.setupAdapter()}async loadFromUrl(e){return fetch(e).then((e=>e.text())).then((e=>JSON.parse(e)))}notebookKeydownListener=e=>{this._commandRegistry?.processKeydownEvent(e)};setupCompleter(e){const t=e.content.activeCell&&e.content.activeCell.editor,n=e.context.sessionContext,o=new J.X,r=new z.A({editor:t,model:o}),s=new q.G,i=new B.C({context:{widget:e,editor:t,session:n.session},providers:[s],timeout:1e3}),a=new G.$({completer:r,reconciliator:i});return n.ready.then((()=>{const e=new q.G,o=new B.C({context:{widget:this._notebookPanel,editor:t,session:n.session},providers:[e],timeout:1e3});a.reconciliator=o})),a.editor=t,e.content.activeCellChanged.connect(((e,t)=>{t&&t.ready.then((()=>{a.editor=t&&t.editor}))})),r.hide(),F.x0.attach(r,document.body),a}initializeContext(){const e=void 0===this._path||""===this._path;this._context=new U.o({manager:this._serviceManager,factory:this._notebookModelFactory,path:this._path??".datalayer/ping.ipynb",kernelPreference:{id:this._kernel?.id,shouldStart:!1,canStart:!1,autoStartDefault:!1,shutdownOnDispose:!1}}),this._iPyWidgetsManager=new ue(this._context,this._rendermime,{saveState:!1});const t={safe:!0,mimeTypes:[ne.a],defaultRank:1,createRenderer:e=>new _e(e,this._iPyWidgetsManager)};if(this._rendermime.addFactory(t,1),this._kernelClients?.map((e=>{this._iPyWidgetsManager?.registerWithKernel(e)})),this._context.sessionContext._initialize=async()=>{const e=this._context.sessionContext.sessionManager;await e.ready,await e.refreshRunning();const t=(0,A.I6)(e.running(),(e=>e.kernel?.id===this._kernel?.id));if(t)try{const n=e.connectTo({model:{...t,path:this._path??t.path,name:this._path??t.name},kernelConnectionOptions:{handleComms:!0}});this._context.sessionContext._handleNewSession(n),this._kernel?.connection?.dispose()}catch(e){return this._context.sessionContext._handleSessionError(e),Promise.reject(e)}return await this._context.sessionContext._startIfNecessary()},e&&(this._context._populate=async()=>{if(this._context._isPopulated=!0,this._context._isReady=!0,this._context._populatedPromise.resolve(void 0),this._context.isDisposed)return;const e=this._context._model.defaultKernelName||this._context.sessionContext.kernelPreference.name;this._context.sessionContext.kernelPreference={...this._context.sessionContext.kernelPreference,name:e,language:this._context._model.defaultKernelLanguage},this._context.sessionContext.initialize().then((e=>{e&&this._context._dialogs.selectKernel(this._context.sessionContext.sessionContext)}))},this._context.initialize=async e=>{this._context.model.dirty=!1;const t=(new Date).toISOString(),n={path:this._id,name:this._id,type:"notebook",content:void 0,writable:!0,created:t,last_modified:t,mimetype:"application/x-ipynb+json",format:"json"};this._context._updateContentsModel(n),await this._context._populate(),this._context.model.sharedModel.clearUndoHistory()}),this._context.sessionContext.sessionChanged.connect(((e,t)=>{const n=t.newValue;console.log("Current Jupyter Session Connection.",n),this._onSessionConnection&&n&&(this._onSessionConnection(n),this._iPyWidgetsManager?.registerWithKernel(n.kernel),this._iPyWidgetsManager?.restoreWidgets(this._notebookPanel?.model))})),this._context.sessionContext.kernelChanged.connect(((e,t)=>{const n=t.newValue;this._kernelConnection=n,console.log("Current Jupyter Kernel Connection.",n),n&&!n.handleComms&&(console.log("Updating the current Kernel Connection to enforce Comms support.",n.handleComms),n.handleComms=!0)})),this._context.sessionContext.ready.then((()=>{this._onSessionConnection&&this._onSessionConnection(this._context?.sessionContext.session??void 0);const e=this._context?.sessionContext.session?.kernel;this._kernelConnection=e,this._kernelTransfer&&e&&e.connectionStatusChanged.connect(((t,n)=>{"connected"===n&&this._kernelTransfer.transfer(e)}))})),!this._notebookPanel){const e=this._documentRegistry?.getWidgetFactory("Notebook");this._notebookPanel=e?.createNew(this._context)}const n=this.setupCompleter(this._notebookPanel);if(!this._readonly)try{(0,be.VV)(this._commandRegistry,n,this._tracker,this._path)}catch{}this._boxPanel.addWidget(this._notebookPanel),F.e6.setStretch(this._notebookPanel,0),window.addEventListener("resize",(()=>{this._notebookPanel?.update()})),this._context.initialize(e).then((()=>{e&&this._notebookPanel?.model?.fromJSON(this._nbformat)}))}setupAdapter(){document.addEventListener("keydown",this.notebookKeydownListener,!0);const e=V.dn.filter((e=>"text/javascript"!==e.mimeTypes[0]));e.push(Z.rendererFactory),e.push(ee.rendererFactory),this._renderers.map((t=>e.push(t)));const t=new H.T9;for(const e of H.T9.getDefaultLanguages())t.addLanguage(e);t.addLanguage({name:"ipythongfm",mime:"text/x-ipythongfm",load:async()=>(await Promise.all([n.e(6636),n.e(9946),n.e(2899),n.e(5949)]).then(n.bind(n,15949))).markdown({codeLanguages:e=>t.findBest(e)})}),this._rendermime=new L.K({initialFactories:e,latexTypesetter:new te.p,markdownParser:(0,ge.H)(t)}),this._documentRegistry=new W.p({}),this._mimeTypeService=new H.mN(t);const o=new H.k8;for(const e of H.k8.getDefaultThemes())o.addTheme(e);const r=new H.Ez({extensions:(()=>{const e=new H.AG;for(const t of H.AG.getDefaultExtensions({themes:o}))e.addExtension(t);return e.addExtension({name:"shared-model-binding",factory:e=>{const t=e.model.sharedModel;return H.AG.createImmutableExtension((0,H.rX)({ytext:t.ysource,undoManager:t.undoManager??void 0}))}}),e})(),languages:t}),s={factoryService:r,mimeTypeService:this._mimeTypeService},i=s.factoryService.newInlineEditor;this._contentFactory=new pe.KQ(this._id,this._nbgrader,this._commandRegistry,{editorFactory:i},this._CellSidebar),this._tracker=new Y.G({namespace:this._id});const a=new X.k({name:"Notebook",label:"Notebook",modelName:"notebook",fileTypes:["notebook"],defaultFor:["notebook"],preferKernel:!0,autoStartDefault:!1,canStartKernel:!1,shutdownOnClose:!1,rendermime:this._rendermime,contentFactory:this._contentFactory,mimeTypeService:s.mimeTypeService,notebookConfig:{...Q.a.defaultNotebookConfig,recordTiming:!0}});a.widgetCreated.connect(((e,t)=>{t.context.pathChanged.connect((()=>{this._tracker?.save(t)})),this._tracker?.add(t)})),this._documentRegistry.addWidgetFactory(a),this._notebookModelFactory=new fe({nbformat:this._nbformat,readonly:this._readonly}),this._documentRegistry.addModelFactory(this._notebookModelFactory),this.initializeContext()}get id(){return this._id}get readonly(){return this._readonly}get serverless(){return this._serverless}get lite(){return this._lite}get path(){return this._path}get url(){return this._url}get nbformat(){return this._nbformat}get kernel(){return this._kernel}get kernelConnection(){return this._kernelConnection}get notebookPanel(){return this._notebookPanel}get context(){return this._context}set notebookPanel(e){this._notebookPanel=e}get panel(){return this._boxPanel}get commands(){return this._commandRegistry}get serviceManager(){return this._serviceManager}setNbformat(e){if(!e)throw new Error("The nbformat should first be set via the constructor of NotebookAdapter");this._nbformat!==e&&(this._nbformat=e,this._notebookPanel?.model?.fromJSON(e))}setServiceManager(e,t){this._lite=t,this._serviceManager=e,this._nbformat=this._notebookPanel?.model?.toJSON()}setKernel(e){this._kernel!==e&&(this._kernel=e,this.initializeContext())}setReadonly(e){this._readonly!==e&&(this._readonly=e,this._notebookPanel?.content.widgets.forEach((t=>{t.syncEditable=!0,t.model.sharedModel.setMetadata("editable",!e)})),Array.from(this._context?.model.cells).forEach((t=>{t.setMetadata("editable",!e)})),this._notebookPanel?.content.widgets.forEach((e=>{e.saveEditableState()})))}setServerless(e){this._serverless!==e&&(this._serverless=e)}setPath(e){this._path!==e&&(this._path=e,this.initializeContext())}assignKernel(e){this._kernel=e,this._context?.sessionContext.changeKernel({id:e.id})}setDefaultCellType=e=>{this._notebookPanel.content.notebookConfig.defaultCell=e};changeCellType=e=>{const t=this._notebookPanel.content,n=t.model.sharedModel;t.widgets.forEach(((o,r)=>{if(t.isSelectedOrActive(o)){if(o.model.type!==e){const t=o.model.toJSON();n.transact((()=>{n.deleteCell(r);const o=n.insertCell(r,{cell_type:e,source:t.source,metadata:t.metadata});t.attachments&&["markdown","raw"].includes(e)&&(o.attachments=t.attachments)}))}"markdown"===e&&((o=t.widgets[r]).rendered=!1)}})),t.deselectAll()};insertAbove=e=>{const t=this._notebookPanel.content,n=this._notebookPanel.context.model,o=t.activeCell?t.activeCellIndex:0;n.sharedModel.insertCell(o,{cell_type:t.notebookConfig.defaultCell,source:e,metadata:"code"===t.notebookConfig.defaultCell?{trusted:!0}:{}}),t.activeCellIndex=o,t.deselectAll()};insertBelow=e=>{const t=this._notebookPanel.content,n=this._notebookPanel.context.model,o=t.activeCell?t.activeCellIndex+1:0;n.sharedModel.insertCell(o,{cell_type:t.notebookConfig.defaultCell,source:e,metadata:"code"===t.notebookConfig.defaultCell?{trusted:!0}:{}}),t.activeCellIndex=o,t.deselectAll()};dispose=()=>{document.removeEventListener("keydown",this.notebookKeydownListener,!0),this._context?.dispose(),this._notebookPanel?.dispose(),this._boxPanel.dispose()}}var we=n(16476),xe=n(90117);const ve=e=>{const{serviceManager:t,defaultKernel:n,lite:p}=(0,N.PD)({lite:e.lite,serverless:e.serverless,serviceManager:e.serviceManager,startDefaultKernel:e.startDefaultKernel,useRunningKernelId:e.useRunningKernelId,useRunningKernelIndex:e.useRunningKernelIndex}),{Toolbar:m,collaborative:f,extensions:g,height:b,maxHeight:y,nbformat:w,nbgrader:x,path:v,readonly:k,serverless:C,url:S}=e,[P,E]=(0,l.useState)(e.id||(0,_.YG)()),[j,M]=(0,l.useState)(),[O,A]=(0,l.useState)(new Array),$=e.kernel??n,F=(0,we.Gx)(),U=F.selectNotebookPortals(P),[W,H]=(0,l.useState)(!1),V=async(t,n)=>{const r=new ye({...e,id:P,lite:p,kernel:n,serviceManager:t});M(r),g.forEach((e=>{e.init({notebookId:P,commands:r.commands,panel:r.notebookPanel}),e.createNew(r.notebookPanel,r.context),A(O.concat(e.component??(0,o.jsx)(o.Fragment,{})))})),F.update({id:P,state:{adapter:r}}),r.notebookPanel?.content.modelChanged.connect(((e,t)=>{e.model&&F.changeModel({id:P,notebookModel:e.model})})),r.notebookPanel?.content.activeCellChanged.connect(((e,t)=>{null===t?F.activeCellChange({id:P,cellModel:void 0}):F.activeCellChange({id:P,cellModel:t})})),r.notebookPanel?.sessionContext.statusChanged.connect(((e,t)=>{F.changeKernelStatus({id:P,kernelStatus:t})})),r.serviceManager.ready.then((()=>{if(!k){const t=r.notebookPanel.content.activeCell;t&&F.activeCellChange({id:P,cellModel:t}),(e=r.notebookPanel.content.activeCellChanged,new T((t=>{function n(e,n){t.next(n)}return e.connect(n),()=>{e.disconnect(n)}}))).subscribe((e=>{F.activeCellChange({id:P,cellModel:e});const t=document.getElementById("right-panel-id");if(t){const n=(0,o.jsx)(c.A,{mt:3,children:(0,o.jsx)(I.r,{notebookId:P,cell:e,nbgrader:x})}),r=(0,d.createPortal)(n,t);F.setPortalDisplay({id:P,portalDisplay:{portal:r,pinned:!1}})}}))}var e}))},L=(e,t,n)=>{n?n.ready.then((()=>{V(t,n)})):V(t,n)},J=()=>{j?.notebookPanel?.disposed.connect(((e,t)=>{j&&(F.dispose(P),M(void 0))})),j?.notebookPanel?.dispose()};return(0,l.useEffect)((()=>{(t&&C||t&&$)&&L(0,t,$)}),[f,t,$]),(0,l.useEffect)((()=>{let e=null,n=new a.PromiseDelegate,o=!0,c=null;const l=t=>{t.code>1e3&&(console.error("Connection with the room has been closed unexpectedly.",t),e?.disconnect(),4002===t.code&&(e?.destroy(),n.reject("Connection closed."),n=new a.PromiseDelegate,o&&(H(!0),Promise.all([p(),n.promise,(0,_.yy)(500)]).catch((e=>{console.error("Failed to setup collaboration connection.",e)})).finally((()=>{o&&H(!1)})))))},d=t=>{t&&(e?.off("sync",d),n.resolve(void 0))},p=async()=>{if(j?.notebookPanel&&o){c=new r.Xn;const{ydoc:n,awareness:o}=c;if("jupyter"==f){const r=u.uJ.getState().jupyterConfig?.jupyterServerToken,i=await(0,D.e_)("json","notebook",v),a=s.URLExt.join(t?.serverSettings.wsUrl,D.Ir),c=`${i.format}:${i.type}:${i.fileId}`;e=new h.$R(a,c,n,{disableBc:!0,params:{sessionId:i.sessionId,token:r},awareness:o})}else if("datalayer"==f){const{runUrl:t,token:r}=u.uJ.getState().datalayerConfig??{},i=P,a=s.URLExt.join(t,"/api/spacer/v1/rooms"),c=await(0,K._)({url:s.URLExt.join(a,i),token:r});e=new h.$R(a.replace(/^http/,"ws"),i,n,{disableBc:!0,params:{sessionId:c,token:r},awareness:o})}if(e){e.on("sync",d),e.on("connection-close",l),console.log("Collaboration is setup with websocket provider.");const t=new i.x({collaborationEnabled:!0,disableDocumentWideUndoRedo:!0,sharedModel:c}),n=j.notebookPanel.content.model;j.notebookPanel.content.model=t,n?.dispose()}}};return f&&(H(!0),Promise.all([p(),n.promise,(0,_.yy)(500)]).catch((e=>{console.error("Failed to setup collaboration connection.",e)})).finally((()=>{o&&H(!1)}))),()=>{o=!1,e&&(e.synced?Promise.resolve():n.promise).finally((()=>{e?.off("sync",d),e?.off("connection-close",l),e?.disconnect(),e?.destroy()})),c?.dispose()}}),[j?.notebookPanel,f]),(0,l.useEffect)((()=>{j&&j.kernel!==$&&j.setKernel($)}),[$]),(0,l.useEffect)((()=>{j&&j.readonly!==k&&j.setReadonly(k)}),[k]),(0,l.useEffect)((()=>{j&&j.serverless!==C&&j.setServerless(C)}),[C]),(0,l.useEffect)((()=>{j&&j.nbformat!==w&&j.setNbformat(w)}),[w]),(0,l.useEffect)((()=>{j&&v&&j.path!==v&&(J(),L(0,t))}),[v]),(0,l.useEffect)((()=>{j&&S&&j.url!==S&&(J(),L(0,t))}),[f,S]),(0,l.useEffect)((()=>()=>{J()}),[]),(0,o.jsxs)(c.A,{style:{height:b,width:"100%",position:"relative"},id:"dla-Jupyter-Notebook",children:[m&&(0,o.jsx)(m,{notebookId:P}),(0,o.jsxs)(c.A,{className:"dla-Box-Notebook",sx:{"& .dla-Jupyter-Notebook":{height:b,maxHeight:y,width:"100%",overflowY:"hidden"},"& .datalayer-NotebookPanel-header":{minHeight:"50px"},"& .jp-Notebook":{flex:"1 1 auto !important",height:"100%",overflowY:"scroll"},"& .jp-NotebookPanel":{height:"100% !important",width:"100% !important"},"& .jp-Toolbar":{display:"none",zIndex:0},"& .jp-Toolbar .jp-HTMLSelect.jp-DefaultStyle select":{fontSize:"14px"},"& .jp-Toolbar > .jp-Toolbar-responsive-opener":{display:"none"},"& .jp-Toolbar-kernelName":{display:"none"},"& .jp-Cell":{width:`calc(100% - ${e.cellSidebarMargin}px)`},"& .jp-Notebook-footer":{width:`calc(100% - ${e.cellSidebarMargin+82}px)`},"& .jp-Cell .jp-CellHeader":{position:"absolute",top:"-5px",left:`${e.cellSidebarMargin+10}px`,height:"auto"},"& .jp-Cell .dla-CellSidebar-Container":{padding:"4px 8px",width:`${e.cellSidebarMargin+10}px`,marginLeft:"auto"},"& .jp-CodeMirrorEditor":{cursor:"text !important"},".dla-Box-Notebook":{position:"relative"}},children:[(0,o.jsx)(o.Fragment,{children:U?.map((e=>e))}),(0,o.jsx)(c.A,{children:O.map(((e,t)=>(0,o.jsx)(c.A,{children:e},`${e}-${t}`)))}),W?(0,o.jsx)(xe.a,{}):(0,o.jsx)(c.A,{children:j&&(0,o.jsx)(R.j,{id:P,children:j.panel})})]})]})};ve.defaultProps={cellMetadataPanel:!1,cellSidebarMargin:120,collaborative:void 0,extensions:[],height:"100vh",kernelClients:[],maxHeight:"100vh",nbgrader:!1,readonly:!1,renderId:0,renderers:[],serverless:!1,startDefaultKernel:!1}},5190:(e,t,n)=>{n.d(t,{l:()=>a});let o="https://cdn.jsdelivr.net/npm/",r=!0;const s=document.getElementsByTagName("script");Array.prototype.forEach.call(s,(e=>{o=e.getAttribute("data-jupyter-widgets-cdn")||o,r=r&&Boolean(e.getAttribute("data-jupyter-widgets-cdn-only"))}));const i=function(e){return new Promise(((t,n)=>{const o=window.requirejs;void 0===o?n("Requirejs is needed, please ensure it is loaded on the page."):o(e,t,n)}))};function a(e,t){const n=window.requirejs;if(void 0===n)throw new Error("Requirejs is needed, please ensure it is loaded on the page.");function s(){const r={paths:{}};return r.paths[e]=function(e,t){let n=e,r="index",s=e.indexOf("/");return-1!=s&&"@"==e[0]&&(s=e.indexOf("/",s+1)),-1!=s&&(r=e.substr(s+1),n=e.substr(0,s)),"@widgetti/jupyter-react"===n&&(t=t.replace("0.4.2","0.4.1")),`${o}${n}@${t}/dist/${r}`}(e,t),n.config(r),i([`${e}`])}return r?(console.log(`Loading from ${o} for ${e}@${t}`),s()):i([`${e}`]).catch((r=>{const i=r.requireModules&&r.requireModules[0];if(i)return n.undef(i),console.log(`Falling back to ${o} for ${e}@${t}`),s()}))}},16608:(e,t,n)=>{n.d(t,{s:()=>o});const o="application/vnd.jupyter.widget-state+json"},48319:(e,t,n)=>{n.d(t,{R:()=>r});var o=n(97164);class r{set(e,t,n){e in this._cache||(this._cache[e]=Object.create(null)),t in this._cache[e]?console.warn(`Version ${t} of key ${e} already registered.`):this._cache[e][t]=n}get(e,t){if(e in this._cache){const n=this._cache[e],r=(0,o.maxSatisfying)(Object.keys(n),t);if(null!==r)return n[r]}}getAllVersions(e){if(e in this._cache)return this._cache[e]}_cache=Object.create(null)}},54115:(e,t,n)=>{n.d(t,{a:()=>r,u:()=>s});var o=n(14809);const r="application/vnd.jupyter.widget-view+json";class s extends o.x0{constructor(e,t){super(),this.mimeType=e.mimeType,this._manager=t}async renderModel(e){const t=e.data[this.mimeType];if(!this._manager.has_model(t.model_id))return this.node.textContent="Error creating widget: could not find model",void this.addClass("jupyter-widgets");try{const e=await this._manager.get_model(t.model_id),n=await this._manager.create_view(e);o.x0.attach(n.luminoWidget,this.node)}catch(e){console.log("Error displaying widget"),console.log(e),this.node.textContent="Error displaying widget",this.addClass("jupyter-widgets")}}}}}]);