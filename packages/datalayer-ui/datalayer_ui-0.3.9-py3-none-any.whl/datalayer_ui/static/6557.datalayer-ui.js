"use strict";(self.webpackChunk_datalayer_ui=self.webpackChunk_datalayer_ui||[]).push([[6557],{25255:(e,i,s)=>{s.d(i,{Z:()=>o});var l=s(45205),n=s(68110),t=s(43275),a=s(16909),r=s(47011);function o(e){const{commandRegistry:i,kernelDesc:s,save:o,sessionConnection:c}=e,[d,u]=(0,a.useState)();return(0,a.useEffect)((()=>{const e=()=>{u(c?.kernel?.status)};return e(),c?.statusChanged.connect(e),c?.connectionStatusChanged.connect(e),()=>{c?.statusChanged.disconnect(e),c?.connectionStatusChanged.disconnect(e)}}),[c]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.r,{variant:"invisible",size:"small",leadingVisual:t.Mfv,disabled:void 0===s?.location,onClick:o,children:"Save"}),(0,r.jsx)(n.r,{variant:"invisible",size:"small",leadingVisual:t.o1U,disabled:!s?.location||"busy"===d,onClick:e=>{i?.execute(l.zl.runAll)},children:"Run all"}),(0,r.jsx)(n.r,{variant:"invisible",size:"small",leadingVisual:t.wNq,disabled:!s?.location||"busy"!==d,onClick:e=>{i?.execute(l.zl.interrupt)},children:"Interrupt"})]})}},26557:(e,i,s)=>{s.r(i),s.d(i,{LessonEdit:()=>D,default:()=>T});var l=s(16909),n=s(97663),t=s(88625),a=s(15358),r=s(82176),o=s(34166),c=s(68110),d=s(97666),u=s(44860),h=s(79424),m=s(88567),v=s(43275),p=s(46523),x=s(38267),j=s(23577),g=s(25255),k=s(85730),y=s(68495),b=s(45741),f=s(35928),C=s(19459),Z=s(52999),w=s(47011);const D=()=>{const{lessonId:e}=(0,n.UO)();if(!e)return(0,w.jsx)(w.Fragment,{});const i=(0,k.a)(),s=(0,t.N)(),D=(0,y.s)(),T=(0,C.qX)(),z=(0,p.qL)(),I=T.layout().space,B=(0,Z.D1)().saveRequest,S=z.selectNotebookModel(e),{cloneLesson:V,getLesson:N,refreshLesson:L,updateNotebook:R,updateNotebookModel:P}=(0,b.Y)(),[q,M]=(0,l.useState)("editor"),{enqueueToast:A}=(0,f.p)(),[E,U]=(0,l.useState)(),[F,_]=(0,l.useState)({name:"",description:""}),[O,J]=(0,l.useState)({name:void 0,description:void 0}),Q=(e,i)=>{i.preventDefault(),T.layout().resetRightPortal(),M(e)};(0,l.useEffect)((()=>(T.layout().showBackdrop(),L(e).then((i=>{if(T.layout().hideBackdrop(),i.success){const i=N(e);i?(U(i),T.layout().setItem(i),_({name:i.name,description:i.description})):D("/")}})).finally((()=>{T.layout().hideBackdrop()})),()=>{U(void 0),z.reset(),T.layout().setItem(void 0)})),[e]);const X=()=>{S?.model?.cells&&(T.layout().showBackdrop("Saving the lesson..."),P(e,S.model.toJSON()).then((e=>{e.success&&(A("The lesson is successfully updated.",{variant:"success"}),T.layout().triggerItemsRefresh(),U({...E,nbformat:S.model.toJSON()}))})).finally((()=>{T.layout().hideBackdrop()})))};(0,l.useEffect)((()=>{B&&E&&X()}),[B]),(0,l.useEffect)((()=>{J({...O,name:void 0===F.name?void 0:F.name.length>2,description:void 0===F.description?void 0:F.description.length>2})}),[F]);const H=(0,l.useCallback)((async l=>{s({title:"Are you sure?",content:"Please confirm you want to clone this lesson in your private library."}).then((s=>{s&&(T.layout().showBackdrop(),V(e).then((e=>{T.layout().hideBackdrop(),e.success&&(A(e.message,{variant:"success"}),T.layout().triggerItemsRefresh(),D(`/${i?.handle}/library/lessons`))})).finally((()=>{T.layout().hideBackdrop()})))}))}),[s,E]);return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(a.m,{children:(0,w.jsxs)(r.Z,{display:"flex",children:[(0,w.jsx)(r.Z,{flex:1,children:(0,w.jsx)(o.Z,{sx:{fontSize:3},children:"Lesson editor"})}),"editor"===q&&(0,w.jsx)(r.Z,{children:(0,w.jsx)(g.Z,{commandRegistry:z.selectNotebookAdapter(e)?.commands,save:X})}),E&&I&&(0,w.jsx)(r.Z,{children:(0,w.jsx)(c.r,{variant:"invisible",size:"small",leadingVisual:v.jcu,onClick:H,children:"Clone"})})]})}),E&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsxs)(d.Z,{sx:{mt:3,mb:3},children:[(0,w.jsx)(d.Z.Link,{href:"",selected:"editor"===q,onClick:e=>Q("editor",e),children:"Editor"}),(0,w.jsx)(d.Z.Link,{href:"",selected:"properties"===q,onClick:e=>Q("properties",e),children:"Properties"})]}),"editor"===q&&(0,w.jsx)(r.Z,{children:E.nbformat&&(0,w.jsx)(x.a,{id:e,height:"calc(100vh - 240px)",maxHeight:"calc(100vh - 240px)",cellMetadataPanel:!0,nbformat:E.nbformat,CellSidebar:j.Q})}),"properties"===q&&(0,w.jsx)(r.Z,{display:"grid",gridTemplateColumns:"1fr 1fr",children:(0,w.jsx)(r.Z,{children:(0,w.jsxs)(r.Z,{sx:{label:{marginTop:2}},children:[(0,w.jsxs)(u.Z,{children:[(0,w.jsx)(u.Z.Label,{children:"Name"}),(0,w.jsx)(h.Z,{block:!0,value:F.name,onChange:e=>{_((i=>({...i,name:e.target.value})))}}),!1===O.name&&(0,w.jsx)(u.Z.Validation,{variant:"error",children:"Name must have more than 2 characters."})]}),(0,w.jsxs)(u.Z,{children:[(0,w.jsx)(u.Z.Label,{children:"Description"}),(0,w.jsx)(m.ZP,{block:!0,value:F.description,onChange:e=>{_((i=>({...i,description:e.target.value})))}}),!1===O.description&&(0,w.jsx)(u.Z.Validation,{variant:"error",children:"Description must have more than 2 characters."})]}),(0,w.jsx)(u.Z,{children:(0,w.jsx)(c.r,{variant:"primary",disabled:!O.name||!O.description,sx:{marginTop:2},onClick:async()=>{T.layout().showBackdrop(),R(e,F.name,F.description).then((e=>{T.layout().hideBackdrop(),e.success&&(A("The lesson is successfully updated.",{variant:"success"}),T.layout().triggerItemsRefresh(),U({...E,name:F.name,description:F.description}))})).finally((()=>{T.layout().hideBackdrop()}))},children:"Update lesson"})})]})})})]})]})},T=D},23577:(e,i,s)=>{s.d(i,{Q:()=>h});var l=s(47011),n=s(16909),t=s(70994),a=s(9521),r=s(81158),o=s(34441),c=s(26766),d=s(46523),u=s(30540);const h=e=>{const{notebookId:i,cellNodeId:s,nbgrader:h}=e,[m,v]=(0,n.useState)(!1),p=(0,d.ZP)(),x=p.selectActiveCell(i),j=x?.layout;if(j){const e=j.widgets[0];e?.node.id===s&&(m||v(!0)),e?.node.id!==s&&m&&v(!1)}return m?x?(0,l.jsxs)(t.Z,{className:u.UI,sx:{"& p":{marginBottom:"0 !important"}},children:[h&&(0,l.jsx)(a.P,{children:(0,l.jsx)(c.Z,{notebookId:i,cell:x,nbgrader:h})}),(0,l.jsx)(t.Z,{children:(0,l.jsx)(r.r,{title:"Run cell",leadingVisual:o.XCv,variant:"invisible",size:"small",onClick:e=>{e.preventDefault(),p.run(i)},children:"Run"})}),(0,l.jsx)(t.Z,{children:(0,l.jsx)(r.r,{title:"Insert code cell above",leadingVisual:o.g8U,variant:"invisible",size:"small",onClick:e=>{e.preventDefault(),p.insertAbove({id:i,cellType:"code"})},children:"Code"})}),(0,l.jsx)(t.Z,{children:(0,l.jsx)(r.r,{title:"Insert markdown cell above",leadingVisual:o.g8U,variant:"invisible",size:"small",onClick:e=>{e.preventDefault(),p.insertAbove({id:i,cellType:"markdown"})},children:"Markdown"})}),(0,l.jsx)(t.Z,{children:"code"===x.model.type?(0,l.jsx)(r.r,{title:"Convert to markdow cell",leadingVisual:o.Ps4,variant:"invisible",size:"small",onClick:e=>{e.preventDefault(),p.changeCellType({id:i,cellType:"markdown"})},children:"To Markdown"}):(0,l.jsx)(r.r,{title:"Convert to code cell",leadingVisual:o.Ps4,variant:"invisible",size:"small",onClick:e=>{e.preventDefault(),p.changeCellType({id:i,cellType:"code"})},children:"To Code"})}),(0,l.jsx)(t.Z,{children:(0,l.jsx)(r.r,{title:"Insert markdown cell below",leadingVisual:o.v4q,variant:"invisible",size:"small",onClick:e=>{e.preventDefault(),p.insertBelow({id:i,cellType:"markdown"})},children:"Markdown"})}),(0,l.jsx)(t.Z,{children:(0,l.jsx)(r.r,{title:"Insert code cell below",leadingVisual:o.v4q,variant:"invisible",size:"small",onClick:e=>{e.preventDefault(),p.insertBelow({id:i,cellType:"code"})},children:"Code"})}),(0,l.jsx)(t.Z,{children:(0,l.jsx)(r.r,{title:"Delete cell",leadingVisual:o.b0D,variant:"invisible",size:"small",onClick:e=>{e.preventDefault(),p.delete(i)},children:"Delete"})})]}):(0,l.jsx)(l.Fragment,{}):(0,l.jsx)("div",{})}}}]);